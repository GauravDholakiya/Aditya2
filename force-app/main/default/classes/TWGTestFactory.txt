@isTest
public with sharing class TWGTestFactory
{
    public static Account mockAccount = new Account();
    public static Map<Id, Account> mockAccountMap = new Map<Id, Account>();
    public static Map<Id, Contact> mockContactMap = new Map<Id, Contact>();
    public static List<Account_Request__c> mockAccountRequests = new List<Account_Request__c>();
    public static Boolean runErrorCode = false;
    public static Map<String, Schema.SObjectType> allObjectMap = NULL;
    public static Map<String, Map<String, Schema.SObjectField>> fieldMapByObject = new Map<String, Map<String, Schema.SObjectField>>();
    public static Integer index = 1;
    public static Integer randomCounter = 1;

    public static User ADMIN_USER
    {
        get
        {
            return [ SELECT Id FROM User WHERE Profile.Name = 'System Administrator' AND isActive = True AND LocaleSidKey = 'en_US' LIMIT 1 ];
        }
        private set;
    }
    public static User DEALER_USER
    { 
        get
        {
            return [ SELECT Id FROM User WHERE Profile.Name =: System.label.Dealer_Admin_CC  AND isActive = True LIMIT 1 ];
        }
        private set;
    }
    public static User NON_STANDARD_USER
    {
        get
        {
            return [ SELECT Id FROM User WHERE isActive = True AND UserType != 'Standard' AND contactId != null LIMIT 1 ];
        }
        private set;
    }
    
    //This is needed due to trigger on Account
    public static Glow_r1_Dealer_Lienholder__c  createAndInsertDealerLienholderSetting()
    {
        Glow_r1_Dealer_Lienholder__c dls = new Glow_r1_Dealer_Lienholder__c ();
        //This seems like garbage data. What is its purpose?
        dls.Address_1__c = 'Underscore';
        dls.Country__c = 'USA';
        dls.Postal_Code_Zip_Code__c = '00000';
        dls.Telephone__c = '(555) 555-5555';
        dls.Name = 'Underscore';
        insert dls;
        return dls;
    }

    public static Account_Request__c prepareAccountRequest()
    {
        Account_Request__c ar = new Account_Request__c();
        ar.RecordTypeId = Schema.SObjectType.Account_Request__c.getRecordTypeInfosByName().get(System.Label.New_Dealer_Request).getRecordTypeId();
        ar.State__c = 'IL';
        ar.Dealer_Name__c = 'Test Dealer 1';
        ar.Street__c = 'ATTN: LAURIE QUINDALL I 1200 EAST CHICAGO STREET';
        ar.City__c = 'ELGIN';
        ar.Zip_Code__c= '767555';
        ar.Phone__c = '1234567890';
        ar.Fax__c = '1234567891';
        return ar;
    }

    public static Account createAccount()
    {
        return (Account)buildSObject( Account.SObjectType, null );
    }

    public static List<Account> createAccountData(){
        Account a1 = new Account(
            NAME = 'ELGIN TOYOTA',
            BILLINGSTREET = 'ATTN: LAURIE QUINDALL I 1200 EAST CHICAGO STREET',
            BILLINGCITY = 'ELGIN',
            BILLINGSTATE = 'IL',
            BILLINGPOSTALCODE = '60120-4714',
            BILLINGCOUNTRY = 'USA',
            PHONE = '8477412199',
            FAX = '(847) 695-8298',
            ACCOUNTNUMBER = '000IL013',
            ATTENTION_LINE__C = 'F&I: TOM PALM / GM: DAVID SALOMON',
            CLASSIFICATION_CODE__C = 'B7',
            CLIENT_DESCRIPTION__C = 'Active Serviceable',
            CLIENT_TYPE_DESC__C = 'Producing',
            CLIENT_TYPE__C = 'P',
            DRAD__C = '1513',
            DATASYNCTRANSACTION_ID__C = '16421',
            DEALER_TYPE__C = 'Purchase',
            DELETE_FLAG__C = 'N',
            IS_CLIENT_SIGNED_UP_FOR_TWG_CONNECT__C = false,
            IS_THIS_REINSTALLMENT_REACTIVATION__C = '',
            MR_CLIENT_NUMBER_INT__C = '000IL013',
            NAT_L_CRED_UNION__C = 'N',
            PREMIUM_LOCATION_CODE__C = 'C',
            RDG_NBR__C = 'RIL0369',
            RETAIL_RATE_FLAG__C = 'Y',
            STY_AREA__C = '1',
            STY_DISTRICT__C = '3',
            STY_DIVISION__C = '1',
            STY_REGION__C = '5',
            SERVICE_LEVEL__C = '',
            SPECIAL_ID__C = 'C-000IL000',
            BCC_ACTIVE__C = true,
            BCC1_EMAIL_ADDRESS__C = 'avdsouza@deloitte.com',
            BCC2_EMAIL_ADDRESS__C = 'naprabhakar@deloitte.com',
            BCC3_EMAIL_ADDRESS__C = 'prathor@deloitte.com',
            RecordTypeId  = Schema.SObjectType.Account.getRecordTypeInfosByName().get(System.Label.P2_Account_Record_Type).getRecordTypeId()
        );
        Account a2 = new Account(
            NAME = 'QUIRK CHEVROLET',
            BILLINGSTREET = 'ATTN: OFFICE MANAGER 444 QUINCY AVENUE',
            BILLINGCITY = 'BRAINTREE',
            BILLINGSTATE = 'MA',
            BILLINGPOSTALCODE = '2184',
            BILLINGCOUNTRY = 'USA',
            PHONE = '7818434800',
            FAX = '(847) 695-8298',
            ACCOUNTNUMBER = '000MA023',
            ATTENTION_LINE__C = 'F&I: TOM PALM / GM: DAVID SALOMON',
            CLASSIFICATION_CODE__C = 'B7',
            CLIENT_DESCRIPTION__C = 'Active Serviceable',
            CLIENT_TYPE_DESC__C = 'Producing',
            CLIENT_TYPE__C = 'P',
            DRAD__C = '1122',
            DATASYNCTRANSACTION_ID__C = '16624',
            DEALER_TYPE__C = 'Remit',
            DELETE_FLAG__C = 'N',
            IS_CLIENT_SIGNED_UP_FOR_TWG_CONNECT__C = false,
            IS_THIS_REINSTALLMENT_REACTIVATION__C = '',
            MR_CLIENT_NUMBER_INT__C = '000MA023',
            NAT_L_CRED_UNION__C = 'N',
            PREMIUM_LOCATION_CODE__C = 'C',
            RDG_NBR__C = 'RMA0232',
            RETAIL_RATE_FLAG__C = 'N',
            STY_AREA__C = '2',
            STY_DISTRICT__C = '2',
            STY_DIVISION__C = '1',
            STY_REGION__C = '1',
            SERVICE_LEVEL__C = '',
            SPECIAL_ID__C = 'C-000MA023',
            BCC_ACTIVE__C = true,
            BCC1_EMAIL_ADDRESS__C = 'avdsouza@deloitte.com',
            BCC2_EMAIL_ADDRESS__C = 'naprabhakar@deloitte.com',
            BCC3_EMAIL_ADDRESS__C = 'prathor@deloitte.com',
            RecordTypeId  = Schema.SObjectType.Account.getRecordTypeInfosByName().get(System.Label.P2_Account_Record_Type).getRecordTypeId()
        );
        List<Account> accList = new List<Account>();
        accList.add(a1);
        accList.add(a2);
        insert accList;
        return accList;
    }

    public static Account createAccount_CPM()
    {
        createAndInsertDealerLienholderSetting();

        Account acct = new Account();
        acct.Name = 'Account Name Unit Test XYZ';
        acct.Phone = '3125554444';
        acct.BillingCity = 'Chicago';
        acct.BillingStreet = 'Unit Test Street 1';
        acct.BillingCountry = 'USA';
        acct.BillingPostalCode = '60606';
        acct.BillingState = 'AL';
        acct.State__c = 'ALABAMA';
        acct.DRAD__c = '12345678';
        acct.RecordTypeId =  RecordTypeDAO.getRecordType('Dealer','Account').Id;
        return acct;
    }

    public static TWG_Product__c createTWGProduct()
    {
        TWG_Product__c prod = new TWG_Product__c(Name = 'Test Base Product',
            Product_Code__c = 'PCODE'+getRandomString(),Product_Type__c = 'W - Service Contract',
            Product_Start_Date__c = System.now(),Channel__c = 'Resource',Country_Code__c = 'US / USA',
            Client_Type_Distribution_Channel__c = 'Dealer',Product_Description__c = 'For testing',
            Vehicle_Group_ID__c = 'VGI0001',UW_Insurance_Rate_Code__c = 'TESTING1234',UW_TWG_Fees_Rate_Code__c = 'TESTING1234');

        insert prod;
        return prod;
    }
    
    public static TWG_Product__c createTWGProductWithChannelName(String channelName)
    {
        TWG_Product__c prod = new TWG_Product__c(Name = 'Test Base Product', Product_Code__c = 'PCODE'+getRandomString(), 
            Product_Type__c = 'W - Service Contract', Product_Start_Date__c = System.now(), Channel__c = channelName, 
            Country_Code__c = 'US / USA', Client_Type_Distribution_Channel__c = 'Dealer', Product_Description__c = 'For testing', 
            Vehicle_Group_ID__c = 'VGI0001', UW_Insurance_Rate_Code__c = 'TESTING1234',UW_TWG_Fees_Rate_Code__c = 'TESTING1234');

        insert prod;
        return prod;
    }

    public static Contract__c createContract()
    {
        Contract__c contract = new Contract__c();
        contract.Name = 'UNITTESTX';
        contract.Status__c = 'New';
        contract.Premium_Location_Code_INT__c = 'C';
        contract.Holder_First_Name_INT__c = 'First';
        contract.Holder_Last_Name_INT__c = 'Last';
        contract.Co_First_Name__c = 'CoFirst';
        contract.Co_Last_Name__c = 'CoLast';
        contract.Customer_Phone__c = '1111111111';
        contract.Holder_Address_1_INT__c = 'Address Line 1';
        contract.Holder_Address_2_INT__c = 'Address Line 2';
        contract.Holder_City_INT__c = 'Chicago';
        contract.Holder_State_Province_INT__c = 'IL';
        contract.Holder_Postal_Code_INT__c = '60606';
        return contract;
    }

    public static Dealer_Services__c createDealerService(Id jobId)
    {
        Dealer_Services__c dealerService = new Dealer_Services__c();
        dealerService.Job_Name__c = jobId;
        return dealerService;
    }

    public static Contact createContact()
    {
        Contact contact = new Contact();
        contact.LastName = 'Unit Test LName';
        return contact;
    }

    public static Contact createContact(Account a) {
      Contact c = new Contact(LastName = 'Test',AccountId = a.Id);

      return c;
    }

    public static Dealer_Product_Forms__c createDealerProductForm(Dealer_Product__c dp,String agreementType,Date startDate,Date endDate) {
        Dealer_Product_Forms__c form = new Dealer_Product_Forms__c(Dealer_Product__c = dp.Id,Agreement_Form_Number__c = agreementType,Start_Date__c = startDate,End_Date__c = endDate);

        insert form;
        return form;
    }

    public static User createCommunityUser(Contact c) {
        Profile p = [select id from profile where name='F&I Sales CC'];
        User u = new User(Alias = 'standt', Email='standarduser@twg.com',
            EmailEncodingKey='UTF-8', FirstName = 'Test',LastName='User', LanguageLocaleKey='en_US',
            LocaleSidKey='en_US', ProfileId = p.Id,
            TimeZoneSidKey='America/Los_Angeles', UserName='standarduser@twg.com',DRAD_ID_INT__C = '12345678',
            contactId = c.Id);

        insert u;
        return u;
    }

    public static User createCommunityUserWithProfileId(Contact c, Id profileId) {
        User u = new User(Alias = 'standt', Email = 'testclassuser.' + String.valueof(DateTime.now().getTime()) + '@twg.com',
            EmailEncodingKey = 'UTF-8', FirstName = 'Test', LastName = 'User', LanguageLocaleKey='en_US',
            LocaleSidKey = 'en_US', ProfileId = profileId,
            TimeZoneSidKey = 'America/Los_Angeles', UserName = 'testclassuser.' + String.valueof(DateTime.now().getTime()) + '@twg.com',
            DRAD_ID_INT__C = '12345678', contactId = c.Id);

        return u;
    }

    public static User createPortalUser( Id profileId )
    {
        Id readOnlyRoleId = [ SELECT Id FROM UserRole WHERE Name ='Read Only' LIMIT 1 ].Id;
        Account acc = createAccount();
        insert acc;
        Contact con = createContact();
        con.AccountId = acc.Id;
        insert con;
        return createPortalUser( profileId, con.Id, readOnlyRoleId );
    }

    public static User createANPortalUser(Id accId, Contact con, Id profileId )
    {
      Id readOnlyRoleId = [ SELECT Id FROM UserRole WHERE Name ='Read Only' LIMIT 1 ].Id;
      con.AccountId = accId;
      insert con;
      return createPortalUser( profileId, con.Id, readOnlyRoleId );
    }


    public static void createMilestones() {
        List<Milestone__c> mList = new List<Milestone__c>();
        mList.add(new Milestone__c(Key__c = 'DAA', Milestone_Label__c = 'Signed DAA', Active__c = true, Workflow_Type__c = 'Dealer Product Setup'));
        mList.add(new Milestone__c(Key__c = 'POL', Milestone_Label__c = 'Policy Issuance', Active__c = true, Workflow_Type__c = 'Dealer Product Setup'));
        mList.add(new Milestone__c(Key__c = 'REG', Milestone_Label__c = 'Registration', Active__c = true, Workflow_Type__c = 'Dealer Product Setup'));
        mList.add(new Milestone__c(Key__c = 'LIC', Milestone_Label__c = 'Licensing Appointment', Active__c = true, Workflow_Type__c = 'Dealer Product Setup'));
        mList.add(new Milestone__c(Key__c = 'SUP', Milestone_Label__c = 'Supplies Prep & Delivery', Active__c = true, Workflow_Type__c = 'Dealer Product Setup'));
        mList.add(new Milestone__c(Key__c = 'RECLI', Milestone_Label__c = 'Internal Review - CLI', Active__c = true, Workflow_Type__c = 'Dealer Product Setup'));
        mList.add(new Milestone__c(Key__c = 'RECT', Milestone_Label__c = 'Internal Review - CT', Active__c = true, Workflow_Type__c = 'Dealer Product Setup'));
        mList.add(new Milestone__c(Key__c = 'PRI', Milestone_Label__c = 'Prioritization', Active__c = true, Workflow_Type__c = 'Dealer Product Setup'));
        mList.add(new Milestone__c(Key__c = 'LICX', Milestone_Label__c = 'Appointment Termination', Active__c = true, Workflow_Type__c = 'Product Loss'));
        mList.add(new Milestone__c(Key__c = 'POLX', Milestone_Label__c = 'Non-Renewal Letter', Active__c = true, Workflow_Type__c = 'Product Loss'));
        mList.add(new Milestone__c(Key__c = 'ACT', Milestone_Label__c = 'Launch Product', Active__c = true, Workflow_Type__c = 'Dealer Product Setup'));
        mList.add(new Milestone__c(Key__c = 'UW', Milestone_Label__c = 'UW Review', Active__c = true, Workflow_Type__c = 'Dealer Product Setup'));

        insert mList;

        List<cwfstaterules__c> stateRules = new List<cwfstaterules__c>();
        stateRules.add(new cwfstaterules__c(name = 'ALABAMAGAP', State__c = 'ALABAMA', Product__c = 'G - Guaranteed Asset Protect', Licensing_Required__c = false, Policy_Required__c = true));
        stateRules.add(new cwfstaterules__c(name = 'ALABAMASERVICECONTRACT', State__c = 'ALABAMA', Product__c = 'W - Service Contract', Licensing_Required__c = true, Policy_Required__c = true));

        insert stateRules;
    }

    public static User createPortalUser(Id inputProfileId, Id inputContactId, Id inputRoleId)
    {
        Id roleId = [SELECT Id FROM UserRole WHERE DeveloperName = 'Customer_Service' LIMIT 1].Id;
        User pu = new User(profileId = inputProfileId, portalRole = 'Worker', username = 'unittextx.tst@thewarrantygroup.com', email = 'unittextx@thewarrantygroup.com',emailencodingkey = 'UTF-8', localesidkey = 'en_US',languagelocalekey = 'en_US', timezonesidkey = 'America/Chicago',alias='csputxz', lastname='UnitTestLName', contactId = inputContactId);
        return pu;
    }
    
    public static User createGBPortalUser(Id inputProfileId, Id inputContactId, Id inputRoleId)
    {
        Id roleId = [SELECT Id FROM UserRole WHERE DeveloperName = 'Customer_Service' LIMIT 1].Id;
        User pu = new User(profileId = inputProfileId, portalRole = 'Worker', username = 'unittextx2.tst@thewarrantygroup.com', email = 'unittextx2@thewarrantygroup.com',emailencodingkey = 'UTF-8', localesidkey = 'en_GB',languagelocalekey = 'en_GB', timezonesidkey = 'America/Chicago',alias='csputxz', lastname='UnitTestLName2', contactId = inputContactId);
        return pu;
    }

    public static Quote_Dealer_Product__c  createQuoteDealerProduct()
    {
        Quote_Dealer_Product__c qdp = new Quote_Dealer_Product__c ();
        return qdp;
    }

    public static Commission__c createCommission()
    {
        Commission__c comm = new Commission__c();
        comm.Password_Required__c = true;
        comm.Commission_password__c = 'testpwd';
        return comm;
    }

    public static Dealer_Lienholder__c createLienholder()
    {
        return new Dealer_Lienholder__c(Name='Unit Test Lienholder',State__c ='IL', City__c ='Chicago',Phone__c = '3125556677');
    }

    public static Vehicle__c createVehicle()
    {
        return new Vehicle__c(Make__c = 'TestMake', Model__c='TestModel', Year__c='2014',VIN__c ='12345678901234567');
    }

    public static Quote__c createQuote()
    {
        return new Quote__c(VIN__c = '12345678901234567');
    }

    public static Quote__c createQuote(Account a)
    {
        Quote__c quote = new Quote__c(Account__r = a,Account__c = a.Id,VIN__c = '12345678901234567');
        insert quote;
        return quote;
    }

    public static Quote_Dealer_Product__c  createQuoteDealerProduct(Dealer_Product__c dp,Quote__c quote)
    {
        Quote_Dealer_Product__c qdp = new Quote_Dealer_Product__c (Dealer_Product__c = dp.Id, Quote__c = quote.Id,Quote__r = quote);
        insert qdp;
        return qdp;
    }

    public static Case createCase()
    {
        Case c = new Case();
        c.Subject = 'Unit Test Case X';
        c.Phone__c = '5555555555';
        c.Select_Labor_Rate__c = 'Account Guidelines';
        c.Breakdown_Mileage__c = 100000;
        return c;
    }

    public static PPM_Program_Product__c createPPMProgramProduct( String productCode, Id ppmProgramId )
    {
        PPM_Program_Product__c ppmProd = new PPM_Program_Product__c(Name = productCode,PPM_Program_Id__c = ppmProgramId );
        return ppmProd;
    }

    public static PPM_Program__c createPPMProgram()
    {
        return GLOW_r1_TestData_Utility.createPPMprog();
    }

    public static Dealer_Product__c createDealerProduct()
    {
        return new Dealer_Product__c(ProductClassDesc_INT__c = 'Limited Warranty');
    }

    public static Dealer_Product__c createDealerProduct(Account a, TWG_Product__c prod)
    {
        createMilestones();
        RecordType rt = [SELECT Id from RecordType where Name = 'RDG Dealer Product'];

        Dealer_Product__c dp = new Dealer_Product__c(RecordType = rt,Account__c = a.Id,ProductTypeName_INT__c = 'Test Dealer Product', TWG_Product__c = prod.Id,
                                                     Product_Class__c = '06 New Only',Requested_Start_Date__c = System.today(),Start_Date__c = System.today()
                                                     ,Participation_Model__c = 'Direct',Collateral_Type__c = DealerProductConstants.DEALER_PRODUCT_COLLATERAL_TYPE_AUTO);

        insert dp;
        return dp;
    }

    public static Case_Payee__c createCasePayee( Id caseId, Id accountId)
    {
        RecordType mechanicalPayeeRecType = RecordTypeDAO.getRecordType('Mechanical', 'Case_Payee__c');
        return createCasePayee( caseId, accountId, mechanicalPayeeRecType.Id );
    }

    public static Case_Payee__c createCasePayee( Id caseId, Id accountId, Id recTypeId )
    {
        return new Case_Payee__c( Case__c = caseId, Account__c = accountId, RecordTypeId = recTypeId );
    }

   static Integer idCounter = 1;
   public static String getFakeId(Schema.SObjectType sot)
   {
      String result = String.valueOf(idCounter);
      idCounter ++;
      return sot.getDescribe().getKeyPrefix() + '0'.repeat(12-result.length()) + result;
   }

   public static Vehicle_INT__c createAndInsertVehicleINT(String Make, String Manufacturer, String VehicleCode)
   {
       Vehicle_INT__c vCode = new Vehicle_INT__c();
       vCode.Name = 'Unit Test Vehicle Code';
       //vCode.Manufacturer_Code__c=createAndInsertMFGINT(Manufacturer).Id;
       //vCode.Make_Code__c=createAndInsertMakeINT(Make, vehicleCode).Id;
       vCode.Manufacturer_Code_INT__c='SN';
       vCode.Make_Code_INT__c='CT';
       vCode.Make_Name__c='ARCTIC CAT';
       vCode.Vehicle_Code__c=VehicleCode;
       insert vCode;

       return vCode;
   }

   public static Make_INT__c createAndInsertMakeINT(String makeName, String vehicleCode)
   {
       Make_INT__c makeCode = new Make_INT__c ();
       makeCode.Name = makeName;
       makeCode.Special_ID__c = '123';
       makeCode.Mitchell_Manufacturer_Code__c = vehicleCode;
       makeCode.Name__c = makeName;
       makeCode.Make_Name_Alias__c = makeName;
       insert makeCode;

       return makeCode;
   }

   public static Manufacturer_INT__c createAndInsertMFGINT(String Manufacturer)
   {
       Manufacturer_INT__c MFGCode = new Manufacturer_INT__c();
       MFGCode.Name = Manufacturer;
       MFGCode.Special_ID__c='456';
       insert MFGCode;

       return MFGCode;
   }

   private static Integer specialIdCounter=0;
   public static Account_Guideline__c createAndInsertAccountGuideLine(ID accountId, ID make, ID mfg)
   {
       Account_Guideline__c aGuideline = new Account_Guideline__c();
       //aGuideline.Name = 'AccountGuideline Name Unit Test XYZ';
       aGuideline.Make__c = make;
       aGuideline.Mfg__c = mfg;
       aGuideline.Account__c=accountId;
       aGuideline.Effective_date__c=Date.newInstance(1999, 1, 1);
       aGuideline.End_Date__c=null;
       aGuideline.Start_Date__c=Date.newInstance(1999, 1, 1);
       aGuideline.Special_Id__c='C-123-444-'+specialIdCounter;
       specialIdCounter=specialIdCounter+1;
       insert aGuideline;
       return aGuideline;
   }

   public static Account_Guideline__c createAndInsertAccountGuideLine(ID accountId)
   {
       return createAndInsertAccountGuideLine(accountId,null,null);
   }

   public static Account_Guideline__c createAccountGuideLine(ID accountId, ID make, ID mfg)
   {
       Account_Guideline__c aGuideline = new Account_Guideline__c();
       aGuideline.Make__c = make;
       aGuideline.Mfg__c = mfg;
       aGuideline.Account__c=accountId;
       aGuideline.Effective_date__c=Date.newInstance(1999, 1, 1);
       aGuideline.End_Date__c=null;
       aGuideline.Start_Date__c=Date.newInstance(1999, 1, 1);
       aGuideline.Special_Id__c='C-123-444-'+specialIdCounter;
       specialIdCounter=specialIdCounter+1;
       return aGuideline;
   }

   public static Account_Guideline__c createAccountGuideLine(ID accountId)
   {
       return createAccountGuideLine(accountId,null,null);
   }

  public static Job__c buildJob( Id caseId, String type)
  {
    return buildJob( caseId, type, null );
  }
  public static Job__c buildJob( Id caseId, String type, Map<String, Object> fieldToValue )
  {
    Job__c job = new Job__c( Case__c = caseId );

    Map<String, Object> updatedFieldToValue = new Map<String, Object>();
    if ( jobTypeToRequiredFields.get(type) != null )
      updatedFieldToValue.putAll( jobTypeToRequiredFields.get(type) );
    if ( fieldToValue != null )
      updatedFieldToValue.putAll( fieldToValue );

    mergeValues( job, updatedFieldToValue );

    return job;
  }

  public static void setupCustomSettingsAndMechanicalCase()
  {
    TWGFIN_TestDataFactory.insertFieldSetCustomSetting();
    createAndInsertDealerLienholderSetting();
    new GLOW_r1_TestData_Utility().create_ErrorMessage_Data();
    setupMechanicalCase();
  }

  public static void setupCustomSettings()
  {
    TWGFIN_TestDataFactory.insertFieldSetCustomSetting();
    createAndInsertDealerLienholderSetting();
    new GLOW_r1_TestData_Utility().create_ErrorMessage_Data();
  }

    public static List<SObject> createObjectFromStaticResource(SObjectType sobjType, String resourceName)
    {
        StaticResource sr = [select id,body from StaticResource Where Name =: resourceName];
        String contents = sr.body.toString();
        List<String> lines = contents.split('\n');
        List<SObject> sobjList = new List<SObject>();
        if(lines.size() > 1){
            String [] fieldList = lines[0].split(',');
            for(Integer i = 1; i < lines.size(); i++) {
                List<String> values = lines[i].split(',');
                sObject acc = sobjType.newSObject() ;
                Integer count = 0;
                for(String fieldValues : values){
                    String fieldName = fieldList[count];
                    if(fieldValues != null && fieldValues.length() > 0){
                        try{
                            acc.put(fieldName, fieldValues);
                        }catch(Exception e){
                        }
                    }
                    count = count + 1;
                }
                sobjList.add(acc);
            }
        }
        insert sobjList;
        return sobjList;
    }

  public static sObject buildSObject( SObjectType sobjType, Map<String, Object> fieldToValue )
  {
    sObject sobj = sobjType.newSObject() ;
    Map<String, Object> updatedFieldToValue = new Map<String, Object>();
    if ( objectTypeToRequiredFields.get(sobjType) != null )
      updatedFieldToValue.putAll( objectTypeToRequiredFields.get(sobjType) );
    if ( fieldToValue != null )
      updatedFieldToValue.putAll( fieldToValue );

    mergeValues( sobj, updatedFieldToValue );

    return sobj;
  }

  public static List<SObject> buildSObjects( Integer numToCreate, SObjectType sobjType, Map<String, Object> fieldToValue )
  {
    List<SObject> sObjects = new List<SObject>();
    for ( Integer i=0; i<numToCreate; i++ )
      sObjects.add( buildSObject( sobjType, fieldToValue ) );
    return sObjects;
  }

  /**
  *       Private Helper Methods
  **/
  private static void mergeValues( sObject sobj, Map<String, Object> fieldToValue )
  {
    for ( String fieldName : fieldToValue.keySet() )
      sobj.put( fieldName, fieldToValue.get( fieldName ) );
  }

  static Map<String, Map<String, Object>> jobTypeToRequiredFields = new Map<String, Map<String, Object>>
  {
      'Labor' => new Map<String,Object>
      {
        'Type__c' => 'Labor'
      },
      'Rental' => new Map<String,Object>
      {
        'Type__c' => 'Rental',
        'Days__c' => 10,
        'Daily_Rate__c' => 20
      },
      'Towing' => new Map<String,Object>
      {
        'Type__c' => 'Towing',
        'Amt__c' => 100,
        'Company_Name__c' => 'Acme',
        'Phone__c' => '1234567890',
        'Contact_Name__c' => 'xyz'
      }
  };

  @testVisible static Map<SObjectType, Map<String, Object>> objectTypeToRequiredFields = new Map<SObjectType, Map<String, Object>>
  {
    Agreement_Form_INT__c.SObjectType => new Map<String, Object>
    {
      'Aggregate_Clm_Lbl_Lmt__c' => 100,
      'Name' => '1234',
      'Agreement_Form_ID__c' => '1234'
    },
    Contract__c.SObjectType => new Map<String, Object>
    {
      'Status__c' => 'Active',
      'Vehicle_Code__c' => 'XXX',
      'Premium_Location_Code_INT__c' => '2',
      'RecordTypeId' => RecordTypeDAO.getRecordTypeId('Non_PPM', 'Contract__c')
    },
    Case.SObjectType => new Map<String, Object>
    {
      'Status' => 'Draft',
      'RecordTypeId' => RecordTypeDAO.getRecordTypeId('Mechanical_Legacy', 'Case')
    },
    Account.SObjectType => new Map<String, Object>
    {
      'Name' => 'Account Name Unit Test XYZ',
      'Phone' => '3125554444',
      'BillingCity' => 'Chicago',
      'BillingStreet' => 'Unit Test Street 1',
      'BillingCountry' => 'USA',
      'BillingPostalCode' => '60606',
      'BillingState' => 'IL',
      'RecordTypeId' => Schema.SObjectType.Account.getRecordTypeInfosByName().get(System.Label.P2_Account_Record_Type).getRecordTypeId()
    }
  };

  static void setupMechanicalCase()
  {
      RecordType contractNonPPMCase = RecordTypeDAO.getRecordType('Mechanical_Legacy', 'Case');
      RecordType contractNonPPM = RecordTypeDAO.getRecordType('Non_PPM', 'Contract__c');

      Account testAccount = TWGTestFactory.createAccount();
      insert testAccount;

      // Added by Fricco
      Agreement_Form_INT__c testAgreementFormINT = buildAgreementForm( null );
      insert testAgreementFormINT;

      Contract__c testContract = buildContract( new Map<String, Object>{'Account_Name__c' => testAccount.Id,
                                                   'Contract_Agreement_Form__c' => testAgreementFormINT.Id} );
      testContract.Status__c = 'New';
      insert testContract;

      Case testCase = buildCase( new Map<String, Object>{ 'AccountId' => testAccount.Id, 'Contract_New__c' => testContract.Id });
      insert testCase;
  }

  static Case getCase()
  {
      return [SELECT Id, AccountId, Status FROM Case LIMIT 1];
  }

  public static Agreement_Form_INT__c buildAgreementForm( Map<String, Object> fieldToValue )
  {
    return (Agreement_Form_INT__c)buildSObject( Agreement_Form_INT__c.SObjectType, fieldToValue );
  }

  public static Contract__c buildContract( Map<String, Object> fieldToValue )
  {
    return (Contract__c)buildSObject( Contract__c.SObjectType, fieldToValue );
  }

  public static Case buildCase( Map<String, Object> fieldToValue )
  {
    return (Case)buildSObject( Case.SObjectType, fieldToValue );
  }

  public static GLOW_r1_State_Code__c insertGlowR1StateCode(String abbr, String name) {
    GLOW_r1_State_Code__c sc = new GLOW_r1_State_Code__c(Abbreviation__c = abbr,State_Name__c = name, Name = name);

    insert sc;
    return sc;
  }

  public static Map<String, Object> queryQueriedFields(SObject sobj)
  {
      Map<String, Object> queriedFieldValues = (Map<String, Object>) JSON.deserializeUntyped(JSON.serialize(sobj));
      return queriedFieldValues;
  }

  //this method inserts records into all of the objects that are used for citi claims
  public static void setUpCitiTables(){
      TWGFIN_Services.bypassFinancialTrigger = true;
      TWGFIN_TestDataFactory.insertFieldSetCustomSetting();
      createEnvData();
      List<SObject> objsToInsert = new List<SObject>();
      Tier__c t = createTier(); // tier 1
      Tier__c t1 = createEliteTier(); //tier4
      Tier__c t2 = createTier(); //tier 3
      t2.Tier_Name__c = 'Travel Fee';
      t2.Name = 'T0003';
      t2.Tier_Number__c = '3';
      Benefit__c b = createBenefit(System.Label.RPSpace, System.Label.Benefit_Type_Cost_Plus, 'B0009');
      Benefit__c b1 = createBenefit(System.Label.CPRSpace, System.Label.Benefit_Type_Cost_Plus, 'B0007');
      Benefit__c b2 = createBenefit(System.Label.WTAISpace, System.Label.BenefitType_Risk, 'B0005');
      Benefit__c b3 = createBenefit(System.Label.RASpace, System.Label.BenefitType_Risk,'B0002');
      Benefit__c b4 = createBenefit(System.Label.PPSpace, System.Label.Benefit_Type_Cost_Plus,'B0015');
      Benefit__c b5 = createBenefit(System.Label.DTPPSpace, System.Label.Benefit_Type_Cost_Plus,'B0008');
      Benefit__c b6 = createBenefit(System.Label.WCRISpace, System.Label.Benefit_Type_Cost_Plus,'B0006');
      Benefit__c b7 = createBenefit(System.Label.BDPSpace, System.Label.Benefit_Type_Cost_Plus,'B0016');
      objsToInsert.add((SObject)(t));
      objsToInsert.add((SObject)(t1));
      objsToInsert.add((SObject)(b));
      objsToInsert.add((SObject)(b1));
      objsToInsert.add((SObject)(t2));
      objsToInsert.add((SObject)(b2));
      objsToInsert.add((SObject)(b3));
      objsToInsert.add((SObject)(b4));
      objsToInsert.add((SObject)(b5));
      objsToInsert.add((SObject)(b6));
      objsToInsert.add((SObject)(b7));
      insert objsToInsert;

      objsToInsert.clear();
      Product2 p = createProduct2(t, b); // core 90 day return protection
      p.Name = 'Core-90 Day Return Protection';
      objsToInsert.add((SObject) p);
      Product2 p2 = createProduct2(t,b1); //core cpr
      p2.Name = 'Core-Citi Price Rewind';
      objsToInsert.add((SObject) p2);
      Product2 p3 = createProduct2(t1,b1);//elite cpr
      p3.Name = 'Elite-Citi Price Rewind';
      objsToInsert.add((SObject) p3);
      Product2 p4 = createProduct2(t2,b2);//travel fee tai
      p4.Name = 'Travel Fee-Worldwide Travel Accident Insurance';
      objsToInsert.add((SObject) p4);
      Product2 p5 = createProduct2(t,b3);
      p5.Name = 'Core-Roadside Assistance Dispatch Service';
      objsToInsert.add((SObject) p5);
      Product2 p6 = createProduct2(t,b4);
      p6.Name = 'Core-Price Protection';
      objsToInsert.add((SObject) p6);
      Product2 p7 = createProduct2(t,b2);
      p7.Name = 'Core-Worldwide Travel Accident Insurance';
      objsToInsert.add((SObject) p7);
      Product2 p8 = createProduct2(t,b5);
      p8.Name = 'Core-Damage and Theft Purchase Protection';
      objsToInsert.add((sObject) p8);
      Product2 p9 = createProduct2(t,b6);
      p9.Name = 'Core-Worldwide Car Rental Insurance';
      objsToInsert.add((SObject) p9);
      Product2 p10 = createProduct2(t2,b7);
      p10.Name = 'Core-Baggage Delay Protection';
      objsToInsert.add((SObject) p10);
      insert objsToInsert;

      objsToInsert.clear();
      PID__c pid = createPID(t,'1','Citi Platinum Select Aadvantage World');
      objsToInsert.add((SObject)(pid));
      PID__c pid2 = createPID(t1,'2','Citi Platinum Select Aadvantage World');
      objsToInsert.add((SObject)(pid2));
      PID__c pid3 = createPID(t2,'90','Citi Prestige World Elite MasterCard');
      objsToInsert.add((SObject)(pid3));
      PID__c pid4 = createPID(t,'4','Citi Prestige World Elite MasterCard');
      objsToInsert.add((SObject)(pid4));
      PID__c pid5 = createPID(t,'9','Citi Prestige World Elite MasterCard');
      objsToInsert.add((SObject)(pid5));
      Benefit_Threshold__c bt = createBenefitThreshold(p);
      objsToInsert.add((SObject)(bt));
      Benefit_Threshold__c bt2 = createBenefitThreshold(p2);
      objsToInsert.add((SObject)(bt2));
      Benefit_Threshold__c bt3 = createBenefitThreshold(p4);
      objsToInsert.add((SObject)(bt3));
      Benefit_Threshold__c bt4 = createBenefitThreshold(p7);
      objsToInsert.add((sObject) bt4);
      Benefit_Threshold__c bt5 = createBenefitThreshold(p8);
      objsToInsert.add((sObject) bt5);
      Benefit_Threshold__c bt6 = createBenefitThreshold(p9);
      objsToInsert.add((sObject) bt6);
      Benefit_Threshold__c bt7 = createBenefitThreshold(p10);
      objsToInsert.add((sObject) bt7);

      insert objsToInsert;
  }

  //we need the environment custom setting and rest custom setting initialized
  public static void createEnvData(){
      CurrentEnvironment__c ce = new CurrentEnvironment__c();
      ce.Name = 'currentEnvironment';
      ce.environment__c = 'TEST';
      insert ce;

      SpringCM_REST_Environmental__c scm = new SpringCM_REST_Environmental__c();
      scm.Name = 'TEST';
      scm.Client_Secret__c = 'Client Secret';
      scm.Base_URL__c = 'Base URL';
      scm.API_Key__c = 'API Key';
      scm.Auth_URL__c = 'Auth URL';
      insert scm;

      SpringCMEos__Environment__c eose = new SpringCMEos__Environment__c();
      eose.Name = 'UAT';
      eose.SpringCMEos__Env_Prefix__c = 'uatna11.springcm.com';
      eose.SpringCMEos__Environment_Selected__c = true;
      eose.SpringCMEos__SpringCM_Account_ID__c = '8104';
      eose.SpringCMEos__SpringCM_REST_URL__c = 'restuatna11.springcm.com';
      insert eose;

      List<SpringCMEos__EOS_Type__c> listOfEOSType = new List<SpringCMEos__EOS_Type__c>();    
      SpringCMEos__EOS_Type__c scmeos = new SpringCMEos__EOS_Type__c();
      scmeos.SpringCMEos__Folder_Name__c ='{!CaseNumber}';
      scmeos.SpringCMEos__Path__c = '/Salesforce/Case/';
      scmeos.SpringCMEos__Variables__c = 'CaseNumber';
      scmeos.SpringCMEos__Folder_Name_Format__c = '{0}';
      scmeos.SpringCMEos__Path_Format__c = '/Salesforce/Case/';
      scmeos.Name = 'Case';
      listOfEOSType.add(scmeos);
      
      SpringCMEos__EOS_Type__c scmeosContract = new SpringCMEos__EOS_Type__c();
      scmeosContract.SpringCMEos__Folder_Name__c ='{!Name}-{!Policy_Number__c}';
      scmeosContract.SpringCMEos__Path__c = '/Salesforce/Contracts';
      scmeosContract.SpringCMEos__Variables__c = 'Name,Policy_Number__c';
      scmeosContract.SpringCMEos__Folder_Name_Format__c = '{0}';
      scmeosContract.SpringCMEos__Path_Format__c = '/Salesforce/Contracts';
      scmeosContract.Name = 'Contract__c';
      listOfEOSType.add(scmeosContract);

      SpringCMEos__EOS_Type__c scmeosQuote = new SpringCMEos__EOS_Type__c();
      scmeosQuote.SpringCMEos__Folder_Name__c ='{!Name}';
      scmeosQuote.SpringCMEos__Path__c = '/Salesforce/Quote';
      scmeosQuote.SpringCMEos__Variables__c = 'Name';
      scmeosQuote.SpringCMEos__Folder_Name_Format__c = '{0}';
      scmeosQuote.SpringCMEos__Path_Format__c = '/Salesforce/Quote';
      scmeosQuote.Name = 'Quote__c';
      listOfEOSType.add(scmeosQuote);
      insert listOfEOSType;       

      TWG_Admin_Support__c twgAdminSupport = new TWG_Admin_Support__c();
      twgAdminSupport.Name = 'Email Address';
      twgAdminSupport.CITI_Support_Email__c = 'test@yahoo.com';
      insert twgAdminSupport;

  }

  //method that inserts varied cases
  public static void insertCases() {
      List<SObject> objsToInsert = new List<SObject>();
      Case c = createSpecialtyCase(System.Label.RPUnderscore,System.Label.SpecialtyClaimRT);
      objsToInsert.add(c);

      Case c2 = createSpecialtyCase(System.Label.RPUnderscore,System.Label.SpecialtyClaimRT);
      c2.Claim_Payment_Amount__c = 200;
      objsToInsert.add(c2);

      List<Case> objsToInsert3 = new List<Case>();
      Case c3 = createCaseMultiUsers(System.Label.RPUnderscore);
      objsToInsert.add(c3);

      Case c4 = createSpecialtyCase(CaseConstants.CITI_PRICE_REWIND,System.Label.SpecialtyClaimRT);
      objsToInsert.add(c4);

      Case c5 = createSpecialtyCase(System.Label.CPRSpace,System.Label.SpecialtyEnquiryRT);
      objsToInsert.add(c5);
      insert objsToInsert;
  }

  //create a generic specialty case, dont care about the benefit name
  public static Case createSpecialtyCase(){
      return createSpecialtyCase(System.Label.RPSpace,System.Label.SpecialtyClaimRT);
  }

  //create a claim with a specificed benefit name and type
  public static Case createSpecialtyCase(String benefitName, String recordTypeName) {
      if (recordTypeName != System.Label.SpecialtyEnquiryRT && recordTypeName != System.Label.SpecialtyClaimRT){
          return null;
      }
      Id specialtyRTId = RecordTypeDAO.getCaseRecordTypeID(recordTypeName);
      Card_Holder__c ch = createCardHolder();
      insert ch;
      Card_Account__c ca = createCardAccount(ch);
      insert ca;
      Card_User__c cu = createCardUser(ca);
      insert cu;

      Case c = new Case(
          RecordTypeId = specialtyRTId,
          Benefit_Name__c = benefitName,
          Card_Account__c = ca.id,
          Card_Holder__c = ch.id,
          Card_User__c = cu.id,
          Subject = 'claim subject',
          Claim_Payment_Amount__c = 1,
          Customer_First_Name__c = ch.First_Name__c,
          Customer_Last_Name__c = ch.Last_Name__c,
          Primary_Phone__c = '1234567890',
          Status = 'Open',
          Client__c = 'CITI',
          Preferred_Method_of_Communication__c = 'Email',
          Preferred_Language_of_Communication__c = 'English',
          Email_Address__c  = 'test@yahoo.com',
          Required_Document_List__c = 'no doc',
          Item_Description__c = 'Guns',
          Date_of_Purchase__c = System.TODAY(),
          Purchase_Price__c = 15.0,
          Zip__c = '650116',
          Number_of_Cancellations_in_Attachements__c = 1,
          Cost_of_Item__c = 1
      );

      return c;
  }

  //create 5 cases for one card account
  public static List<Case> createCases() {
      Id specialtyRTId = RecordTypeDAO.getCaseRecordTypeID(System.Label.SpecialtyClaimRT);
      Card_Holder__c ch = createCardHolder();
      insert ch;
      Card_Account__c ca = createCardAccount(ch);
      insert ca;
      Card_User__c cu = createCardUser(ca);
      insert cu;
      List<Case> cases = new List<Case>();
      for (Integer i = 0; i < 5; i++ ) {
          Case c = new Case(
              RecordTypeId = specialtyRTId,
              Benefit_Name__c = System.Label.RPSpace,
              Client__c = 'CITI',
              Card_Account__c = ca.id,
              Card_Holder__c = ch.id,
              Card_User__c = cu.id,
              Subject = 'claim subject',
              Claim_Payment_Amount__c = 1
          );
          cases.add(c);
      }

      return cases;
  }

  //create a case with multiple card users
  public static Case createCaseMultiUsers(String benefitName){
      Id specialtyRTId = RecordTypeDAO.getCaseRecordTypeID(System.Label.SpecialtyClaimRT);
      Card_Holder__c ch = createCardHolder();
      insert ch;
      Card_Account__c ca = createCardAccount(ch,'Citi Platinum Select Aadvantage World');
      insert ca;
      Card_User__c c1 = createCardUser(ca);
      c1.Name = '5';
      Card_User__c c2 = createCardUser(ca);
      c2.Name = '6';
      List<Card_User__c> cuList = new List<Card_User__c>{c1,c2};
      insert cuList;
      Case c = new Case(
          RecordTypeId = specialtyRTId,
          Benefit_Name__c = benefitName,
          Client__c = 'CITI',
          Card_Account__c = ca.id,
          Card_Holder__c = ch.id,
          Card_User__c = cuList[0].id,
          Claim_Payment_Amount__c = 1
      );
      return c;
  }

    public static PID__c createPID(Tier__c t, String nme, String prodDesc) {
        PID__c p = new PID__c(
            CurrencyISOCode = 'USD',
            Name = nme,
            Product_Description__c = prodDesc,
            Tier_ID__c = t.id,
            Tier_Name__c = t.Tier_Name__c,
            Tier__c = t.Tier_Number__c
        );
        return p;
    }

    private static PID__c createPID2(Tier__c t) {
        PID__c p = new PID__c(
            CurrencyISOCode = 'USD',
            Name = '2',
            Product_Description__c = 'Citi Platinum Select Aadvantage World',
            Tier_ID__c = t.id,
            Tier_Name__c = t.Tier_Name__c,
            Tier__c = t.Tier_Number__c
        );
        return p;
    }

    private static PID__c createElitePID(Tier__c t){
        PID__c p = new PID__c(
            CurrencyISOCode = 'USD',
            Name = '90',
            Product_Description__c = 'Citi Prestige World Elite MasterCard',
            Tier_ID__c = t.id,
            Tier_Name__c = t.Tier_Name__c,
            Tier__c = t.Tier_Number__c
        );
        return p;
    }

    public static Product2 createProduct2(Tier__c t, Benefit__c b) {
        Product2 p = new Product2(
            CurrencyIsoCode = 'USD',
            Name = System.Label.RPSpace,
            Tier__c = t.id,
            Benefit__c = b.id,
            Start_Date__c = Date.today().addDays(-3)
        );
        return p;
    }

    public static Tier__c createTier() {
        Tier__c t = new Tier__c(
            Name = 'T0001',
            Tier_Name__c = 'Core',
            Tier_Number__c = '1'
        );
        return t;
    }

    private static Tier__c createEliteTier(){
        Tier__c t = new Tier__c(
            Name = 'T0004',
            Tier_Name__c = System.Label.Elite,
            Tier_Number__c = '4'
        );
        return t;
    }

    public static Benefit__c createBenefit(String benefitName, String benefitType, String name) {
        return new Benefit__c(
            Benefit_Name__c = benefitName,
            CurrencyISOCode = 'USD',
           // Name = name,
           // (Benefit__c)Mock.setFormulafield(Benefit__c, 
          //  new Map<String, Object>{'Name' => name});
            Type__c = benefitType,
            TRAN_SRC_CODE__c = '426'
        );
    }

  public static Card_User__c createCardUser(Card_Account__c ca) {
      Card_User__c c = new Card_User__c(
          Name = String.valueOf(Integer.valueOf(Math.random() *1000000)),
          Card_Account__c = ca.id,
          Card_User_Type__c ='Primary',
          Acct_Last_4__c = '2222',
          Sequence_Number__c = '22331232130033',
          Client__c = 'CITI'
      );
      return c;
  }

  //create a card holder
  public static Card_Holder__c createCardHolder() {
      Id rtId = [SELECT Name, Id, SobjectType FROM RecordType WHERE Name = 'Specialty Card Member' AND SobjectType = 'Card_Holder__c'].id;
      Card_Holder__c c = new Card_Holder__c(
          First_Name__c = 'Oleg',
          Last_Name__c = 'Kipnis',
          Email__c = 'olga@olga.com',
          Data_Source__c = 'User',
          Mailing_City__c = 'CHICAGO',
          Mailing_Country__c = 'USA',
          Mailing_State_Province__c = 'IL',
          Mailing_Street__c = '123 Arbor',
          Mailing_Zip_Postal_Code__c = '60642',
          MultiCard__c = false,
          RecordTypeId = rtId,
          Client__c = 'CITI'
      );
      return c;
  }

  //create a card account with a specified card holder
  public static Card_Account__c createCardAccount(Card_Holder__c cardHolder){
      return createCardAccount(cardHolder,'Citi Platinum Select Aadvantage World');
  }

  //create a card account with a specified card holder and a product description
  private static Card_Account__c createCardAccount(Card_Holder__c cardHolder, String productDescription) {
      Card_Account__c c = new Card_Account__c(
          Name = String.valueOf(Integer.valueOf(Math.random() *1000000)),
          Card_Holder__c = cardHolder.id,
          PID__c = '1',
          CurrencyISOCode = 'USD',
          Product_Description__c = productDescription,
          Tier_Name__c = 'Core',
          Tier__c = '1',
          Authorized_Users__c = 'A;B;C;',
          Client__c = 'CITI'
      );
      return c;
  }

  //create an elite card account
  private static Card_Account__c createEliteCardAccount(Card_Holder__c cardHolder){
       Card_Account__c c = new Card_Account__c(
          Card_Holder__c = cardHolder.id,
          PID__c = '90',
          CurrencyISOCode = 'USD',
          Product_Description__c = 'Citi Platinum Select Aadvantage World',
          Tier_Name__c = System.Label.Elite,
          Tier__c = '4'
      );
       return c;
  }

  public static Case createConsumerCase(Id contractId) {
    Id rtId = [SELECT Name, Id, SobjectType FROM RecordType WHERE DeveloperName = 'Consumer' AND SobjectType = 'Case'].id;
    Case c = new Case(
      Contract_New__c = contractId, Client__c = 'Consumer',
      RecordTypeId = rtId, Type = CaseConstants.CASE_TYPE_CLAIM      
    );
    return c;
  }

  //create a benefit threshold entry
  public static Benefit_Threshold__c createBenefitThreshold(Product2 p) {
      Benefit_Threshold__c b = new Benefit_Threshold__c(
          Product__c = p.id,
          Number_Of_Fast_Pay_Each_Year__c = 3,
          Fast_Pay_Limit__c = 100,
          Claim_Limit__c = 300,
          Annual_Limit__c = 1000,
          Auto_Approve_Limit__c = 2000,
          Effective_Date__c = Date.today().addDays(-30)
      );
      return b;
  }

  //get a mock web service response with specified parameters
  public static Map<String,String> setUpMockServiceResponse(String firstName, String lastName, String middleName, String dltid, String pid, String billingZip, String last4, String resultCode, Boolean authorized)
  {
      String firstNameAuth=null;
      String middleNameAuth = null;
      String lastNameAuth = null;
      String dltidAuth = null;
      String primaryCLTIDAccount = dltid + '0';
      String last4Auth=null;

      //if we are creating/updating an authorized user, we need to create/update a primary user too
      if (authorized){
          firstNameAuth = firstName;
          middleNameAuth = middleName;
          lastNameAuth = lastName;
          dltidAuth = dltid;
          last4Auth = last4;
          firstName = firstName + 'primary';
          middleName = middleName + 'primary';
          lastName = lastName + 'primary';
          dltid = dltid+'1';
          last4 = last4+'1';
      }

      Map<String,String> webServiceResult = new Map<String,String>();
      webServiceResult.put('GMTStamp','2016-01-01T10:30:16');
      webServiceResult.put('CustomerFirstName',firstName);
      webServiceResult.put('CustomerMidName',middleName);
      webServiceResult.put('CustomerLastName',lastName);
      webServiceResult.put('last4',last4);
      webServiceResult.put('BillingZIP',billingZip);
      webServiceResult.put('DLTID',dltid);
      webServiceResult.put('CallType','calltype');
      webServiceResult.put('vendorId','vendorId');
      webServiceResult.put('ResultCode',resultCode);
      webServiceResult.put('PrimaryDLTID',dltid);
      webServiceResult.put('PrimarySequenceNumber','123456789');
      webServiceResult.put('PrimaryCLTIDAccount',primaryCLTIDAccount);
      webServiceResult.put('PrimaryAcctLast4',last4);
      webServiceResult.put('PID',pid);
      webServiceResult.put('ProductName','ProductName');
      webServiceResult.put('DateBecomeMember','090201');
      webServiceResult.put('PortalId','portalId');
      webServiceResult.put('MultiCard','1');
      webServiceResult.put('StdPrimaryFirstName',firstName);
      webServiceResult.put('StdPrimaryMidName',middleName);
      webServiceResult.put('StdPrimaryLastName',lastName);
      webServiceResult.put('StdPrimaryAddress1','123 MAIN ST');
      webServiceResult.put('StdPrimaryAddress2','');
      webServiceResult.put('StdPrimaryCity','CHICAGO');
      webServiceResult.put('StdPrimaryState','IL');
      webServiceResult.put('StdPrimaryZIP',billingZip);
      webServiceResult.put('SrcPrimaryAddress1','123 MAIN ST Primary');
      webServiceResult.put('SrcPrimaryAddress2','APT 1 Primary');
      webServiceResult.put('SrcPrimaryCity','CHICAGO');
      webServiceResult.put('SrcPrimaryState','IL');
      webServiceResult.put('SrcPrimaryZIP',billingZip);
      webServiceResult.put('AuthDLTID',dltidAuth);
      webServiceResult.put('AuthSequenceNumber','123456789');
      webServiceResult.put('AuthCLTIDAccount','123456789');
      webServiceResult.put('AuthAcctLast4',last4Auth);
      webServiceResult.put('StdAuthFirstName',firstNameAuth);
      webServiceResult.put('StdAuthMidName',middleNameAuth);
      webServiceResult.put('StdAuthLastName',lastNameAuth);
      webServiceResult.put('StdAuthAddress1','123 MAIN ST Auth');
      webServiceResult.put('StdAuthAddress2','APT 1 Auth');
      webServiceResult.put('StdAuthCity','CHICAGO');
      webServiceResult.put('StdAuthState','IL');
      webServiceResult.put('StdAuthZIP',billingZip);
      webServiceResult.put('SrcAuthAddress1','123 MAIN ST');
      webServiceResult.put('SrcAuthAddress2','');
      webServiceResult.put('SrcAuthCity','CHICAGO');
      webServiceResult.put('SrcAuthState','IL');
      webServiceResult.put('SrcAuthZIP',billingZip);
      webServiceResult.put('PrimaryEmail','JDOE@isp.com');
      webServiceResult.put('EmailServiceFlag','email service flag');
      webServiceResult.put('EmailPermission','email permission');
      webServiceResult.put('AuthorizedUser1','ROBERT:SMITH');
      webServiceResult.put('AuthorizedUser2','BEVERLY A:SMITH');
      webServiceResult.put('AuthorizedUser3','DAMON SCOTT:SMITH');
      webServiceResult.put('AuthorizedUser4','');
      webServiceResult.put('AuthorizedUser5','');
      webServiceResult.put('AuthorizedUser6','');
      webServiceResult.put('AuthorizedUser7','');
      webServiceResult.put('AuthorizedUser8','');
      webServiceResult.put('AuthorizedUser9','');
      webServiceResult.put('AuthorizedUser10','');
      webServiceResult.put('PrimaryCustLanguageCode','English');
      webServiceResult.put('TransactionId','XXXXXXXXXXXXXXXXXX');
      return webServiceResult;
  }

  public static void populateLanguageCustomSetting()
  {
      insert new Language_Selector__c(Name= 'English',Code__c= 'en',EnglishName__c='English');
      insert new Language_Selector__c(Name= 'French',Code__c = 'fr',EnglishName__c='French');
  }

  public static void populateTermsandConditionsURLCustomSetting()
  {
      List<ConsumerTermsAndConditionsURL__c> listOfConsumerTermCondition = new List<ConsumerTermsAndConditionsURL__c>();
      listOfConsumerTermCondition.add(new ConsumerTermsAndConditionsURL__c(Name= 'German', URL__c='https://www.salesforce.com'));
      listOfConsumerTermCondition.add(new ConsumerTermsAndConditionsURL__c(Name= 'French', 
          URL__c='https://login.salesforce.com'));
      listOfConsumerTermCondition.add(new ConsumerTermsAndConditionsURL__c(Name= 'Russian', 
          URL__c='https://certification.salesforce.com'));
      listOfConsumerTermCondition.add(new ConsumerTermsAndConditionsURL__c(Name= 'Spanish', 
          URL__c='https://appexchange.salesforce.com'));
      listOfConsumerTermCondition.add(new ConsumerTermsAndConditionsURL__c(Name='UK', URL__c='https://schedule.salesforce.com'));
      listOfConsumerTermCondition.add(new ConsumerTermsAndConditionsURL__c(Name= 'Ukrainian', 
          URL__c='https://test.salesforce.com'));
      listOfConsumerTermCondition.add(new ConsumerTermsAndConditionsURL__c(Name= 'Poland', 
          URL__c='https://test1.salesforce.com'));
      listOfConsumerTermCondition.add(new ConsumerTermsAndConditionsURL__c(Name= 'US', 
          URL__c='https://testus.salesforce.com'));
      insert listOfConsumerTermCondition;
  }
  public static Contract__c createConsumerContract()
  {
      Id rtId = [SELECT Name, Id, SobjectType FROM RecordType WHERE DeveloperName = :ContractConstants.CONSUMER_CONTRACT_REC_TYPE_DEV_NAME   AND SobjectType = 'Contract__c'].id;
      Contract__c contract = new Contract__c(RecordtypeId =rtId ,Product_Name__c='Sample product',OrderID__c='11111',Purchase_Price__c= 1234,Product_Price__c= 1234,Manufacturer__c = 'Sony',Purchase_Date__c= Date.today(),
          BizID__c='11110', Status__c = ContractConstants.ACTIVE_STATUS, Has_Open_Case__c = false,
          Premium_Location_Code_INT__c = 'T', Name = 'Test', Preferred_Language__c = Label.English_Language_Abbreviation,
          Shipping_Country__c = 'ES', Product_Purchase_Date__c = Date.today(), Total_Dealer_Cost__c = 2.0,
          Total_Insurance_Premium__c = 2.0, Total_Reserve__c = 2.0, Total_Administrative_Fee__c = 2.0,
          Total_Marketing_Fee__c = 2.0, Total_Risk_Fee__c = 2.0, Total_Risk_Fee_2__c = 2.0, Total_Tax_IP__c = 2.0,
          Broker_Fee__c = 2.0, Total_Dealer_Commission__c = 2.0, Outgoing_Reinsurance_Premium__c = 2.0, Commissions__c = 2.0,
          Province_State_Tax__c = 2.0, Misc_Admin_Fee__c = 2.0, Misc_Fee_1__c = 2.0, Misc_Fee_2__c = 2.0, Misc_Fee_3__c = 2.0,
          Misc_Fee_4__c = 2.0, Misc_Fee_5__c = 2.0, Per_Claim_Fee__c = 2.0,Loss_Fund_1__c = 2.0, Loss_Fund_2__c = 2.0,
          Loss_Fund_3__c = 2.0, Loss_Fund_4__c  = 2.0);
      return contract;
  }

    public static Service_Order__c createServiceOrder(Id caseId, String status, String contractor, String provider, Id account){
        Service_Order__c s = new Service_Order__c(Case__c = caseId, Status__c = status, Servicer_Contractor_Name__c = contractor,Service_Provider__c = provider);
        if (account != null){
            s.Servicer_Account__c = account;
        }
        Map<Id, RecordType> serviceOrderTypes = RecordTypeDAO.getRecordTypesBySObject('Service_Order__c');
        for(ID id : serviceOrderTypes.keySet()){
            if (serviceOrderTypes.get(id).DeveloperName == 'Specialty_Service_Order'){
                s.RecordTypeId = id;
                break;
            }
        }
        return s;
    }

    public static Case createATBoschCase(String benefitName, String recordTypeName) {
        if (recordTypeName != CaseConstants.AT_BOSCH_RECORD_TYPE){
          return null;
        }
        Id specialtyRTId = RecordTypeDAO.getCaseRecordTypeID(recordTypeName);
        Card_Holder__c ch = createCardHolder();
        insert ch;
        Card_Account__c ca = createCardAccount(ch);
        insert ca;
        Card_User__c cu = createCardUser(ca);
        insert cu;

        Case c = new Case(
            RecordTypeId = specialtyRTId,
            Benefit_Name__c = benefitName,
            Card_Account__c = ca.id,
            Card_Holder__c = ch.id,
            Card_User__c = cu.id,
            Subject = 'claim subject',
            Claim_Payment_Amount__c = 1,
            Customer_First_Name__c = ch.First_Name__c,
            Customer_Last_Name__c = ch.Last_Name__c,
            Primary_Phone__c = '1234567890',
            Status = 'Open',
            Preferred_Method_of_Communication__c = 'Email',
            Email_Address__c  = 'test@yahoo.com',
            Required_Document_List__c = 'no doc'
        );

        return c;
    }

    public static P2_Contract__c createP2Contract(){
        Contact c = createP2Contact();
        insert c;

        P2_Product__c p = createP2Product();
        insert p;

        P2_Rate__c r = createP2Rate(p);
        insert r;

        Account a = createAffinityPartner();
        if (a.id == null) {
            insert a;
        }

        P2_Contract__c ctr = new P2_Contract__c();
        ctr.RecordTypeId = Schema.SObjectType.P2_Contract__c.getRecordTypeInfosByName().get(P2Constants.P2_CONTRACT_RECORD_TYPE).getRecordTypeId();
        ctr.Contact__c = c.Id;
        ctr.Status__c = P2Constants.P2_CONTRACT_STATUS_ACTIVE;
        ctr.Payment_Type__c = P2Constants.PAYMENT_TYPE_SINGLE;
        ctr.Serial__c = 'XXXXXXXXXX';
        ctr.P2_Rate__c = r.Id;
        ctr.Chargify_Subscription_Id__c = '123';
        ctr.Contract_Purchase_Date__c = Date.Today();
        ctr.lead_source__c = a.id;

        return ctr;
    }

    public static P2_Product__c createP2Product() {

        P2_Product__c p = new P2_Product__c();
        P.RecordTypeId = Schema.SObjectType.P2_Product__c.getRecordTypeInfosByName().get(P2Constants.P2_PRODUCT_RECORD_TYPE).getRecordTypeId();
        p.Name = 'Laptop';
        p.Product_Information__c = 'Laptop';
        p.Product_Key__c = 'LAPTOP';
        p.Manufacturer_s_Warranty_Period__c = 365;
        p.Start_Date__c = date.today().addDays(-365);
        p.End_Date__c = date.today().addDays(365);
        p.Threshold__c = 100;
        p.Chargify_Component_Id__c = 'product_component_id';

        return p;
    }

    public static P2_Rate__c createP2Rate(P2_Product__c p) {

        P2_Rate__c r = new P2_Rate__c();
        r.RecordTypeId = Schema.SObjectType.P2_Rate__c.getRecordTypeInfosByName().get(P2Constants.P2_RATE_RECORD_TYPE).getRecordTypeId();
        r.Product__c = p.Id;
        r.Start_Date__c = Date.today().addDays(-365);
        r.End_Date__c = Date.today().addDays(365);
        r.Term__c = 1;
        r.Low_Retail_Price__c = 0;
        r.High_Retail_Price__c = 1000;
        r.Lump_Sum_Rate__c = 12;
        r.Monthly_Rate__c = 1;
        r.Affinity_Fee__c = 100;
        r.Illinois_Premium_Tax__c = 0;
        r.Reserve_Fund__c = 0;
        r.Risk_Fee_1_to_VSC__c = 0;
        r.Risk_Fee_2_to_Obligor_Companies__c = 0;
        r.Sales_Tax__c = 0;
        r.Service_Provider_Fee__c = 0;
        r.TWG_Admin_Fee__c = 0;
        r.Chargify_Monthly_Product_Handle__c = 'TEST';
        r.Chargify_Single_Product_Handle__c = 'TEST';

        return r;
    }

     public static Account createAffinityPartner() {
        Account a = null;
        List<Account> accountList = new List<Account>();
        String recordTypeID = Schema.SObjectType.Account.getRecordTypeInfosByName().get(P2Constants.ACCOUNT_AFFINITY_PARTNER_RECORD_TYPE).getRecordTypeId();
        accountList = [select id, name, RecordTypeId, Affinity_Id__c, Affinity_Type__c
                       from account
                       where RecordTypeId = :recordTypeID];

        if (accountList != null && accountList.size() > 0) {
            a = accountList.get(0);
        } else {
            a = new Account();
            a.RecordTypeId = recordTypeID;
            a.Name = 'Test Tester';
            a.Affinity_Id__c = 'BSH';
            a.Affinity_Type__c = P2Constants.P2_AFFINITY_TYPE_WEB;
        }

        return a;
    }

    public static Contact createP2Contact(){

        Contact c = new Contact();
        c.RecordTypeId = Schema.SObjectType.Contact.getRecordTypeInfosByName().get(P2Constants.CONTACT_RECORD_TYPE).getRecordTypeId();
        c.FirstName = 'Test';
        c.LastName = 'Tester';
        c.email = 'test@sfdctest.com';
        c.Phone = '555-555-5555';

        return c;
    }

    public static c2g__codaCompany__c companyTestSetup(String companyName,String externalId){
        c2g__codaCompany__c company = new c2g__codaCompany__c(Name = companyName,c2g__ExternalId__c = externalId);
        return company ;
    }

    public static String setUpCurrentCompany(String companyName){

        Group companyGroup = new Group(Name=''+companyName, Type='Queue');
        insert companyGroup;
        QueuesObject testQueue ;
        List<queuesobject >  listQueue = new List<queuesobject >();
        System.runAs(new User(Id=UserInfo.getUserId()))
        {
            listQueue.add(new queuesobject (queueid=companyGroup.id,sobjecttype='c2g__codaBankAccount__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id,sobjecttype='c2g__codaAccountingCurrency__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id,sobjecttype='c2g__codaJournal__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaCompany__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaYear__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__AsOfAging__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__CancelPayment__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__ReportingBalance__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__WorkerItem__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaBankReconciliation__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaBankStatement__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaBudget__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaCashEntry__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaCreditNote__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaCashMatchingHistory__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaCurrencyRevaluationGroup__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaCurrencyRevaluation__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaGroupingReference__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaIntercompanyDefinition__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaIntercompanyTransfer__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaInvoice__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaMatchingReference__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaPaymentMediaControl__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaPaymentMediaSummary__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaPaymentTemplate__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaPayment__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaPurchaseCreditNote__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaPurchaseInvoice__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaTextDefinition__c'));
            listQueue.add(new queuesobject (queueid=companyGroup.id, sobjecttype='c2g__codaTransaction__c'));
            insert  listQueue;

            GroupMember GroupMemberObj = new GroupMember();
            GroupMemberObj.GroupId = companyGroup.id;
            GroupMemberObj.UserOrGroupId = UserInfo.getUserId();
            insert GroupMemberObj;
        }
        return companyGroup.Id;
    }

    public static c2g__codaUserCompany__c userCompanyTestSetup(c2g__codaCompany__c company)
    {

        c2g__codaUserCompany__c userCompany = new c2g__codaUserCompany__c();
        userCompany.c2g__Company__c = company.id;
        userCompany.c2g__User__c = userInfo.getUserId();
        userCompany.c2g__UnitOfWork__c = 111 ;
        return userCompany;
    }

    public static c2g__codaYear__c yearTestSetup(c2g__codaCompany__c company)
    {
        c2g__codaYear__c year= new c2g__codaYear__c();
        year.Name ='2015';
        year.c2g__AutomaticPeriodList__c =  true;
        year.c2g__OwnerCompany__c = company.id;
        year.c2g__ExternalId__c = 'yzsd1234';
        year.c2g__NumberOfPeriods__c =11;
        year.c2g__StartDate__c =  system.today() - 10;
        year.c2g__Status__c = 'Open';
        year.c2g__PeriodCalculationBasis__c = '445';
        year.c2g__YearEndMode__c = 'Full Accounting Code' ;
        year.c2g__UnitOfWork__c = 12;
        return year;
    }

    public static c2g__codaPeriod__c periodTestSetUp(c2g__codaCompany__c company,c2g__codaYear__c year)
    {
        c2g__codaPeriod__c period = new c2g__codaPeriod__c();
        period.Name ='2015/001';
        period.c2g__ExternalId__c ='abdc12345';
        period.c2g__StartDate__c = System.today()-10;
        period.c2g__EndDate__c= System.today()+10;
        period.c2g__OwnerCompany__c = company.id;
        period.c2g__PeriodNumber__c ='123';
        period.c2g__Description__c ='test Desc';
        period.c2g__PeriodGroup__c = 'Q1';
        period.c2g__PeriodNumber__c = '1';
        period.c2g__YearName__c = year.id;
        return period;
    }

    public static c2g__codaGeneralLedgerAccount__c generalLedgerAccountTestSetup()
    {
        c2g__codaGeneralLedgerAccount__c generalLedgerAccount = new c2g__codaGeneralLedgerAccount__c(Name='GLA1',c2g__ReportingCode__c='GLA123',c2g__Type__c='Balance Sheet', CurrencyIsoCode='USD');
        return generalLedgerAccount ;
    }

    public static c2g__codaAccountingCurrency__c currencyTestSetup(c2g__codaCompany__c company)
    {
        c2g__codaAccountingCurrency__c accCurrency = new c2g__codaAccountingCurrency__c();
        accCurrency.c2g__OwnerCompany__c = company.id;
        accCurrency.Name = 'USD';
        accCurrency.c2g__Home__c = true ;
        accCurrency.c2g__Dual__c = true ;
        accCurrency.c2g__DecimalPlaces__c =0;
        return accCurrency;
    }

    public static c2g__codaBankAccount__c bankAccountDataSetup(c2g__codaCompany__c company,c2g__codaGeneralLedgerAccount__c generalLedgerAccount,c2g__codaAccountingCurrency__c accCurrency){

        c2g__codaBankAccount__c bankAccount = new c2g__codaBankAccount__c();
        bankAccount.Name = company.Name;
        bankAccount.c2g__ReportingCode__c = company.id;
        bankAccount.c2g__AccountName__c = company.Name;
        bankAccount.c2g__BankName__c = company.Name;
        bankAccount.c2g__AccountNumber__c = '606065';
        bankAccount.c2g__OwnerCompany__c = company.id;
        bankAccount.c2g__GeneralLedgerAccount__c = generalLedgerAccount.id;
        bankAccount.c2g__BankAccountCurrency__c =accCurrency.id;
        return bankAccount;
    }

    public static Account accountTestDataSetup(c2g__codaGeneralLedgerAccount__c generalLedgerAccount,String accountName)
    {
        Account testAccount = new Account();
        testAccount.Name = accountName;
        testAccount.BillingStreet = '17901 Von Karman Avenue';
        testAccount.BillingCity = 'Irvine';
        testAccount.BillingState = 'CA';
        testAccount.BillingPostalCode = '92614';
        testAccount.BillingCountry = 'USA';
        testAccount.Area__c='Area';
        testAccount.Billing_Street__c='Address Street 1';
        testAccount.Billing_Street_2__c='Address Street 2';
        testAccount.RDG_Nbr__c='99999';
        testAccount.RecordTypeId = Schema.SObjectType.Account.getRecordTypeInfosByName().get('P2 Account').getRecordTypeId();
        testAccount.c2g__CODAAccountsPayableControl__c = generalLedgerAccount.id;
        testAccount.c2g__CODAAccountsReceivableControl__c = generalLedgerAccount.id;
        testAccount.c2g__CODAAccountTradingCurrency__c = 'USD';
        testAccount.Contract_Type__c = BillingStatementConstants.AT_BULK;
        testAccount.Invoice_Due_Days__c = 10;
        testAccount.Term_Frequency__c = 'Monthly';
        testAccount.Start_Date__c = System.today()-3;
        testAccount.End_Date__c  = System.today()+3;
        return testAccount;
    }

    public static Contact contactTestDataSetup(String contactName,Id accountId)
     {
        Contact testContact = new Contact();
        testContact.AccountId=accountId;
        testContact.LastName='Contact';
        testContact.FirstName=contactName;
        return testContact;
    }

    public static List<P2_Product__c> productTestSetup()
    {
        List<P2_Product__c> productList=new List<P2_Product__c>();
        productList.add(new P2_Product__c(Name='Product1',Product_Key__c='Product1Key',CurrencyIsoCode='USD',Manufacturer_s_Warranty_Period__c=34,Product_Information__c='Refrigerator'));
        productList.add(new P2_Product__c(Name='Product2',Product_Key__c='Product2Key',CurrencyIsoCode='USD',Manufacturer_s_Warranty_Period__c=23,Product_Information__c='Washing Machine'));
        return productList;
    }

    public static List<P2_Rate__c> rateTestSetup(List<P2_Product__c> productList)
    {
        Integer i=0;
        List<P2_Rate__c> rateList=new List<P2_Rate__c>();
        List<String> AgreementType=new List<String>{'Bosch','Thermoder'};
        for(P2_Product__c product:productList)
        {
            P2_Rate__c testRate=new P2_Rate__c();
            testRate.Product__c=product.id;
            testRate.Premium__c=54.32;
            testRate.CurrencyIsoCode='USD';
            testRate.Low_Retail_Price__c=5376;
            testRate.High_Retail_Price__c=5643;
            testRate.Monthly_Rate__c=43.23;
            testRate.Lump_Sum_Rate__c=76.4;
            testRate.Agreement_Type__c=AgreementType.get(i);
            rateList.add(testRate);
            i++;
        }
        return rateList;
    }

    public static P2_Contract__c contractTestSetup(Account account,Contact contact,P2_Rate__c rate,String status,Double tax,Double term)
    {
        P2_Contract__c testContract =new P2_Contract__c();
        testContract.Contact__c=contact.Id;
        testContract.Term_Months__c =65;
        testContract.Contract_Purchase_Date__c=System.today();
        testContract.start_Date__c = System.today();
        testContract.Lead_Source__c=account.id;
        testContract.Model__c='Model';
        testContract.P2_Rate__c=rate.id;
        testContract.Start_Date__c=System.today();
        testContract.Serial__c='SerialNumber';
        testContract.Status__c='Active';
        testContract.Tax__c=tax;
        testContract.Term__c=term;
        testContract.Payment_Type__c='Monthly';
        if(status.equals('Cancelled')){
            insert testContract;
            testContract.Status__c = status;
            testContract.Is_Processed_For_New_Business__c=true;
            testContract.Cancellation_Date__c = System.today();
            testContract.cancellation_code__c = 'Customer Cancellation';
            testContract.Cancel_Request_Date__c = System.today();
            testContract.Cancel_Process_Date__c = System.today();
        }
        return testContract;
    }

    public static List<Billing_Line_Item__c> billingLineItemTestDataSetup(String accountID, String recordTypeID, String periodID){
        List<Billing_Line_Item__c> billingLineItemsList = new List<Billing_Line_Item__c>();
        Billing_Line_Item__c billingLineItem = new Billing_Line_Item__c();
        billingLineItem.Status__c = Label.Sales;
        billingLineItem.Total_Amount__c = 10.00;
        billingLineItem.Customer__c = accountID;
        billingLineItem.Customer_Name__c = 'David';
        billingLineItem.Company__c = Label.CompanyName;
        billingLineItem.RecordTypeId = recordTypeID;
        billingLineItem.Period__c = periodID;
        billingLineItem.Agreement_Created_Date__c = system.today();
        billingLineItemsList.add(billingLineItem);
        billingLineItem = new Billing_Line_Item__c();
        billingLineItem.Status__c = Label.Sales;
        billingLineItem.Total_Amount__c = 20.00;
        billingLineItem.Customer__c = accountID;
        billingLineItem.Customer_Name__c = 'Jason';
        billingLineItem.Company__c = Label.CompanyName;
        billingLineItem.RecordTypeId = recordTypeID;
        billingLineItem.Period__c = periodID;
        billingLineItem.Agreement_Created_Date__c = system.today();
        billingLineItemsList.add(billingLineItem);
        billingLineItem = new Billing_Line_Item__c();
        billingLineItem.Status__c = Label.Cancels;
        billingLineItem.Total_Amount__c = 5.00;
        billingLineItem.Customer__c = accountID;
        billingLineItem.Customer_Name__c = 'Mark';
        billingLineItem.Company__c = Label.CompanyName;
        billingLineItem.RecordTypeId = recordTypeID;
        billingLineItem.Period__c = periodID;
        billingLineItem.Agreement_Created_Date__c = system.today();
        billingLineItemsList.add(billingLineItem);
        return billingLineItemsList;
    }
    public static List<Revenue_Account_Distribution__c> revenueAccountDistributionForCostPlus(List<Product2> productList)
    {
        List<Revenue_Account_Distribution__c> revenueAccountDistributionList=new List<Revenue_Account_Distribution__c>();
        Revenue_Account_Distribution__c revenueAccountDistribution1=new Revenue_Account_Distribution__c(
            Effective_Start_Date__c=system.today(),
            Expiration_Date__c=system.today(),
            Products__c=productList[0].id,
            Annual_Rates__c=65,
            Admin_Markup__c=0.19,
            TWG_Admin_Fee__c=0.12,
            Monthly_Rates__c=30,
            VSC_Ceding_Fee__c= 0.19,
            Claim_Fees__c=15
        );
        Revenue_Account_Distribution__c revenueAccountDistribution2=new Revenue_Account_Distribution__c(
            Effective_Start_Date__c=system.today(),
            Expiration_Date__c=system.today(),
            Products__c=productList[1].id,
            Annual_Rates__c=75,
            Admin_Markup__c=0.09,
            TWG_Admin_Fee__c=0.12,
            Monthly_Rates__c=30,
            VSC_Ceding_Fee__c= 0.09,
            Claim_Fees__c=30
        );
        Revenue_Account_Distribution__c revenueAccountDistribution3=new Revenue_Account_Distribution__c(
            Effective_Start_Date__c=system.today(),
            Expiration_Date__c=system.today(),
            Products__c=productList[2].id,
            Annual_Rates__c=85,
            Admin_Markup__c=0.29,
            TWG_Admin_Fee__c=0.12,
            VSC_Ceding_Fee__c= 0.29,
            Monthly_Rates__c=30,
            Claim_Fees__c=10
        );
        Revenue_Account_Distribution__c revenueAccountDistribution4=new Revenue_Account_Distribution__c(
            Effective_Start_Date__c=system.today(),
            Expiration_Date__c=system.today(),
            Products__c=productList[3].id,
            Annual_Rates__c=95,
            Admin_Markup__c=0.09,
            TWG_Admin_Fee__c=0.12,
            Monthly_Rates__c=30,
            VSC_Ceding_Fee__c= 0.09,
            Claim_Fees__c=20
        );

        revenueAccountDistributionList.add(revenueAccountDistribution1);
        revenueAccountDistributionList.add(revenueAccountDistribution2);
        revenueAccountDistributionList.add(revenueAccountDistribution3);
        revenueAccountDistributionList.add(revenueAccountDistribution4);

        return  revenueAccountDistributionList;
    }

    public static Contract_Line_Item__c createContractLineItem(String contractId, String bundleId, String productId) {
        Contract_Line_Item__c contractLineItem =
            new Contract_Line_Item__c(Bundle__c = bundleId, Contract__c = contractId,
                                      Inspection_Status__c = 'Pending Repair',
                                      Product_Item__c = productId, IMEI_Code__c = '500098043846665');
        return contractLineItem;
    }

    public static Product2 createProduct2(String recordTypeId) {
        return new Product2(Name = 'testBundle', IsActive = true, RecordTypeId = recordTypeId, Start_Date__c = Date.today().addDays(-3));
    }

    public static Rate__c createRate(String bundleProductId) {
        return new Rate__c(Name = 'testRate', Bundle_Product__c = bundleProductId);
    }

    public static Tenure__c createTenure(String bundleProductId) {
        return new Tenure__c(Name = 'testTenure', Bundle_Product__c = bundleProductId);
    }

    public static Tenure_Rate__c createTenureRate(String rateId, String tenureId) {
        return new Tenure_Rate__c(Name = 'testTenureRate', Premium__c = 399, Rate__c = rateId, Tenure__c = tenureId);
    }

    public static User createExternalUser(String profileId) {
        return new User(ProfileId = profileId, UserName = 'newYahooUser@yahoo.com',
            Email = 'externalUser@yahoo.com', EmailenCodingKey = 'UTF-8', LocalesIdKey = 'en_US',
            LanguageLocaleKey = 'en_US', TimeZonesIdKey = 'America/Los_Angeles', Alias = 'extUser',
            LastName = 'lastname');
    }

    public static User createUser(String profileId) {
        return new User(ProfileId = profileId, UserName = 'newYahooUser@yahoo.com',
            Email = 'externalUser@yahoo.com', EmailenCodingKey = 'UTF-8', LocalesIdKey = 'en_US',
            LanguageLocaleKey = 'en_US', TimeZonesIdKey = 'America/Los_Angeles', Alias = 'extUser',
            LastName = 'lastname');
    }

    public static User createChatterUser(String profileId) {
        return new User(ProfileId = profileId, UserName = 'johndoe@chatter.com',
            Email = 'johndoe@chatter.com', EmailenCodingKey = 'UTF-8', LocalesIdKey = 'en_US',
            LanguageLocaleKey = 'en_US', TimeZonesIdKey = 'America/Los_Angeles', Alias = 'extUser',
            LastName = 'lastnamez');
    }

    public static Attachment createAttachment() {
        Attachment attach = new Attachment();
        attach.Name = 'xyz';
        blob b = Blob.valueof('acasca');
        attach.Body = b;
        attach.Description = 'test';
        return attach;
    }

    public static Attachment createAttachmentForMock() {
        return new Attachment(
            Name = 'Attachment1',
            Body = Blob.valueOf('This is a test Blob'),
            Description = 'test blob',
            Id = TWGTestFactory.getFakeId(Attachment.sObjectType)
        );
    }

    public static Product2 createProduct() {
        Product2 testProduct = new Product2();
        testProduct.Name = 'testProduct';
        return testProduct;
    }

    public static Account createPersonAccount() {
        Account testAccount = new Account();
        testAccount.PersonMailingStreet = 'Test Circle';
        testAccount.PersonMailingCity = 'Test City';
        testAccount.PersonMailingState = 'Alabama';
        testAccount.PersonMailingPostalCode = '60563';
        testAccount.PersonMailingCountry = 'United States';
        testAccount.FirstName = 'Samsung';
        testAccount.LastName = 'Australia';
        testAccount.AccountNumber = 'TEST02';
        return testAccount;
    }

    public static RecordType getPersonAccountRecordType(String recordTypeDeveloperName, String sObjectAPI) {
        return [SELECT Id, Name
                FROM RecordType
                WHERE DeveloperName =: recordTypeDeveloperName AND IsPersonType = true
                AND SobjectType =: sObjectAPI];
    }

    public static Payment_Statement__c createPaymentStatement(String month, String year){
        Payment_Statement__c paymentStatement = new Payment_Statement__c();
        paymentStatement.Date_Billed__c = System.today();
        paymentStatement.Month__c = month;
        paymentStatement.Year__c = year;
        paymentStatement.Statement_Id__c = 'MAR000001';
        paymentStatement.Invoice_Total__c = 10.00;
        paymentStatement.Total_Amount__c = 10.00;
        paymentStatement.Outstanding_Amount__c = 10.00;
        return paymentStatement;
    }

    public static Payment_Order__c createPaymentOrder(String recordType, String accountID, String contractID){
        Payment_Order__c paymentOrder = new Payment_Order__c();
        paymentOrder.Payee_Type__c = Label.Payee_Type_Vendor;
        paymentOrder.Mode_of_Payment__c = Label.PaymentViaCheck;
        paymentOrder.Payment_Status__c = Label.Authorized_for_Payment;
        paymentOrder.Payment_Amount__c = 10.0;
        paymentOrder.RecordTypeId = recordType;
        paymentOrder.Account__c = accountID;
        paymentOrder.P2_Contract__c = contractID;
        return paymentOrder;
    }

    public static Contract_Line_Item__c createContractLineItemByContract(String contractId)
    {
        Contract_Line_Item__c contractLineItem = new Contract_Line_Item__c(Contract__c = contractId);
        return contractLineItem;
    }

    public static Contract_Event__c createContractEvent(Id contractID, Integer amount, String developerName) {
        Id getRecordTypeID = RecordTypeDAO.getRecordTypeId(developerName,'Contract_Event__c');
        Contract_Event__c newContractEvent = new Contract_Event__c();
        newContractEvent.Contract__c = contractID;
        newContractEvent.Amount__c = amount;
        newContractEvent.RecordTypeId = getRecordTypeID;
        newContractEvent.Status__c = 'SUCCESS';
        newContractEvent.Occurrence__c = System.today();
        return  newContractEvent;
    }

    public static Visit__c createVisitByCaseId(Id caseId)
    {
        Visit__c visit = new Visit__c(Claim__c = caseId);
        return visit;
    }

    public static Service_Report__c createServiceReportByCaseId(Id caseId)
    {
        Service_Report__c testReport = new Service_Report__c();
        testReport.Case__c = caseId;
        testReport.Fault_Description__c = 'test sample fault';
        testReport.Labour__c = 50;
        testReport.VAT__c = 1;
        testReport.Service_Tax__c = 1;
        testReport.Transport__c = 1;
        testReport.Discount__c = 1;
        return testReport;
    }

    public static Contact createATContact(){
        Contact c = new Contact();
        c.RecordTypeId = RecordTypeDAO.getRecordTypeId('AT_Contact','Contact');
        c.FirstName = 'Test';
        c.LastName = 'TesterP';
        c.email = 'test@sfdcteswqt.com';
        c.Contact_Type__c = 'Standard User';
        c.phone = '9887589558';
        return c;
    }

    public static Account createATAccount(){
        id recordTypeId = RecordTypeDAO.getRecordTypeId('AT_Affinity_Partner','Account');
        Account accountRecord = new Account(name ='DOMINION123', Affinity_Id__c = TWG_Constants.DOMINION_AFFINITY_PARTNER, RecordTypeId = recordTypeId ) ;
        return accountRecord ;
    }

    public static Account createATBoschAccount(){
        id recordTypeId = RecordTypeDAO.getRecordTypeId('AT_Affinity_Partner','Account');
        Account accountRecord = new Account(name ='Bosch123', Affinity_Id__c = System.Label.Bosch, RecordTypeId = recordTypeId ) ;
        return accountRecord ;
    }

    public static Product2 createProduct2()
    {
        Id recordTypeId = RecordTypeDAO.getRecordTypeId('AT_Product_Category','Product2');
        Product2 productRecord = new Product2();
        productRecord.Name = 'product1';
        productRecord.Product_Client__c = 'DOMINION';
        productRecord.recordTypeId = recordTypeId;
        productRecord.IsActive = true;
        return productRecord;
    }

    public static List<Billing_Line_Item__c> createBillingLineItem(String accountID, String recordTypeID, String periodID){
        List<Billing_Line_Item__c> billingLineItemList = new List<Billing_Line_Item__c>();
        Billing_Line_Item__c billingLineItem = new Billing_Line_Item__c();
        billingLineItem.RecordTypeId = recordTypeID;
        billingLineItem.Period__c = periodID;
        billingLineItem.Agreement_Type__c = Label.Bosch;
        billingLineItem.Company__c = Label.CompanyName;
        billingLineItem.Customer__c=   accountID;
        billingLineItem.Billed_Cost__c = 10.0;
        billingLineItem.Status__c = Label.newBusiness;
        billingLineItemList.add(billingLineItem);
        billingLineItem = new Billing_Line_Item__c();
        billingLineItem.RecordTypeId = recordTypeID;
        billingLineItem.Period__c = periodID;
        billingLineItem.Agreement_Type__c = Label.Bosch;
        billingLineItem.Company__c = Label.CompanyName;
        billingLineItem.Customer__c=   accountID;
        billingLineItem.Billed_Cost__c = 10.0;
        billingLineItem.Status__c = Label.newBusiness;
        billingLineItemList.add(billingLineItem);
        return billingLineItemList;
    }

    public static Group createGroup(String groupName) {
        return new Group(Name = groupName);
    }

    public static GroupMember createGroupMember(String groupId, String userId) {
        return new GroupMember( GroupId = groupId, UseroRGroupId = userId);
    }

    public static List<Cash_Entry_Summary__c> createCashEntrySummary(String customerID){
        List<Cash_Entry_Summary__c> cashEntrySummaryList = new List<Cash_Entry_Summary__c>();
        Cash_Entry_Summary__c cashEntrySummary = new Cash_Entry_Summary__c();
        cashEntrySummary.Customer__c = customerID;
        cashEntrySummary.Received_Date__c = System.today();
        cashEntrySummary.Received_Amount__c = 20;
        cashEntrySummary.Payment_Statement_Id__c = 'MAR000001';
        cashEntrySummaryList.add(cashEntrySummary);
        return cashEntrySummaryList;
    }

    public static List<Contract__c> createCancellableContracts(){
        List<Contract__c>  contractList = new List<Contract__c>();

        Agreement_Form_INT__c agreementForm = new Agreement_Form_INT__c(Name='Agreement001',Agreement_Form_ID__c='Agreement001',Cancel_Form_Number__c='Agreement002');
        insert agreementForm;

        Form_Master_Table__c formMaster = new Form_Master_Table__c(name='Agreement002',Cancelable_Flag__c='Y', 
            Form_Number__c= 'Test', Country_Code__c= 'GBR');
        insert formMaster;

        Cancel_Rule_Header__c cancelRuleheader = new Cancel_Rule_Header__c(Name='101',Start_Date__c=Date.today().addDays(-10),
            Stop_Date__c=Date.today().addDays(25),Date_Basis__c='Contract_Issue_Date_Days',Flat_Cancel_Days__c=90,
            Form_Number__c=formMaster.ID,Country__c='USA',Odometer_Basis__c='Addon', Expiration_Type__c='AOTCM');
        insert cancelRuleheader;

        Cancel_Rule_Detail__c cancelRuleDetail = new Cancel_Rule_Detail__c(Name='CancelRule1',Sequence_Number__c=cancelRuleheader.id,Period__c=100,Allow_Paid_Claim__c='Yes',Cancel_Basis__c='Prorata');
        insert cancelRuleDetail;


        Contract__c contract = createContractForCancellation(formMaster);
        contractList.add(contract);

        return contractList;
    }

    private static Contract__c createContractForCancellation(Form_Master_Table__c formMaster) {
        c2g__codaCompany__c fFcompany = BillingPaymentsTestFactory.createFfCompany('Test Company');
        insert fFcompany;

        Account a = CPM_util_TestUtils.createAccount_CPM();
        a.Release_2_Quoting_Pilot__c = true;
        a.BigMachines__Partner_Organization__c = 'dealers';
        a.ISFSW__c = true;
        a.FF_Company__c = fFcompany.Id;
        a.name = 'CPQ Test Account';
        a.accountNumber = 'CPQTEST';
        insert a;

        TWG_Product__c baseProd = CPM_util_TestUtils.createTWGProduct();
        Dealer_Product__c dp = CPM_util_TestUtils.createDealerProduct(a, baseProd);
        dp.ProductTypeDetailType_INT__c = 'WAD';

        String selectedRefundableBuckets = getSelectedRefundableAccountingBuckets(dp);
        dp.Flat_Refundable_Accounting_Buckets__c = selectedRefundableBuckets;
        dp.Pro_Rata_Refundable_Accounting_Buckets__c = selectedRefundableBuckets;
        update dp;

        Quote__c quote = CPM_util_TestUtils.createQuote(a);
        Quote_Dealer_Product__c qdp = CPM_util_TestUtils.createQuoteDealerProduct(dp, quote);

        Vehicle__c veh = CPM_util_TestUtils.createVehicle();
        insert veh;

        Contract__c c = getContract();
        c.Contract_Start_Date__c = Date.today().addDays(-70);
        c.Agmt_Form_Number_INT__c = formMaster.name;
        c.Vehicle__c = veh.Id;
        c.Quote_Dealer_Product__c = qdp.Id;
        c.Auto_Dealer_Product__c = dp.Id;
        c.Account_Name__c = a.Id;
        c.Expiration_Type__c = 'AOTCM';
        insert c;

        return c;
    }

    public static String getSelectedRefundableAccountingBuckets(Dealer_Product__c dealerProduct){
        Schema.DescribeFieldResult fieldResult = Dealer_Product__c.Flat_Refundable_Accounting_Buckets__c.getDescribe();
        List<Schema.PicklistEntry> pickListValues = fieldResult.getPicklistValues();
        List<String> bucketsToExclude = new List<String>{'CLF_CPQ', 'Misc_Fee_1', 'Misc_Fee_2', 'Misc_Fee_3', 'Total_Risk_Fee_2'};
        String selectedValues = '';
        for(Schema.PicklistEntry entry : pickListValues) {
            if((dealerProduct.Record_Type_Id__c != DealerProductConstants.DEALER_PRODUCT_MEXICO_RECORD_TYPE_ID 
                && entry.getValue() == DealerProductConstants.BROKER_FEE) 
                || bucketsToExclude.contains(entry.getValue())){
                continue;
            }
            selectedValues = selectedValues + entry.getValue() + ';';
        }
        return selectedValues;
    }

    public static Contract__c getContract() {
        RecordType rt = RecordTypeDAO.getRecordType(ContractConstants.MECHANICAL_RECORD_TYPE_NAME, 'Contract__c');
        Contract__c theContract = new Contract__c(Name = 'TEST0000', RecordTypeId = rt.Id, Contract_Start_Date__c = Date.today(),
            Contract_End_Date__c = Date.today().addYears(5), Cancel_Date_INT__c = Date.today(), Issue_Date_INT_WSDL__c = Date.today().addDays(-70),
            In_Service_Date_INT__c = Date.today().addDays(-200), Odometer_Mileage_at_Purchase__c = 350, Cancel_Odometer_INT__c = (350 + 200),
            Mileage_Expiration__c   = ( 350 + 200 + 100), Status__c = ContractConstants.ACTIVE_STATUS, Premium_Location_Code_INT__c = 'C',
            City_Lienholder__c = 'Chicago', State_Lienholder__c = 'IL', Zip_Lienholder__c = '60614', Country_Lienholder__c = 'USA',
            EFT_Annual_Prct_Rate_INT__c = '', FinanceAmount_INT_WSDL__c = 0, Terms__c = 0, EFT_GAP_Loan_Amt_INT__c = 0, Monthly_Payment__c = 0, Purchase_Price__c = 0,
            MSRP__c = 0, NADA_Value__c = 0, Money_Factor__c = 0, AgmDetailType__c = 'WAR', Deal_Number__c = 'TEST4321', Billing_State__c = 'IL',
            Year__c = '2016',Terms_Months_INT__c = 60, Terms_Miles_INT__c = 60000,Form_Deductible_Amt__c = 100, Disappearingdeduct_INT_WSDL__c = 'N', Total_Of_Payments__c = 0,
            Apr__c = 0, Customer_Cost__c = 317.0, Billing_Country__c ='USA',Total_Administrative_Fee__c = 200.00,Total_Agent_Fee__c = 10.00, Total_Billed_Cost__c =  235.00,
            Total_Client_Fee__c  = 235.00, Total_Corporate_Fee__c = 45.00, Total_Dealer_Commission__c = 34.00, Total_Dealer_Cost__c = 56.00, Total_F_I_Commission__c = 34.00,
            Total_Incentives__c = 45.00, Total_Insurance_Premium__c = 20.00, Total_Internal_Pack__c = 23.00, Total_Reserve__c = 12.00, Total_Marketing_Fee__c = 89.00,
            Total_Loss_Fund__c = 34.00, Total_Retail_cost__c = 45.00 , Total_Risk_Fee__c  = 45.00, Total_Tax_Allocation__c = 67.00, Total_Vendor_Fee__c = 128.00,
            Total_TWG_Fees__c = 28.00, Total_Escrow_Fee__c = 56.00,Reported_Customer_Cost_INT__c=317.0);

        return theContract;
    }

    public static Benefit_Threshold__c createBenifitThreshold(id productID, string areaOfService){
        Benefit_Threshold__c benifitThreshold = new Benefit_Threshold__c();
        benifitThreshold.Annual_Limit__c = 1500;
        benifitThreshold.Deductible__c = 50;
        benifitThreshold.Product__c = productID;
        benifitThreshold.Area_of_Service__c = areaOfService;
        return benifitThreshold ;
    }

    public static Credit_Card_Payment_Setting__c createUSBankSetting()
    {
        Credit_Card_Payment_Setting__c USBank = new Credit_Card_Payment_Setting__c();
        USBank.Name = 'USAuto';
        USBank.BankNumber__c = '3752';
        USBank.CompanyNumber__c = '62115';
        USBank.Endpoint__c = 'https://usbankdemoservices.encompass-suite.com/services/ApService.asmx';
        USBank.LoginId__c = 'TWG';
        USBank.Password__c = 'test1234';
        USBank.MerchantCode__c = '*';
        USBank.Username__c = 'webservices';
        return USBank;
    }

    public static Contract__c createFSWContract() {
        RecordType rt = RecordTypeDAO.getRecordType(ContractConstants.MECHANICAL_RECORD_TYPE_NAME, 'Contract__c');
        Contract__c theContract = new Contract__c(
            Name = 'TEST0000', RecordTypeId = rt.Id, Contract_Start_Date__c = Date.today(), Contract_End_Date__c = Date.today().addYears(5),
            Status__c = ContractConstants.ACTIVE_STATUS, Premium_Location_Code_INT__c = 'C', Spec_Coverage_Plan_Code__c = 'Premium',
            AgmtDTL_Type_INT__c = 'WAR', Holder_First_Name_INT__c = 'Joe',
            Holder_Last_Name_INT__c = 'Smith', Holder_Address_1_INT__c = '123 Main St', Holder_City_INT__c = 'Chicago',
            Holder_State_Province_INT__c = 'IL', Holder_Postal_Code_INT__c = '60614', Holder_Country_Code_INT__c = 'USA',
            Customer_Phone__c = '(312) 222-3333', AgmDetailType__c = 'WAR', Billing_State__c = 'IL',
            Year__c = '2016', In_Service_Date_INT__c = Date.today().addYears(-1), Odometer_Mileage_at_Purchase__c = 2000, Vehicle_Code__c = '23223',
            VIN__c = '19UDE2F82GA000762', Commercial_Usage__c = 'Y', Make__c = 'Acura', Model__c = 'ILX', CoveragePlanCode__c = 'PLT200',
            CoverageName_INT_WSDL__c = 'PLATINUM', Terms_Months_INT__c = 60, Terms_Miles_INT__c = 60000, Form_Deductible_Amt__c = 100,
            Disappearingdeduct_INT_WSDL__c = 'N', Agmt_Form_Number_INT__c = 'AWS281CT0505', Total_Of_Payments__c = 0, Apr__c = 0,
            EFT_Resid_Ballon_Amt_INT__c = '', LeaseCapAmount_INT_WSDL__c = 0, Total_Administrative_Fee__c = 71.0, Total_Agent_Fee__c = 0,
            Total_Billed_Cost__c = 317.0, Total_Client_Fee__c = 0, Total_Corporate_Fee__c = 0, Customer_Cost__c = 317.0, Total_Dealer_Commission__c = 0,
            Total_Dealer_Cost__c = 317.0, Total_F_I_Commission__c = 0, Total_Incentives__c = 0, Total_Insurance_Premium__c = 159.0, Total_Internal_Pack__c = 0,
            Total_Reserve__c = 159.0, Total_Marketing_Fee__c = 84.0, Total_Loss_Fund__c = 0, Total_Retail_cost__c = 317.0, Total_Risk_Fee__c = 0,
            Total_Tax_Allocation__c = 0, Total_Vendor_Fee__c = 3.0, Total_TWG_Fees__c = 158.0, Expiration_Type__c = 'AOTAOM'
        );
        return theContract;
    }

    public static Account createFSWAccount(){
        c2g__codaCompany__c fFcompany = BillingPaymentsTestFactory.createFfCompany('Test Company');
        insert fFcompany;

        Account fswAccount = new Account();
        fswAccount.Name = 'Account Name Unit Test XYZ';
        fswAccount.Phone = '3125554444';
        fswAccount.AccountNumber = 'RIL12345';
        fswAccount.Type = System.Label.In_Network;
        fswAccount.BillingCity = 'Chicago';
        fswAccount.BillingStreet = 'Unit Test Street 1';
        fswAccount.BillingCountry = 'USA';
        fswAccount.BillingPostalCode = '60606';
        fswAccount.BillingState = 'AL';
        fswAccount.State__c = 'ALABAMA';
        fswAccount.DRAD__c = '12345678';
        fswAccount.RecordTypeId =  RecordTypeDAO.getRecordType('Dealer','Account').Id;
        fswAccount.Release_2_Quoting_Pilot__c = true;
        fswAccount.BigMachines__Partner_Organization__c = 'dealers';
        fswAccount.ISFSW__c = true;
        fswAccount.FF_Company__c = fFcompany.Id;
        insert fswAccount;
        return fswAccount;
    }

    public static List<Contract__c> createFSWContracts(String status) {
        List<Contract__c> contracts = new List<Contract__c>();
        Account fswAccount = createFSWAccount();

        TWG_Product__c baseProd = CPM_util_TestUtils.createTWGProduct();
        Dealer_Product__c dp = CPM_util_TestUtils.createDealerProduct(fswAccount, baseProd);

        Quote__c quote = CPM_util_TestUtils.createQuote(fswAccount);
        Quote_Dealer_Product__c qdp = CPM_util_TestUtils.createQuoteDealerProduct(dp, quote);

        TWG_Product__c baseFEProd = CPM_util_TestUtils.createTWGProductFE();
        Dealer_Product__c dpAdminOnly = createDealerProductFEAdminOnly(fswAccount, baseFEProd);

        Quote_Dealer_Product__c qdpFEAdminOnly = CPM_util_TestUtils.createQuoteDealerProduct(dpAdminOnly, quote);

        Vehicle__c veh = CPM_util_TestUtils.createVehicle();
        insert veh;

        Contract__c fswAdminOnlyContract1 = createFSWContract();
        fswAdminOnlyContract1.Name = 'TESTFSWADMIN1';
        fswAdminOnlyContract1.Status__c = status;
        fswAdminOnlyContract1.Vehicle__c = veh.Id;
        fswAdminOnlyContract1.Quote_Dealer_Product__c = qdpFEAdminOnly.Id;
        fswAdminOnlyContract1.Account_Name__c = fswAccount.Id;
        fswAdminOnlyContract1.Auto_Dealer_Product__c = dpAdminOnly.id;
        contracts.add(fswAdminOnlyContract1);

        Contract__c fswContract1 = createFSWContract();
        fswContract1.Name = 'TESTFSW1';
        fswContract1.Status__c = status;
        fswContract1.Vehicle__c = veh.Id;
        fswContract1.Quote_Dealer_Product__c = qdp.Id;
        fswContract1.Account_Name__c = fswAccount.Id;
        fswContract1.Auto_Dealer_Product__c = dp.id;
        contracts.add(fswContract1);

        Contract__c fswContract2 = fswContract1.clone(false,false,false,false);
        fswContract2.Name = 'TESTFSW2';
        contracts.add(fswContract2);

        Contract__c fswContract3 = fswContract1.clone(false,false,false,false);
        fswContract3.Name = 'TESTFSW3';
        contracts.add(fswContract3);

        Contract__c fswContract4 = fswContract1.clone(false,false,false,false);
        fswContract4.Name = 'TESTFSW4';
        contracts.add(fswContract4);

        insert contracts;

        return contracts;
    }

    public static Case_Request__c createCaseRequestByCaseId(Id caseId)
    {
        Case_Request__c caseRequest = new Case_Request__c();
        caseRequest.Related_Case__c = caseId;
        caseRequest.Status__c = Label.Open;
        return caseRequest;
    }

    public static Revenue_Account_Distribution__c getRevenueAccountDistribution(Product2 product){
        Revenue_Account_Distribution__c revenueAccountDistribution = new Revenue_Account_Distribution__c();
        revenueAccountDistribution.Effective_Start_Date__c = system.today();
        revenueAccountDistribution.Expiration_Date__c = system.today();
        revenueAccountDistribution.Products__c = product.id;
        revenueAccountDistribution.Annual_Rates__c = 75;
        revenueAccountDistribution.Admin_Markup__c = 0.09;
        revenueAccountDistribution.TWG_Admin_Fee__c = 0.12;
        revenueAccountDistribution.Monthly_Rates__c = 30;
        revenueAccountDistribution.VSC_Ceding_Fee__c = 0.09;
        revenueAccountDistribution.Claim_Fees__c = 30;
        revenueAccountDistribution.Dealer_Cost__c = 4;
        return revenueAccountDistribution;
    }

    public static List<Specialty_Multi_Language_Transition__c> createSpecialtyMultiLanguageRecords() {
        List<Specialty_Multi_Language_Transition__c> testSpecialtyMultiLanguaeList = new List<Specialty_Multi_Language_Transition__c>();

        testSpecialtyMultiLanguaeList.add(new Specialty_Multi_Language_Transition__c(Name = 'Computer software is not covered',
            Picklist_Label__c = 'Computer software is not covered', English_Transition__c = 'Computer software is not covered',
            Spanish_Transition__c = 'Software de computadora no est cubierto'));
        testSpecialtyMultiLanguaeList.add(new Specialty_Multi_Language_Transition__c(Name = 'Consumables are not covered',
            Picklist_Label__c = 'Consumables are not covered', English_Transition__c = 'Consumables are not covered',
            Spanish_Transition__c = 'Consumibles no estn cubiertos'));
        testSpecialtyMultiLanguaeList.add(new Specialty_Multi_Language_Transition__c(Name = 'Copy of Damage Report',
            Picklist_Label__c = 'Copy of Damage Report', English_Transition__c = 'Copy of Damage Report',
            Spanish_Transition__c = 'Copia del reporte de daos'));
        testSpecialtyMultiLanguaeList.add(new Specialty_Multi_Language_Transition__c(Name = 'Copy of Extended Service Plan',
            Picklist_Label__c = 'Copy of Extended Service Plan', English_Transition__c = 'Copy of Extended Service Plan',
            Spanish_Transition__c = 'Copia del plan de servicio extendido'));
        testSpecialtyMultiLanguaeList.add(new Specialty_Multi_Language_Transition__c(Name = 'Copy of Rental Agreement',
            Picklist_Label__c = 'Copy of Rental Agreement', English_Transition__c = 'Copy of Rental Agreement',
            Spanish_Transition__c = 'Copia del contrato de alquiler'));
        return testSpecialtyMultiLanguaeList;
    }

    public static Billing_Line_Item__c createBillingLineItemsForBulkContract(Contract__c contractRecord,
                                                                             String companyId, String recordTypeId){
        Billing_Line_Item__c billingLineItem = new Billing_Line_Item__c();
        billingLineItem.Agmt_Number__c = contractRecord.Name;
        billingLineItem.Customer__c = contractRecord.Account_Name__c;
        billingLineItem.Effective_Start_Date__c = contractRecord.Contract_Start_Date__c;
        billingLineItem.Expiration_Date__c = contractRecord.Contract_End_Date__c;
        billingLineItem.Term__c = 1;
        if(contractRecord.Total_Dealer_Cost__c != null) {
            billingLineItem.Billed_Cost__c = contractRecord.Total_Dealer_Cost__c;
        }
        else{
            billingLineItem.Billed_Cost__c = 0.00;
        }
        billingLineItem.Status__c = Label.newBusiness;
        billingLineItem.Plan_Name__c = contractRecord.Contract_Type__c;
        billingLineItem.Customer_Count__c = contractRecord.Plan_count__c;
        billingLineItem.Period__c = String.valueOf(FFAPISetup.getPeriod(Date.today(),companyId));
        billingLineItem.Company__c = Label.CompanyName;
        billingLineItem.RecordTypeId = recordTypeId;
        return billingLineItem;
    }

    public static Case createATCase(String contractID){
        Contract__c contractCustomerDetail = ContractDAO.getCustomerDetails(contractID);
        Id caseRecordTypeID = RecordTypeDAO.getRecordType('AT_Claim', 'Case').Id;
        Case newCase = new Case(RecordTypeId = caseRecordTypeID);
        newCase.contract_new__c = contractID;
        newCase.Contract_Type_New__c = contractCustomerDetail.contract_Type__c;
        newCase.status = Label.Open;
        newCase.ProductId  = contractCustomerDetail.Bundle__c;
        newCase.AccountId = contractCustomerDetail.Buyer_Name__c;
        newCase.Address__c = contractCustomerDetail.Buyer_Name__r.PersonMailingStreet;
        newCase.State__c = contractCustomerDetail.Buyer_Name__r.PersonMailingState;
        newCase.Zip__c = contractCustomerDetail.Buyer_Name__r.PersonMailingPostalCode;
        newCase.City__c = contractCustomerDetail.Buyer_Name__r.PersonMailingCity;
        newCase.Mailing_Country__c = contractCustomerDetail.Buyer_Name__r.PersonMailingCountry;
        return newCase;
    }

    public static Account createATNonDealerAccount(){
        Id accountRecordTypeID = RecordTypeDAO.getRecordType('Non_Dealer', 'Account').Id;
        Account nonDealerAccount = new Account(Name = 'nonDealer', BillingCity = 'CA', BillingStreet = '175 west jackson', BillingState = 'IL', BillingPostalCode = '60606', BillingCountry = 'US', Billing_Type__c='Individual', RecordTypeId = accountRecordTypeID);
        return nonDealerAccount;
    }

    public static Case_Payee__c createATCasePayee(){
        Case_Payee__c casePayee = new Case_Payee__c();
        casePayee.FIN_Req_Total_Parts__c = 2;
        casePayee.FIN_Req_Total_Labor__c= 2;
        casePayee.Req_Total_Shipping_Amount__c= 2;
        casePayee.Req_Total_Service_Call_Amount__c= 2;
        casePayee.Req_Total_Customer_Loss_Amount__c= 2;
        casePayee.FIN_Req_Deductible__c= 2;
        
        casePayee.FIN_Auth_Total_Parts__c = 2;
        casePayee.FIN_Auth_Total_Labor__c= 2;
        casePayee.Auth_Total_Shipping_Amount__c= 2;
        casePayee.Auth_Total_Service_Call_Amount__c= 2;
        casePayee.Auth_Total_Customer_Loss_Amount__c= 2;
        casePayee.FIN_Auth_Deductible__c= 2;
        
        casePayee.FIN_Paid_Total_Parts__c = 2;
        casePayee.FIN_Paid_Total_Labor__c= 2;
        casePayee.Paid_Total_Shipping_Amount__c= 2;
        casePayee.Paid_Total_Service_Call_Amount__c= 2;
        casePayee.Paid_Total_Customer_Loss_Amount__c= 2;
        casePayee.FIN_Paid_Deductible__c= 2;
        casePayee.recordTypeId = RecordTypeDAO.getRecordTypeId('AT_Case_Payee','Case_Payee__c');
        return casePayee;
    }

    public static Payment_Order__c createATPayementOrder(){
        Payment_Order__c newPaymentOrder = new Payment_Order__c();
        newPaymentOrder.RecordTypeId = RecordTypeDAO.getRecordType('AT_Payment_Order', 'Payment_Order__c').Id;
        return newPaymentOrder;
    }

    public static Mulesoft_web_service_setting__c createMuleSoftSettings(){
        Mulesoft_web_service_setting__c muleSoftSetting =  new Mulesoft_web_service_setting__c();
        muleSoftSetting.name='Mulesoft';
        muleSoftSetting.Client_ID__c='clientID';
        muleSoftSetting.Client_Secret__c='ClientSecret';
        muleSoftSetting.URL__c = 'https://www.testconnection.thewg.com';
        muleSoftSetting.Time_Out__c = 10000;
        return muleSoftSetting;
    }

    public static Account createEUDealerAccount(String name) {
        Account testAccount = TWGTestFactory.createAccount();
        testAccount.BillingStreet = 'Test Circle';
        testAccount.BillingCity = 'Test City';
        testAccount.BillingState = 'IL';
        testAccount.Brand__c = 'RAC';
        testAccount.BillingPostalCode = '60563';
        testAccount.BillingCountry = 'GBR';
        testAccount.Name = name;
        testAccount.currencyISOCode ='GBP';
        testAccount.Contract_Seq_No__c = '123456';
        testAccount.Digit_Limit__c = '6';
        testAccount.VAT_number__c='123456789';
        testAccount.Due_Diligence__c = Label.Pass;
        testAccount.Default_Payment_Method__c = 'DDC';
        testAccount.Dealer_Qualifier__c = 'RAC Approved';
        testAccount.RecordTypeID =  RecordTypeDAO.getRecordTypeId(AccountConstants.RECORD_TYPE_EU_DEALER , 'Account');
        return testAccount;
    }

    public static Account createEUDealerGroupAccount(String name) {
        Account testAccount = TWGTestFactory.createAccount();
        testAccount.BillingStreet = 'Test Circle';
        testAccount.BillingCity = 'Test City';
        testAccount.BillingState = 'IL';
        testAccount.BillingPostalCode = '60563';
        testAccount.BillingCountry = 'GBR';
        testAccount.Name = name;
        testAccount.Brand__c = 'RAC';
        testAccount.Dealer_Qualifier__c = 'RAC Approved';
        testAccount.Default_Payment_Method__c = 'CCD';
        testAccount.currencyISOCode ='GBP';
        testAccount.Contract_Seq_No__c = '123456';
        testAccount.Digit_Limit__c = '6';
        testAccount.VAT_number__c='123456789';
        testAccount.Due_Diligence__c = Label.Pass;
        testAccount.RecordTypeID =  RecordTypeDAO.getRecordTypeId(AccountConstants.RECORD_TYPE_EU_DEALER_GROUP , 'Account');
        return testAccount;
    }

    public static TWG_Fee__c createTWGFee(){
        TWG_Fee__c twgFee = new TWG_Fee__c();
        twgFee.Start_Date__c = Date.today();
        twgFee.Agent_Percent__c = null;
        twgFee.Master_Agent_Percent__c = null;
        twgFee.Super_Agent_Percent__c = null;
        return twgFee;
    }

    public static Account createAtConsumerAccount(){
        Account a = new Account();
        a.RecordTypeId = RecordTypeDAO.getRecordTypeId(AccountConstants.AT_CONSUMER_ACCOUNT_RT_API_NAME,
            AccountConstants.ACCOUNT_SOBJECT_API_NAME);
        a.FirstName = 'Test';
        a.LastName = 'Tester';
        a.personEmail = 'test@sfdctest.com';
        a.Phone = '555-555-5555';
        a.Account_Affinity_Id__pc = null;
        return a;
    }

    public static Contract__c createAtContract(Account c){
        Account account = createAtAffinityPartner();
        if(account.id == null)
            insert account;
        Contract__c ctr = new Contract__c();
        ctr.RecordTypeId = RecordTypeDAO.getRecordTypeId(ContractConstants.AT_CONTRACT_RT_API_NAME,
            ContractConstants.CONTRACT_SOBJECT_API_NAME);
        ctr.Status__c = ContractConstants.ACTIVE_STATUS;
        ctr.Payment_Type__c = ProductConstants.PAYMENT_TYPE_SINGLE;
        ctr.Serial__c = 'XXXXXXXXXX';
        ctr.Contract_Purchase_Date__c = Date.Today();
        ctr.Product_Purchase_Date__c  = Date.Today();
        ctr.Manufacturer_s_Warranty_Period__c = 365;
        ctr.Lead_source__c = account.id;
        ctr.Premium_Location_Code_INT__c = '2';
        ctr.Subtotal__c = 22;
        ctr.Tax__c = 1;
        ctr.Customer_Email__c = 'test@mail.com';
        ctr.Threshold__c = 200;
        ctr.Contract_Start_Date__c = Date.Today();
        ctr.Buyer_Name__c = c.Id;
        return ctr;
    }

    public static Product2 createAtProductCategory() {
        Product2 p = new Product2();
        P.RecordTypeId = RecordTypeDAO.getRecordTypeId(ProductConstants.AT_PRODUCT_CATEGORY_RT_API_NAME,
            ProductConstants.PRODUCT2_SOBJECT_API_NAME);
        p.Name = 'Laptop';
        p.Manufacturer_s_Warranty_Period__c = 365;
        p.Threshold__c = 300;
        p.Chargify_Component_Id__c = 'product_component_id';
        return p;
    }

    public static Product2 createAtProductRate(String productName) {
        Product2 p = new Product2();
        P.RecordTypeId = RecordTypeDAO.getRecordTypeId(ProductConstants.AT_RATE_ATTRIBUTES_PRODUCT_RT_API_NAME,
            ProductConstants.PRODUCT2_SOBJECT_API_NAME);
        p.Name = productName;
        p.Chargify_Monthly_Product_Handle__c = productName+'_two_years';
        p.Chargify_Single_Product_Handle__c = productName+'_one_time';
        p.Term_Length__c = 2;
        p.Purchase_Receipt_Required__c = true;
        p.Retail_Price_From__c =0.0;
        p.Retail_Price_To__c = 200;
        return p;
    }

    public static Product2 createAtProductCoverage(String productName, String productCode) {
        Product2 p = new Product2();
        P.RecordTypeId = RecordTypeDAO.getRecordTypeId(ProductConstants.AT_COVERAGE_PRODUCT_RT_API_NAME,
            ProductConstants.PRODUCT2_SOBJECT_API_NAME);
        p.Name = productName;
        p.ProductCode = productCode;
        p.Expiration_Type__c = 'Date of Purchase (DOP)';
        return p;
    }

    public static SBQQ__ProductOption__c createAtSBQQProductOption(Id productId1, Id productId2){
        SBQQ__ProductOption__c productOption = new SBQQ__ProductOption__c();
        productOption.RecordTypeId  = Schema.SObjectType.SBQQ__ProductOption__c.getRecordTypeInfosByName().get(
            ProductConstants.AT_PRODUCT_OPTION_RECORD_TYPE).getRecordTypeId();
        productOption.SBQQ__ConfiguredSKU__c = productId1;
        productOption.Coverage_Start_Offset__c = 1;
        productOption.SBQQ__Number__c = 2000;
        productOption.SBQQ__OptionalSKU__c = productId2;
        return productOption;
    }

    public static SBQQ__ProductOption__c createAtCoverageSBQQProductOption(Id productId1, Id productId2){
        SBQQ__ProductOption__c productOption = new SBQQ__ProductOption__c();
        productOption.RecordTypeId  = Schema.SObjectType.SBQQ__ProductOption__c.getRecordTypeInfosByName().get(
            ProductConstants.AT_COVERAGE_PRODUCT_OPTION_RECORD_TYPE).getRecordTypeId();
        productOption.SBQQ__ConfiguredSKU__c = productId1;
        productOption.Coverage_Start_Offset__c = 1;
        productOption.SBQQ__Number__c = 2000;
        productOption.SBQQ__OptionalSKU__c = productId2;
        return productOption;
    }

    public static Affinity_Partner_Product__c createAffinityPartnerProduct(Id affinityAccountId, id categoryId){
        Affinity_Partner_Product__c partnerProduct = new Affinity_Partner_Product__c();
        partnerProduct.Product__c = categoryId;
        partnerProduct.Affinity_Partner__c = affinityAccountId;
        return partnerProduct;
    }

    public static Account createAtAffinityPartner() {
        Account a = null;
        List<Account> accountList = new List<Account>();
        String recordTypeID = RecordTypeDAO.getRecordTypeId(AccountConstants.AT_AFFINITY_PARTNER_ACCOUNT_RT_API_NAME,
            AccountConstants.ACCOUNT_SOBJECT_API_NAME);
        accountList = [SELECT id, name, RecordTypeId, Affinity_Id__c, Affinity_Type__c
                       FROM account
                       WHERE RecordTypeId = :recordTypeID];

        if (accountList != null && accountList.size() > 0) {
            a = accountList.get(0);
            a.RecordTypeId = recordTypeID;
            a.Affinity_Id__c = AccountConstants.AFFINITY_ID_TWG;
            a.Affinity_Type__c = AccountConstants.WEB_ENABLED;
        }
        else {
            a = new Account();
            a.RecordTypeId = recordTypeID;
            a.Name = 'Test Tester';
            a.Affinity_Id__c = AccountConstants.AFFINITY_ID_TWG;
            a.Affinity_Type__c = AccountConstants.WEB_ENABLED;
        }
        return a;
    }

    public static Account createObligorAccount(){
        Account a = new Account();
        a.RecordTypeId = RecordTypeDAO.getRecordTypeId(AccountConstants.OBLIGOR_ACCOUNT_RT_API_NAME,
            AccountConstants.ACCOUNT_SOBJECT_API_NAME);
        a.Name = 'Test';
        a.Phone = '555-555-5555';
        a.Obligor_Client_Code__c = '111';
        a.Obligor_Client_Name__c = 'test';
        a.Billing_State__c = 'IL';
        return a;
    }

    public static Case createAtClaim(Account account, Contract__c ctr) {
        Case claim = new Case();
        claim.RecordTypeId = RecordTypeDAO.getRecordTypeId(CaseConstants.AT_CASE_RT_API_NAME,
            CaseConstants.CASE_SOBJECT_API_NAME);
        claim.Contact__c = account.id;
        claim.Contract_New__c = ctr.id;
        claim.Status = 'Open';
        claim.Customer_First_Name__c = 'test';
        claim.Phone__c = '123456789';
        claim.Email_Address__c = 'test@mail.com';
        claim.Customer_Complaint__c = 'ACCESSORIES';
        Contract_Coverage__c cc = ContractCoverageDAO.getContractCoverageByPlanIdCoverage(ctr.id, claim.Customer_Complaint__c);
        claim.Contract_Coverage__c = cc.id;
        return claim;
    }

    public static Contract_Coverage__c createAtContractCoverage(Contract__c ctr, Product2 p){
        Contract_Coverage__c cc = new Contract_Coverage__c();
        cc.RecordTypeId = RecordTypeDAO.getRecordTypeId(ContractConstants.AT_CONTRACT_COVERAGE_RT_API_NAME,
            ContractConstants.CONTRACT_COVERAGE_SOBJECT_API_NAME);
        cc.Contract__c = ctr.Id;
        cc.Coverage_Start_Offset__c = 1;
        cc.Coverage_Key__c = p.ProductCode;
        cc.Coverage_Type__c = p.Name;
        cc.Expiration_Type__c = p.Expiration_Type__c;
        return cc;
    }

    public static Document__c createAtDocument(Contract__c ctr){
        Document__c d = new Document__c();
        d.RecordTypeId = RecordTypeDAO.getRecordTypeId(ContractConstants.AT_DOCUMENT_RT_API_NAME,
            ContractConstants.DOCUMENT_SOBJECT_API_NAME);
        d.Contract__c = ctr.Id;
        d.Document_Type__c = 'Receipt';
        d.Active__c = true;
        return d;
    }

    public static Obligor_Product__c createObligorProduct(Id productCatId, Id accountId){
        Obligor_Product__c obligorProduct = new Obligor_Product__c();
        obligorProduct.Obligor__c = accountId;
        obligorProduct.Product__c = productCatId;
        obligorProduct.Country__c = 'USA';
        obligorProduct.State__c = 'IL';
        return obligorProduct;
    }

    public static SBQQ__QuoteLine__c createAtQuoteLine(Id id){
        SBQQ__QuoteLine__c quoteLine = new SBQQ__QuoteLine__c();
        SBQQ__Quote__c sbqqQuote = createAtQuote();
        insert sbqqQuote;
        quoteLine.RecordTypeId = Schema.SObjectType.SBQQ__QuoteLine__c.getRecordTypeInfosByName().get(
            ProductConstants.AT_QUOTELINE_RECORD_TYPE).getRecordTypeId();
        quoteLine.SBQQ__Product__c = id;
        quoteLine.SBQQ__Quote__c = sbqqQuote.id;
        quoteLine.SBQQ__Quantity__c = 1;
        quoteLine.SBQQ__NetPrice__c = 20;
        return quoteLine;
    }

    public static SBQQ__Quote__c createAtQuote(){
        Account account = createAtAffinityPartner();
        if(account.id == null)
            insert account;
        Pricebook2 book  = new Pricebook2();
        book.Name = 'Single Rate - TWG';
        book.Affinity_Partner__c = account.id;
        book.Rate_Type__c = ProductConstants.SINGLE_RATE_TYPE;
        book.RecordTypeId = Schema.SObjectType.Pricebook2.getRecordTypeInfosByName().get(
            ProductConstants.AT_PRICEBOOK_RECORD_TYPE).getRecordTypeId();
        book.IsActive = true;
        insert book;

        SBQQ__Quote__c quote = new SBQQ__Quote__c();
        quote.RecordTypeId = Schema.SObjectType.SBQQ__Quote__c.getRecordTypeInfosByName().get(
            ProductConstants.AT_QUOTE_RECORD_TYPE).getRecordTypeId();
        quote.Affinity_Partner__c = account.id;
        quote.SBQQ__PriceBook__c = book.id;
        quote.Payment_Type__c = ProductConstants.PAYMENT_TYPE_SINGLE;
        quote.Is_Temporary__c = true;
        return quote;
    }

    public static Territory_Product__c createTerritoryProduct(Id productId){
        Territory_Product__c territoryProduct = new Territory_Product__c();
        territoryProduct.Territory__c = 'T1';
        territoryProduct.Product__c = productId;
        territoryProduct.Country__c = 'USA';
        territoryProduct.Jurisdiction__c = 'FL';
        territoryProduct.Zip_Code__c = '60611';
        territoryProduct.Start_Date__c = Date.TODAY();
        territoryProduct.End_Date__c = Date.TODAY();
        return territoryProduct;
    }

    public static Dealer_Product_Financier__c createDealerPorductFinancier(Id accountId, Id dealerProductId){
        Dealer_Product_Financier__c dealerProductFinancier = new Dealer_Product_Financier__c();
        dealerProductFinancier.Account__c = accountId;
        dealerProductFinancier.Dealer_Product__c = dealerProductId;
        dealerProductFinancier.Name = 'Toyota Finance Service';
        dealerProductFinancier.FinanceDescription_INT__c = 'Toyota Finance Service';
        dealerProductFinancier.FinancerCode_INT__c = 'TFS';
        dealerProductFinancier.Start_Date__c = Date.today();
        return dealerProductFinancier;
    }

    public static Glass_Component_Group__c createGlassComponentGroup(){
        Glass_Component_Group__c glassComponentGroupRec = new Glass_Component_Group__c();
        glassComponentGroupRec.Component_Group_Description__c = 'Test Group 1';
        return glassComponentGroupRec;
    }

    public static Glass_Component_SubGroup__c createGlassComponentSubGroup(Glass_Component_Group__c glassComponentGroupRec){
        Glass_Component_SubGroup__c glassComponentSubGroupRec = new Glass_Component_SubGroup__c();
        glassComponentSubGroupRec.Glass_Component_Group__c = glassComponentGroupRec.Id;
        glassComponentSubGroupRec.Component_SubGroup_Description__c = 'Test Sub Group 2';
        return glassComponentSubGroupRec;
    }

    public static Glass_Component_Item__c createGlassComponentItem(Glass_Component_SubGroup__c glassComponentSubGroupRec){
        Glass_Component_Item__c  glassComponentItemRec = new Glass_Component_Item__c();
        glassComponentItemRec.Component_Action__c = 'Act1';
        glassComponentItemRec.Glass_Component_SubGroup__c = glassComponentSubGroupRec.Id;
        glassComponentItemRec.Component_Item_Description__c = 'Test Description';
        return  glassComponentItemRec;
    }

    public static Branding__c createBrandingObject() {
        Branding__c brand = new Branding__c();
        brand.Name = BrandingConstants.BRANDING_RAC;
        brand.Component_2__c = 'Quote';
        brand.Component_3__c = 'Customer';
        return brand;
    }
    
    public static Branding__c createBrandingObjectForHondaCars() {
        Branding__c brand = new Branding__c();
        brand.Name = BrandingConstants.EU_HONDA_CARS;
        brand.Manufacturer__c = BrandingConstants.BRANDING_HONDA;
        brand.Component_2__c = 'Quote';
        brand.Component_3__c = 'Customer';
        return brand;
    }

    public static void populateContractAccountingBuckets(Contract__c contract){
        contract.Total_Administrative_Fee__c = 90.0;
        contract.Total_Agent_Fee__c = 80;
        contract.Total_Billed_Cost__c = 317.0;
        contract.Total_Client_Fee__c = 70;
        contract.Total_Corporate_Fee__c = 47;
        contract.Customer_Cost__c = 317.0;
        contract.Total_Dealer_Commission__c = 98;
        contract.Total_Dealer_Cost__c = 317.0;
        contract.Total_F_I_Commission__c = 68;
        contract.Total_Incentives__c = 78;
        contract.Total_Insurance_Premium__c = 159.0;
        contract.Total_Internal_Pack__c = 32;
        contract.Total_Reserve__c = 159.0;
        contract.Total_Marketing_Fee__c = 84.0;
        contract.Total_Loss_Fund__c = 22;
        contract.Total_Retail_cost__c = 317.0;
        contract.Total_Risk_Fee__c = 0;
        contract.Total_Tax_Allocation__c = 0;
        contract.Total_Vendor_Fee__c = 3.0;
        contract.Total_TWG_Fees__c = 158.0;
    }

    public static Product_Channel__c createProductChannel() {
        Product_Channel__c channel = new Product_Channel__c();
        channel.Channel_Name__c = 'First Extended';
        List<String> flatAccountingBuckets = new List<String> {'Total_Administrative_Fee', 'Total_Incentives'};
        List<String> proRataAccountingBuckets = new List<String> {'Total_Escrow_Fee', 'Total_Reserve'};
        channel.Flat_Refundable_Accounting_Buckets__c = String.join(flatAccountingBuckets, ';');
        channel.Pro_Rata_Refundable_Accounting_Buckets__c = String.join(proRataAccountingBuckets, ';');

        return  channel;
    }

    public static Dealer_Product__c createEUDealerProduct(Account account, TWG_Product__c product) {
        Dealer_Product__c dealerProduct = createDealerProduct();
        dealerProduct.Account__c = (account != null) ? account.Id : null;
        dealerProduct.TWG_Product__c = (product != null) ? product.Id : null;
        dealerProduct.Product_Class__c='07';
        dealerProduct.ProductClassDesc_INT__c = 'Standard';
        dealerProduct.ProductTypeDetailType_INT__c='LW';
        dealerProduct.Contract_Number_Prefix__c = 'DP' + String.valueOf(index);
        dealerProduct.Vehicle_Type__c = DealerProductConstants.VEHICLE_TYPE_NEW_ONLY;
        dealerProduct.RecordTypeId = RecordTypeDAO.getRecordTypeId('EU_Dealer_Product' , 'Dealer_Product__c');
        index++;
        return dealerProduct;
    }

    public static TWG_Product__c createEUTWGProduct(String prefix) {
        TWG_Product__c twgp = new TWG_product__c();
        twgp.Product_Description__c ='Warranty';
        twgp.Product_Type__c='07';
        twgp.Contract_Number_Prefix__c = prefix;
        return twgp;
    }

    public static Drawloop_DDP_Settings_for_Apex__c  createDrawloopDDPSettings(){
        Loop__DDP__c ddp = BillingPaymentsTestFactory.createDdp();
        ddp.name = DdpConstants.DDP_NAME;
        insert ddp;
        Loop__DDP_Integration_Option__c ddpOption = BillingPaymentsTestFactory.createDdpDeliveryOption(ddp.id);
        ddpOption.name = DdpConstants.DDP_ATTACH_EXCEL_TO_ACCOUNT;
        insert ddpOption;
        Drawloop_DDP_Settings_for_Apex__c createDDPCustomSetting = new Drawloop_DDP_Settings_for_Apex__c();
        createDDPCustomSetting.Name = 'Contract';
        createDDPCustomSetting.DDP_Delivery_ID__c = ddpOption.Id;
        createDDPCustomSetting.DDP_ID__c = ddp.Id;
        createDDPCustomSetting.sObject__c = 'Contract__c';
        return createDDPCustomSetting;
    }

    public static void createDealerVehicleAndModel(){
        DealerVehicleMakeModel__c model = new DealerVehicleMakeModel__c();
        model.Vehicle_Model_Year__c = 1990;
        insert model;
        Make_INT__c makeCode = new Make_INT__c();
        makeCode.Name__c = 'Test';
        makeCode.Make_Name_Alias__c = 'Test';
        makeCode.Special_ID__c = 'Test';
        insert makeCode;
        model.Make_Code_INT__c = makeCode.Id;
        update model;
    }

    public static Quote__c createEUQuote(String vin, Account account) {
        Quote__c euQuote = TWGTestFactory.createQuote();
        euQuote.Account__c = (account != null) ? account.Id : null;
        euQuote.VIN__c = (vin != null) ? vin : null;
        euQuote.Policy_Sold_Date__c = date.Today();
        euQuote.RecordTypeId = RecordTypeDAO.getRecordTypeId('CPQ_Quote_EU' , 'Quote__c');
        return euQuote;
    }

    public static Quote_Dealer_Product__c createEUQuoteDealerProduct(Dealer_Product__c dealerProduct, Quote__c quote) {
        Quote_Dealer_Product__c qdpEU = TWGTestFactory.createQuoteDealerProduct();
        qdpEU.Dealer_Product__c = (dealerProduct != null) ? dealerProduct.Id : null;
        qdpEU.Quote__c = (quote != null) ? quote.Id : null;
        qdpEU.Customer_Cost__c = 100;
        qdpEU.Dealer_Cost__c = 100;
        qdpEU.Miles__c = '1000';
        qdpEU.Months__c = '12';
        qdpEU.Total_Administrative_Fee__c = 0;
        qdpEU.Total_Marketing_Fee__c = 0;
        qdpEU.Total_Vendor_Fee__c = 0;
        qdpEU.Total_Risk_Fee__c = 0;
        qdpEU.Total_Corporate_Fee__c = 0;
        qdpEU.Total_Reserve__c = 0;
        qdpEU.Total_Agent_Fee__c = 0;
        qdpEU.RecordTypeId = RecordTypeDAO.getRecordTypeId('CPQ_Quote_Dealer_Product' , 'Quote_Dealer_Product__c');
        return qdpEU;
    }

    public static Contract__c createEUContract(Account dealer, Dealer_Product__c dp, Quote_Dealer_Product__c qdp) {
        RecordType recordType = RecordTypeDAO.getRecordType(ContractConstants.MECHANICAL_EU_RECORD_TYPE_NAME, 'Contract__c');
        Contract__c testContract = TWGTestFactory.createContract();
        testContract.EFT_Dealer_Product__c = (dp != null) ? dp.Id : null;
        testContract.Premium_Location_Code_INT__c = '1';
        testContract.RecordTypeId = recordType.Id;
        testContract.Account_Name__c = (dealer != null) ? dealer.id : null;
        testContract.Quote_Dealer_Product__c = (qdp != null) ? qdp.id : null;
        testContract.Customer_Contract_Number__c = 'tes123456';
        return testContract;
    }

    public static Account createWritingCompanyAccount() {
        Id accountRecordType  = Schema.SObjectType.Account.getRecordTypeInfosByName().get('Non-Dealer').getRecordTypeId();
        Account writingCompanyAccount = new Account(RecordTypeId=accountRecordType, Writing_Company_Code__c = 'C5',
            Name='C5 Writing Company', Type = 'Writing Company');
        return writingCompanyAccount;
    }

    public static Account createWritingCompanyAccount(String writingCompanyCode, String writingCompanyName) {
        Id accountRecordType = Schema.SObjectType.Account.getRecordTypeInfosByName().get('Non-Dealer').getRecordTypeId();
        Account writingCompanyAccount = new Account(RecordTypeId=accountRecordType, Writing_Company_Code__c = writingCompanyCode,
            Name = writingCompanyName, Type = 'Writing Company');
        return writingCompanyAccount;
    }

    public static User createATPortalUser(Id inputProfileId){
        Account acc = createATAccount();
        insert acc;

        Contact con = createATContact();
        con.AccountId = acc.Id;
        insert con;
        User pu = new User(profileId = inputProfileId, username = 'test@dominon.com.dom',
                email = 'unitterrxtx@thewarrantygroup.com',emailencodingkey = 'UTF-8',
                localesidkey = 'en_US',languagelocalekey = 'en_US',
                timezonesidkey = 'America/Chicago',alias='csputxz',
                lastname='UnitTestLName',
                contactId = con.Id);
        return pu;
    }

    public static User createEUCommunityUser(Contact contact) {
        Profile profiles = [SELECT Id FROM Profile WHERE Name = 'EU Dealer Super User'];
        User communityUser = new User(Alias = 'standt', Email='standarduser@twg.com',
            EmailEncodingKey='UTF-8', FirstName = 'Test',LastName='User', LanguageLocaleKey='en_US',
            LocaleSidKey='en_US', ProfileId = profiles.Id,
            TimeZoneSidKey='America/Los_Angeles', UserName='standarduser@twg.com', DRAD_ID_INT__C = '12345678',
            ContactId = contact.Id);
        communityUser.Contact = contact;

        return communityUser;
    }

    public static Business_Sharing_Rule__c createBusinessSharingRuleObject(String objectAPIName){
        Business_Sharing_Rule__c testBusinessSharingRuleObject = new Business_Sharing_Rule__c();
        testBusinessSharingRuleObject.Shared_Object__c = objectAPIName;
        testBusinessSharingRuleObject.Shared_With_Roles__c = BusinessSharingRuleConstants.SHARED_ROLES;
        return testBusinessSharingRuleObject;
    }

    public static Account_Payment__c createAccountPayment(){
        Account_Payment__c testAccountPayment = new Account_Payment__c();
        return testAccountPayment;
    }

    public static Account_Update_Request__c createAccountUpdateRequest(){
        Account_Update_Request__c aur = new Account_Update_Request__c();
        aur.Account_Name__c = 'TestAccount';
        aur.Contract_Number__c = 'TestContractNumber';
        aur.Marketing_Operation_Team_Email__c =  'test@test.com';
        aur.Current_Street__c = '55 W Dempster st';
        aur.Current_City__c = 'Chicago';
        aur.Current_State__c = 'IL';
        aur.Current_ZipCode__c = '66004';
        aur.Current_Phone__c = '99000012345';
        aur.New_Street__c = '44 N Westernal Ave';
        aur.New_City__c = 'New York';
        aur.New_State__c = 'NY';
        aur.New_Zipcode__c = '77709';
        aur.New_Phone__c = '44000012345';
        return aur;
    }

    public static Account createDealerAccount(Id dealerRT){
        Account dealerAccount = new Account();
        dealerAccount.RecordTypeId = dealerRT;
        dealerAccount.Name = 'TestDealerAccount';
        dealerAccount.AccountNumber = '000CO005';
        dealerAccount.BillingStreet = '99 N Capitol Dr';
        dealerAccount.BillingCity = 'New York';
        dealerAccount.BillingState = 'NY';
        dealerAccount.BillingPostalCode = '33495';
        dealerAccount.Phone = '9900112233';
        return dealerAccount;
    }

    public static Dealer_Product__c createAndReturnDealerProduct(Account a, TWG_Product__c prod, RecordType rt)
    {
        Dealer_Product__c dp = new Dealer_Product__c(RecordType = rt, Account__c = a.Id, ProductTypeName_INT__c = 'Test Dealer Product', TWG_Product__c = prod.Id,
                                                     Product_Class__c = '06 New Only',Requested_Start_Date__c = System.today(),Start_Date__c = System.today());
        return dp;
    }

    public static TWG_Product__c createAndReturnTWGProduct()
    {
        TWG_Product__c prod = new TWG_Product__c(Name = 'Test Base Product',
            Product_Code__c = 'PCODE'+getRandomString(),Product_Type__c = 'W - Service Contract',
            Product_Start_Date__c = System.now(), Channel__c = 'Resource',Country_Code__c = 'US / USA',
            Client_Type_Distribution_Channel__c = 'Dealer',Product_Description__c = 'For testing', 
            Vehicle_Group_ID__c = 'VGI0001',UW_Insurance_Rate_Code__c = 'TESTING1234', 
            UW_TWG_Fees_Rate_Code__c = 'TESTING1234');
            
        return prod;
    }

    public static Account getAccountByAffinityIdAndRecordType(String affinityId, String recordTypeName){
        return [SELECT Id, Name, Contract_Type__c, BillingStreet, BillingCity, BillingState, BillingPostalCode,
                    Billing_Street_2__c, RDG_Nbr__c,AccountNumber,Invoice_Due_Days__c, Statement_Id_Prefix__c, Affinity_Id__c
                FROM Account
                WHERE Affinity_Id__c =:affinityId
                AND RecordType.DeveloperName =:recordTypeName];
    }

    public static Store_Ip__c createStoreIp(Id recordTypeId, String name, String ipAddress) {
        Store_Ip__c newStoreIp = new Store_Ip__c();
        newStoreIp.Name = name;
        newStoreIp.RecordTypeId = recordTypeId;
        newStoreIp.Static_IP_Address__c = ipAddress;
        return newStoreIp;
    }

    public static Maintanence_Reimbursement__c createMaintenanceReimbursement(Id contractId)
    {
        Maintanence_Reimbursement__c testMaintanenceReimbursement = new Maintanence_Reimbursement__c();
        testMaintanenceReimbursement.ContractLookup__c = contractId;
        testMaintanenceReimbursement.Status__c = System.Label.Available;
        testMaintanenceReimbursement.Name = 'test';
        testMaintanenceReimbursement.Amount__c = 100;
        return testMaintanenceReimbursement;
    }

    public static Manufacturer_Cover__c createManufacturerCover(String name, String countryCode, string manufacturerName, String manufacturerCode, Date startDate, Date endDate) {
        return new Manufacturer_Cover__c(
            Name = name,
            Country__c = countryCode,
            Manufacturer_Name__c = manufacturerName,
            Manufacturer_Code__c = manufacturerCode,
            Coverage_Mileage__c = 120000, Coverage_Months__c = 12,
            Cover_End_Date__c = endDate,
            Cover_Start_Date__c = startDate
        );
    }

    public static List<Manufacturer_Cover__c> createTestManufacturerCovers() {
        List<Manufacturer_Cover__c> manCovers = new List<Manufacturer_Cover__c>();
        manCovers.add(createManufacturerCover('TestCover1', 'GBR', 'Porsche', 'RZ', Date.newInstance(2017,1,1), Date.newInstance(2017,12,31)));
        manCovers.add(createManufacturerCover('TestCover2', 'FRA', 'Renault', 'TT', Date.newInstance(2017,1,1), Date.newInstance(2017,12,31)));
        manCovers.add(createManufacturerCover('TestCover3', 'ROU', 'Mercedes-Benz', 'TZ', Date.newInstance(2016,1,1), Date.newInstance(2016,12,31)));
        return manCovers;
    }

    public static Tax__c createTax(String name, String country,String jurisdiction ,String taxType) {

        Tax__c newTax = new Tax__c(Name = name, Country__c = country, Jurisdiction__c = jurisdiction, Tax_Type_code__c = taxType,
                                    Tax_Effective_Date__c = Date.today(), Tax_Rate_Percent__c = 0, Tax_Rate_Flat__c = 1);

        return newTax;
    }

    public static MulesoftRatesWebService.Rates createMulesoftRate(){
        MulesoftRatesWebService.Rates rate = new MulesoftRatesWebService.Rates();
        rate.termMonths = '1000';
        rate.termDistance = '1000';
        rate.clientCost = '0';
        rate.serviceInterval = '';
        rate.oilType = '';
        rate.claimsLimit = '0';
        rate.coverage_array = '';
        rate.vehicleFactoryWarrantyMonths = 0;
        rate.vehicleFactoryWarrantyDistance = 0;
        rate.deductibleBase = '0';
        rate.deductibleReduced = '0';
        rate.retailCost = '0';
        rate.coverage = 'TEST';
        return rate;
    }

    public static Map<String,webserviceEligibilityAwgAonCom_2.Coverage> createCoverageMap(){
        Map<String,webserviceEligibilityAwgAonCom_2.Coverage> coverageMap = new Map<String,webserviceEligibilityAwgAonCom_2.Coverage>();
        webserviceEligibilityAwgAonCom_2.Coverage coverage = new webserviceEligibilityAwgAonCom_2.Coverage();
        coverage.name = 'PlatinumNameTest';
        coverage.code = 'PlatinumCodeTest';
        coverageMap.put('Plat',coverage);
        return coverageMap;
    }

    public static Contract_Event__c createAndPopulateContractEvent(Id contractID, Integer amount, String developerName) {
        Id getRecordTypeID = RecordTypeDAO.getRecordTypeId(developerName,'Contract_Event__c');
        Contract_Event__c newContractEvent = new Contract_Event__c();
        newContractEvent.Contract__c = contractID;
        newContractEvent.Amount__c = amount;
        newContractEvent.RecordTypeId = getRecordTypeId;
        newContractEvent.Status__c = 'SUCCESS';
        newContractEvent.Occurrence__c = System.today();
        newContractEvent.Total_Administrative_Fee__c = 50;
        newContractEvent.Total_Client_Fee__c = 50;
        newContractEvent.Total_Corporate_Fee__c = 50;
        newContractEvent.Total_Dealer_Commission__c = 50;
        newContractEvent.Total_F_I_Commission__c = 50;
        newContractEvent.Total_Incentives__c = 50;
        newContractEvent.Total_Insurance_Premium__c = 50;
        newContractEvent.Total_Internal_Pack__c = 50;
        newContractEvent.Total_Loss_Fund__c = 50;
        newContractEvent.Total_Marketing_Fee__c = 50;
        newContractEvent.Total_Risk_Fee__c = 50;
        newContractEvent.Total_Tax_Allocation__c = 50;
        newContractEvent.Total_TWG_Fees__c = 50;
        newContractEvent.Total_Vendor_Fee__c = 50;
        newContractEvent.Gross_Premium__c = 50;
        newContractEvent.Net_Premium__c = 50;
        newContractEvent.Tax_Admin_Fee__c = 50;
        newContractEvent.Tax_Agent_Fee__c = 50;
        newContractEvent.Tax_Client_Fee__c = 50;
        newContractEvent.Tax_Corporate_Fee__c = 50;
        newContractEvent.Tax_Dealer_Comm__c = 50;
        newContractEvent.Tax_Escrow_Fee__c = 50;
        newContractEvent.Tax_F_I_Comm__c = 50;
        newContractEvent.Tax_Internal_Pack_Fee__c = 50;
        newContractEvent.Tax_Marketing_Fee__c = 50;
        newContractEvent.Tax_Rate_Above_Net__c = 50;
        newContractEvent.Tax_Rate_Admin_Fee__c = 50;
        newContractEvent.Tax_Rate_Agent_Fee__c = 50;
        newContractEvent.Tax_Rate_Below_Net__c = 50;
        newContractEvent.Tax_Rate_Reserve__c = 50;
        newContractEvent.Total_Reserve__c = 50;
        newContractEvent.Tax_Rate_Risk_Fee__c = 50;
        newContractEvent.Tax_Rate_Stop_Loss_Fee__c = 50;
        newContractEvent.Tax_Rate_TWG_Fee__c = 50;
        newContractEvent.Tax_Rate_Vendor_Fee__c = 50;
        newContractEvent.Tax_Reserve__c = 50;
        newContractEvent.Tax_Risk_Fee__c = 50;
        newContractEvent.Tax_Stop_Loss__c = 50;
        newContractEvent.Tax_TWG_Fee__c = 50;
        newContractEvent.Tax_Type_Above_Net__c = '50';
        newContractEvent.Tax_Type_Admin_Fee__c = '50';
        newContractEvent.Tax_Type_Agent_Fee__c = '50';
        newContractEvent.Tax_Type_Below_Net__c = '50';
        newContractEvent.Tax_Type_Client_Fee__c = '50';
        newContractEvent.Tax_Type_Corporate_Fee__c = '50';
        newContractEvent.Tax_Type_Escrow_Fee__c = '50';
        newContractEvent.Tax_Type_F_I_Comm__c = '50';
        newContractEvent.Tax_Type_Internal_Pack_Fee__c = '50';
        newContractEvent.Tax_Type_IP__c = '50';
        newContractEvent.Tax_Type_Marketing_Fee__c = '50';
        newContractEvent.Tax_Type_Reserve__c = '50';
        newContractEvent.Tax_Type_Risk_Fee__c = '50';
        newContractEvent.Tax_Type_Stop_Loss__c = '50';
        newContractEvent.Tax_Type_TWG_Fee__c = '50';
        newContractEvent.Tax_Type_Vendor_Fee__c = '50';
        newContractEvent.Total_Agent_Fee__c = 50;
        newContractEvent.Total_Billed_Cost__c = 50;
        newContractEvent.Total_Dealer_Cost__c = 50;
        newContractEvent.Total_Escrow_Fee__c = 50;
        newContractEvent.Total_Number_of_Services__c = 50;
        newContractEvent.Total_Retail_Amount__c = 50;
        newContractEvent.Total_Stop_Loss__c = 50;
        newContractEvent.Total_Tax_Above_Net__c = 50;
        newContractEvent.Total_Tax_Below_Net__c = 50;
        newContractEvent.Total_Tax_IP__c = 50;
        newContractEvent.Tax_Rate_Client_Fee__c = 50;
        newContractEvent.Tax_Rate_Corporate_Fee__c = 50;
        newContractEvent.Tax_Rate_Dealer_Comm__c = 50;
        newContractEvent.Tax_Rate_Escrow_Fee__c = 50;
        newContractEvent.Tax_Rate_F_I_Comm__c = 50;
        newContractEvent.Tax_Rate_Internal_Pack_Fee__c = 50;
        newContractEvent.Tax_Rate_IP__c = 50;
        newContractEvent.Tax_Rate_Marketing_Fee__c = 50;
        newContractEvent.Tax_Type_Dealer_Comm__c = '50';
        newContractEvent.Tax_Vendor_Fee__c = 50;
        return newContractEvent;
    }

    public static Set<Vehicle_INT__c> getVehicleINTListForTest() {
        Set<Vehicle_INT__c> vehicleSet = new Set<Vehicle_INT__c>();
        Vehicle_INT__c vehicle = new Vehicle_INT__c();
        vehicle.Name = 'Test Q5';
        vehicle.Manufacturer_Code_INT__c ='SN';
        vehicle.Make_Code_INT__c ='CT';
        vehicle.Make_Name__c ='Acura Test';
        vehicle.Vehicle_Code__c = 'Test@one@two';
        vehicle.Drive_Axle_Type_Code__c = 'FWD';
        vehicle.Vehicle_Type_Code__c = 'P';
        vehicle.Source_System__c = 'FSW';
        vehicle.Trim_Description__c = 'Premium';
        vehicle.Engine_Fuel_Description__c = 'Gas';
        vehicle.Fuel_Type_Code__c = 'G';
        vehicle.Vehicle_Type_Description__c = 'Passenger Car';
        vehicle.Turbo_Super_Charged__c = 'N';
        vehicle.Trim_Level__c = 'trim';
        vehicle.Fuel_Type__c = 'Petrol';
        vehicle.CC__c = '1991';
        vehicle.Body_Style__c = 'Sedan';
        vehicle.Driven_Wheels__c = 'Rear Wheel Drive';
        vehicle.Aspiration__c = 'Turbocharged';
        vehicle.Transmission_Type__c  = 'CVT';
        vehicle.Id = TWGTestFactory.getFakeId(Vehicle_INT__c.sObjectType);
        vehicleSet.add(vehicle);

        vehicle = vehicle.clone(false,false,false,false);
        vehicle.Drive_Axle_Type_Code__c = 'AWD';
        vehicle.Id = TWGTestFactory.getFakeId(Vehicle_INT__c.sObjectType);
        vehicleSet.add(vehicle);

        vehicle = vehicle.clone(false,false,false,false);
        vehicle.Drive_Axle_Type_Code__c = 'FWD';
        vehicle.Vehicle_Type_Code__c = 'T';
        vehicle.Vehicle_Type_Description__c = 'Truck';
        vehicle.Id = TWGTestFactory.getFakeId(Vehicle_INT__c.sObjectType);
        vehicleSet.add(vehicle);

        return vehicleSet;
    }

    public static Dealer_Product__c createDealerProductFEAdminOnly(Account account, TWG_Product__c product)
    {
        createMilestones();
        RecordType recordType = [SELECT Id
                                 FROM RecordType
                                 WHERE Name = 'RDG Dealer Product'
                                ];

        Dealer_Product__c dealerProduct = new Dealer_Product__c(RecordType = recordType,Account__c = account.Id,ProductTypeName_INT__c = 'Test Dealer Product', TWG_Product__c = product.Id,
            Product_Class__c = '06 New Only',Requested_Start_Date__c = System.today(),Start_Date__c = System.today(),
            Participation_Model__c = 'Admin Only', Active__c = true, Visible_for_Quoting__c = true);

        insert dealerProduct;
        return dealerProduct;
    }

    public static Billing_Line_Item__c createBillingLineItem(String recordTypeId, String periodId, String companyName,
        String customerId, Decimal billedCost, String status, String journalId){

        Billing_Line_Item__c billingLineItem = new Billing_Line_Item__c();
        billingLineItem.RecordTypeId = recordTypeId;
        billingLineItem.Period__c = periodId;
        billingLineItem.Company__c = companyName;
        billingLineItem.Customer__c=   customerId;
        billingLineItem.Billed_Cost__c = billedCost;
        billingLineItem.Status__c = status;
        billingLineItem.Journal__c = journalId;
        return billingLineItem;
    }

    public static CardCountMaster__c createCardCountMaster(Date periodDate, String status){
        CardCountMaster__c cardCountMasterRecord = new CardCountMaster__c();
        cardCountMasterRecord.Period__c = periodDate;
        cardCountMasterRecord.Status__c = status;
        return cardCountMasterRecord;
    }

    public static Benefit__c createBenefitRecord(String benefitName) {
        Benefit__c benefitRecord =  new Benefit__c();
        benefitRecord.Benefit_Name__c = benefitName;
        benefitRecord.CurrencyISOCode = 'USD';
    //    benefitRecord.Name = 'B0009';
        benefitRecord.Type__c = System.Label.Benefit_Type_Cost_Plus;
        benefitRecord.TRAN_SRC_CODE__c = '426';
        return benefitRecord;
    }

    public static Participation_Group__c createReinParticipationGroup(){
        Participation_Group__c participationGroup = new Participation_Group__c();
        participationGroup.Name = 'RTO';
        participationGroup.Group_Description__c = 'Retro';
        participationGroup.RecordTypeId = RecordTypeDAO.getRecordTypeId('Participation_Group', 'Participation_Group__c');
        return participationGroup;
    }

    public static Reinsurance_Distribution_Type__c createReinDistributionType(){
        Reinsurance_Distribution_Type__c distributionType = new Reinsurance_Distribution_Type__c();
        distributionType.Name = 'FIT';
        distributionType.Basis__c = 'UPRT';
        distributionType.Type_Description__c = 'Federal Income Tax';
        distributionType.RecordTypeId = RecordTypeDAO.getRecordTypeId('Reinsurance_Distribution_Type', 'Reinsurance_Distribution_Type__c');
        return distributionType;
    }

    public static Global_Participation_Rate__c createGlobalParticipationRate(Id participationGroupId, Id distributionTypeId){
        Global_Participation_Rate__c globalParticipationRate = new Global_Participation_Rate__c();
        globalParticipationRate.Effective_Start_Date__c = System.TODAY();
        globalParticipationRate.Accounting_Start_Date__c = System.TODAY();
        globalParticipationRate.Participation_Group__c = participationGroupId;
        globalParticipationRate.Reinsurance_Distribution_Type__c = distributionTypeId;
        globalParticipationRate.Rate_Percentage__c = 10.10;
        globalParticipationRate.RecordTypeId = RecordTypeDAO.getRecordTypeId('Global_Participation_Rate', 'Global_Participation_Rate__c');
        return globalParticipationRate;
    }

    public static Reinsurance_Company_Rate__c createReinCompanyRate(Id reinCompanyId, Id distributionTypeId){
        Reinsurance_Company_Rate__c reincompanyRate = new Reinsurance_Company_Rate__c();
        reincompanyRate.Accounting_Start_Date__c = System.TODAY();
        reincompanyRate.Effective_Start_Date__c = System.TODAY();
        reincompanyRate.Reinsurance_Company__c = reinCompanyId;
        reincompanyRate.Reinsurance_Distribution_Type__c = distributionTypeId;
        reincompanyRate.Rate_Percentage__c = 10.10;
        reincompanyRate.RecordTypeId = RecordTypeDAO.getRecordTypeId('Reinsurance_Company_Rate', 'Reinsurance_Company_Rate__c');
        return reincompanyRate;
    }

    public static Reinsurance_Company__c createReinReinsuranceCompany(Id participationGroupId){
        Reinsurance_Company__c reinsuranceCompany = new Reinsurance_Company__c();
        reinsuranceCompany.Name = 'ABC';
        reinsuranceCompany.Company_Code__c = '123';
        reinsuranceCompany.Country_Code__c = 'USA';
        reinsuranceCompany.Company_Status__c = 'Active';
        reinsuranceCompany.Company_DRAD_Distribution__c = 'test';
        reinsuranceCompany.GL_Type_Entry__c = 'test';
        reinsuranceCompany.Company_Reporting_Frequency__c = 'test';
        reinsuranceCompany.Report_Type__c = 'test';
        reinsuranceCompany.Report_Due_Days__c = 2;
        reinsuranceCompany.Report_Detail__c = 'test';
        reinsuranceCompany.Company_Payment_Frequency__c = 'test';
        reinsuranceCompany.Participation_Group__c = participationGroupId;
        reinsuranceCompany.Cash_Deposit_Due_Days__c = 2;
        reinsuranceCompany.Reporting_Term_Start__c = System.TODAY();
        reinsuranceCompany.RecordTypeId = RecordTypeDAO.getRecordTypeId('Reinsurance_Company', 'Reinsurance_Company__c');
        return reinsuranceCompany;
    }

    public static Cede_Rule_Header__c createCedeRuleHeader(){
        Cede_Rule_Header__c cedeRuleHeader = new Cede_Rule_Header__c();
        cedeRuleHeader.Rule_Type_New__c = TWG_Constants.CEDE_RULE_TYPE_1;
        cedeRuleHeader.Search_Sequence__c = '1000000';
        cedeRuleHeader.Cede_Basis_New__c = System.Label.Written;
        cedeRuleHeader.Client_Type__c = 'Glow';
        cedeRuleHeader.Client_Code__c = null;
        cedeRuleHeader.RecordTypeId = RecordTypeDAO.getRecordTypeId('Cede_Rule_Header', 'Cede_Rule_Header__c');
        return cedeRuleHeader;
    }
    
    public static Reinsurance_Reporting_Group__c createReinReportingGroup(){
        Reinsurance_Reporting_Group__c reinReportingGroupObjRecord = new Reinsurance_Reporting_Group__c();
        reinReportingGroupObjRecord.Name = 'DI';
        reinReportingGroupObjRecord.Group_Description__c = 'Dimension';
        reinReportingGroupObjRecord.RecordTypeId = RecordTypeDAO.getRecordTypeId('Reinsurance_Reporting_Group', 'Reinsurance_Reporting_Group__c');
        return reinReportingGroupObjRecord;
    }
    
    public static Reinsurance_Reporting_Group_Member__c createReinReportingGroupMember(Id reinReportingGroupId, Id reinCompanyId){
        Reinsurance_Reporting_Group_Member__c reinReportingGroupMemberObjRecord = new Reinsurance_Reporting_Group_Member__c();
        reinReportingGroupMemberObjRecord.Name = 'DI';
        reinReportingGroupMemberObjRecord.Group_Member_Sequence__c = 1;
        reinReportingGroupMemberObjRecord.Reinsurance_Reporting_Group__c = reinReportingGroupId;
        reinReportingGroupMemberObjRecord.Reinsurance_Company__c = reinCompanyId;
        reinReportingGroupMemberObjRecord.RecordTypeId = RecordTypeDAO.getRecordTypeId(
            'Reinsurance_Reporting_Group_Member', 'Reinsurance_Reporting_Group_Member__c');
        return reinReportingGroupMemberObjRecord;
    }

    public static User_Authorization_Limits__c createUserAuthLimit(Id userId) {
        User_Authorization_Limits__c userAuthLimit = new User_Authorization_Limits__c();
        userAuthLimit.User__c = userId;
        userAuthLimit.Authorization_Limit__c = 100;
        userAuthLimit.Payment_Limit__c = 100;
        userAuthLimit.Checked_In__c = true;
        return userAuthLimit;
    }

    public static Maintanence_Reimbursement__c createRedeemedMaintenanceReimbursement(Id contractId)
    {
        Maintanence_Reimbursement__c testMaintanenceReimbursement = new Maintanence_Reimbursement__c();
        testMaintanenceReimbursement.ContractLookup__c = contractId;
        testMaintanenceReimbursement.Status__c = System.Label.Redeemed;
        testMaintanenceReimbursement.Name = 'test';
        testMaintanenceReimbursement.Amount__c = 100;
        return testMaintanenceReimbursement;
    }

    public static Card_Type__c createCardType(String name) {
        Card_Type__c newCard = new Card_Type__c();
        newCard.Name = name;
        return newCard;
    }

    public static Document documentRecord(Id userId) {
        Document document = new Document();
        document.Body = Blob.valueOf('Some Text');
        document.ContentType = 'application/pdf';
        document.DeveloperName = 'my_document';
        document.IsPublic = true;
        document.Name = 'AE_FAQ_EN';
        document.FolderId = userId;
        return document;

    }

    public static Contract__c createSamsungContract(String name, String consumerName, String buyerName, String policyStatus,
        String paymentStatus) {
        Contract__c contract = new Contract__c();
        contract.Name = name;
        contract.Consumer_Name__c = consumerName;
        contract.RecordTypeId = ContractConstants.CONTRACT_SAMSUNG_RECORD_TYPE_ID;
        contract.Buyer_Name__c = buyerName;
        contract.Policy_Status__c = policyStatus;
        contract.Payment_Status__c = paymentStatus;
        contract.Discount_Amount__c = 0;
        contract.CurrencyIsoCode = 'AUD';
        return contract;
    }

    public static Contract_Event__c createContractEventAT(Id contractId, Decimal amount, String Status){
        Contract_Event__c newContractEvent = new Contract_Event__c();
        newContractEvent.RecordTypeId = RecordTypeDAO.getRecordTypeId('AT_Contract_Event', 'Contract_Event__c');
        newContractEvent.Contract__c = contractId;
        newContractEvent.Amount__c = amount;
        newContractEvent.Status__c = Status;
        newContractEvent.Occurrence__c = System.today();
        newContractEvent.Is_Financial_Transaction__c = true;
        return  newContractEvent;
    }

    public static case createSamsungCase(Id contractId, Id contactId) {
        Case caseObj = new Case();
        caseObj.Contract_New__c = contractId;
        caseObj.ContactId = contactId;
        caseObj.Failure_Category__c = 'System';
        caseObj.Failure_Subcategory__c = 'Does Not Charge';
        caseObj.Priority = Label.Text_Case_Priority_High;
        caseObj.RecordTypeId = CaseConstants.CASE_SAMSUNG_RECORD_TYPE_ID;
        caseObj.CurrencyIsoCode = 'AUD';
        return caseObj;
    }
    
    public static void createDealerProductFormForFSW(Account fswAccount){
        TWG_Product__c twgProduct = new TWG_Product__c(Name = 'Test Base Product',
            Product_Code__c = 'PCODE'+getRandomString(),Product_Type__c = 'W - Service Contract',
            Product_Start_Date__c = System.now(),Channel__c = 'First Extended',Country_Code__c = 'US / USA',
            Client_Type_Distribution_Channel__c = 'Dealer',Product_Description__c = 'For testing',Vehicle_Group_ID__c = 'VGI0001',
            UW_Insurance_Rate_Code__c = 'TESTING1234',UW_TWG_Fees_Rate_Code__c = 'TESTING1234');
        insert twgProduct;
        Dealer_Product__c dealerProduct = TWGTestFactory.createDealerProductFEAdminOnly(fswAccount, twgProduct);
        Dealer_Product_Forms__c productForm = new Dealer_Product_Forms__c();
        productForm.Dealer_Product__c = dealerProduct.Id;
        productForm.Agreement_Form_Number__c = 'AWS012345';
        productForm.Start_Date__c = Date.today().addDays(-2);
        productForm.End_Date__c = Date.today().addDays(2);
        insert productForm;
    }

    public static Client_Fee_Payee_Account_Settings__c createClientFeePayeeAccountCustomSetting(String name, String prefix, Integer lastGeneratedNum, Integer minLength) {
        Client_Fee_Payee_Account_Settings__c payeeSettings = new Client_Fee_Payee_Account_Settings__c();
        payeeSettings.Name = name;
        payeeSettings.Prefix__c = prefix;
        payeeSettings.Last_Generated_Number__c = lastGeneratedNum;
        payeeSettings.Minimum_Length__c = minLength;
        
        return payeeSettings;
    }

    public static List<Billing_Item__c> createBillingItem(List<Case_Payee__c> casePayeeList, String recordTypeId){
        List<Billing_Item__c> listOfBillingItem = new List<Billing_Item__c>();
        for(Case_Payee__c casePayee : casePayeeList){
            Billing_Item__c item = new Billing_Item__c();
            item.recordTypeId = recordTypeId;
            item.Case_Payee__c = casePayee.Id;
            item.Amount__c = casePayee.FIN_Total_Paid_Amount__c;
            item.Statement_Type__c = BillingItemConstants.STATEMENT_TYPE_PAYABLE;
            item.Client__c = casePayee.Account__c;
            listOfBillingItem.add(item);
        }
        return listOfBillingItem;
    }

    public static Object mockFieldType(String sObjectName, String fieldName) {
        if (allObjectMap == NULL) {
            allObjectMap = Schema.getGlobalDescribe();
        }

        if (!fieldMapByObject.containsKey(sObjectName)) {
            fieldMapByObject.put(
                sObjectName,
                allObjectMap.get(sObjectName).getDescribe().fields.getMap()
            );
        }

        Map<String, Schema.SObjectField> fieldMap = fieldMapByObject.get(sObjectName);
        Schema.DescribeFieldResult fieldDescribe = fieldMap.get(fieldName).getDescribe();
        String fieldType = String.valueOf(fieldDescribe.getType());
        if (fieldDescribe.isUpdateable()) {
            if (fieldType == 'String' || fieldType == 'TextArea') {
                return 'A';
            } else if (fieldType == 'Integer' || fieldType == 'Currency') {
                return 1;
            } else if (fieldType == 'Double' || fieldType == 'Percent') {
                return 1.0;
            } else if (fieldType == 'Boolean') {
                return TRUE;
            } else if (fieldType == 'Date' || fieldType == 'DateTime') {
                return System.today();
            } else if (fieldType == 'ID' || fieldType == 'Reference') {
                return getFakeId(fieldDescribe.getReferenceTo()[0]);
            } else if (fieldType == 'Email') {
                return 'user@example.com';
            }
        }
        return null;
    }
    
    public static User createUserForRegistration() {
        return new User(FirstName = 'fname', LastName = 'lname', email = 'newTestUserForRegistrationWS@yahoo.in');
    }
    
    public static NM_Insurance_Field_Values__c createNMInsuranceFieldValues()
    {
        Id ProfileId = [SELECT Id 
                        FROM Profile
                        WHERE Name = 'Customer Community User Custom'].Id;

        Id RecordTypeIdAccount = Schema.SObjectType.Account.getRecordTypeInfosByName().get('NM Customer').getRecordTypeId();
        
        NM_Insurance_Field_Values__c insuranceFieldValue = new NM_Insurance_Field_Values__c(Account_Owner__c = UserInfo.getUserId(), 
        Record_Type__c = RecordTypeIdAccount, Name = 'NMI',Profile_Id__c = ProfileId);
        
        insert insuranceFieldValue;
        
        return insuranceFieldValue;
    }
    
    public static User createPortalUserWithSystemAdminRole(Id profileId){
        
        UserRole objUserRole = [SELECT Id, Name 
                                FROM UserRole 
                                WHERE Name = 'System admin'];
                                
        User portalOwner = new User();
        portalOwner.Alias = 'guest';
        portalOwner.TimeZoneSidKey = 'GMT';
        portalOwner.LocaleSidKey = 'en_US';
        portalOwner.EmailEncodingKey = 'ISO-8859-1';
        portalOwner.LanguageLocaleKey = 'en_US';
        portalOwner.lastName = 'test';
        portalOwner.Username = 'test1.NM_INS@test.com';
        portalOwner.Email = 'test@test.com';
        portalOwner.CommunityNickname  = 'test_NM_INS-1';
        portalOwner.ProfileId = profileId; 
        portalOwner.UserRoleId = objUserRole.Id;
        insert portalOwner; 
        
        return portalOwner;
    }
    
    public static void createNMISettings(){
        NMI_Settings__c nmiSetting = new NMI_Settings__c(Public_Security_Key__c='cRfUjXn2',
                                     Name='TWG Service Cloud',SetupOwnerId=UserInfo.getOrganizationId());
        insert nmiSetting;
    }

    public static Form_Master_Table__c createFormMasterTable() {
        Form_Master_Table__c formMaster = new Form_Master_Table__c();
        formMaster.Name = 'Agreement001';
        formMaster.Cancelable_Flag__c = 'Y';
        formMaster.Form_Number__c= 'Test';
        formMaster.Country_Code__c= 'GBR';       
        return formMaster;
    }

    public static Cancel_Rule_Header__c createCancelRuleHeader() {
        Cancel_Rule_Header__c cancelRuleHeader = new Cancel_Rule_Header__c();
        cancelRuleHeader.Name = '1';
        cancelRuleHeader.Agreement_Form_Number__c = 'VPC001NCT0815';
        cancelRuleHeader.Country__c = 'USA';
        cancelRuleHeader.Date_Basis__c = System.Label.Inservice_Date_Months;
        cancelRuleHeader.Fee_is_of_Refund_Amount__c = 'Y';
        cancelRuleHeader.Flat_Cancel_Days__c = 99;
        cancelRuleHeader.Location__c = 'C';
        cancelRuleHeader.Odometer_Basis__c = 'P - (At Purchase miles)';
        cancelRuleHeader.Start_Date__c = Date.today().addDays(-100);
        cancelRuleHeader.State__c = 'IL';
        cancelRuleHeader.Stop_Date__c = Date.today().addDays(20);
        cancelRuleHeader.Expiration_Type__c = 'AOTAM';
        return cancelRuleHeader;
    }

    public static Cancel_Rule_Header__c createCancelRuleHeader(Form_Master_Table__c formMaster) {
        Cancel_Rule_Header__c cancelRuleHeader = new Cancel_Rule_Header__c();
        cancelRuleHeader.Name = '1';
        cancelRuleHeader.Agreement_Form_Number__c = 'VPC001NCT0815';
        cancelRuleHeader.Country__c = 'USA';
        cancelRuleHeader.Date_Basis__c = System.Label.Inservice_Date_Months;
        cancelRuleHeader.Fee_is_of_Refund_Amount__c = 'Y';
        cancelRuleHeader.Flat_Cancel_Days__c = 99;
        cancelRuleHeader.Location__c = 'C';
        cancelRuleHeader.Odometer_Basis__c = 'P - (At Purchase miles)';
        cancelRuleHeader.Start_Date__c = Date.today().addDays(-100);
        cancelRuleHeader.State__c = 'IL';
        cancelRuleHeader.Stop_Date__c = Date.today().addDays(20);
        cancelRuleHeader.Form_Number__c = formMaster.Id;
        cancelRuleHeader.Expiration_Type__c = 'AOTAM';
        return cancelRuleHeader;
    }

    public static Cancel_Rule_Detail__c createCancelRuleDetail(Cancel_Rule_Header__c cancelRuleHeader) {
        Cancel_Rule_Detail__c cancelRuleDetail = new Cancel_Rule_Detail__c();
        cancelRuleDetail.Allow_Paid_Claim__c = 'Y';
        cancelRuleDetail.Cancel_Basis__c = System.label.Flat;
        cancelRuleDetail.Fee_Amount__c = 25;
        cancelRuleDetail.Fee_Basis__c = 'Refund_Amount';
        cancelRuleDetail.Fee_Percent__c = 10;
        cancelRuleDetail.Fee_Type__c = 'A - amt';
        cancelRuleDetail.Fixed_Refund__c = 10;
        cancelRuleDetail.Holder_Refund_Basis__c = 'F- Flat';
        cancelRuleDetail.Period__c = 99;
        cancelRuleDetail.Retain_Paid_Claims__c = 'N';
        cancelRuleDetail.Sequence_Number__c = cancelRuleHeader.Id;

        return cancelRuleDetail;
    }
    
    public static AR_Settings__c createArSettings() {
        AR_Settings__c arSettings = new AR_Settings__c();
        arSettings.name = 'GLOW AR Settings';
        arSettings.Captcha_Base_Url__c = 'http://testing.twg.com/';
        arSettings.Captcha_Public_Key__c = 'testCaptchaPublicKey';
        arSettings.Captcha_Secret_Key__c = 'testCaptchaSecretKey';
        arSettings.Sandbox_Name__c = 'DEVVVV';
        arSettings.End_Point_Of_GetClaimNumber_Web_Service__c = 'someurl';
        arSettings.Environment__c = 'DEV';
        arSettings.Is_Month_End_In_Progress__c = False;
        arSettings.Is_Service_Saver_Available__c = False;
        arSettings.Consumers_Service_Email_Address__c = 'test@test.com';
        arSettings.Consumer_Login_Url__c = 'testUrl';
        arSettings.Community_Person_Account_Owner__c = UserInfo.getUserName();
        arSettings.SetupOwnerId = UserInfo.getOrganizationId();
        arSettings.Service_Center_Range_Distance__c= 100;
        arSettings.Google_Maps_Public_Key__c = 'abcdefghr';
        arSettings.Max_Estimate_Time__c = '2h';
        arSettings.Max_Distance_For_Hourly_Calculation__c = 2;
        arSettings.Max_Transport_Hourly_Cost__c = 200;
        arSettings.Max_Transport_Kilometer_Cost__c = -12.2;
        return arSettings;
    }
    
    public static Country_Tax_Format__c createCountryTaxFormat(String country){
        Country_Tax_Format__c ctyTaxFmt = new Country_Tax_Format__c();
        ctyTaxFmt.Name = country + '_VAT';
        ctyTaxFmt.Auto_Prefix__c = false;
        ctyTaxFmt.Country__c = country;
        ctyTaxFmt.Input_Format__c = '(XX)?\\d{9}';
        ctyTaxFmt.Left_Pad_Zero__c = false;
        ctyTaxFmt.Maximum_Field_Size__c = 9;
        ctyTaxFmt.Minimum_Field_Size__c = 9;
        ctyTaxFmt.Output_Format__c = '(9)';
        ctyTaxFmt.Tax_Prefix__c = 'XX';
        ctyTaxFmt.Tax_Type__c = 'VAT';
        return ctyTaxFmt;
    }

    public static Contact createEUContact(Account a) {
        Contact c = new Contact();
        c.LastName = 'Test';
        c.AccountId = a.Id;
        RecordType recordType = RecordTypeDAO.getRecordType(ContactConstants.RECORD_TYPE_EU_CONTACT , 'Contact');
        c.RecordType = recordType;
        c.RecordTypeId = recordType.Id;
        return c;
    }
    
    public static Account createEUAgentAccount(String accountName){
        Account testAccount = new Account();
        testAccount.RecordTypeId = RecordTypeDAO.getRecordTypeId('EU_Agent' , 'Account');
        testAccount.FirstName = 'Test';
        testAccount.LastName = accountName;
        testAccount.ISFSW__c = true;
        testAccount.BillingCountry = 'GBR';
        testAccount.VAT_Number__C = '012345678';
        testAccount.Digit_Limit__c = '7';
        testAccount.Contract_Seq_No__c = '1234567';
        return testAccount;
    }

    public static Contact_Us_Form__c createContactUsForm() {
        Contact_Us_Form__c contactUsForm = new Contact_Us_Form__c();
        contactUsForm.Name__c = 'User Test First Name';
        contactUsForm.Last_Name__c = 'Lastname';
        contactUsForm.Contact_Email__c = 'sampleemail@twg.com';
        contactUsForm.Phone_Number__c = '9876543210';
        contactUsForm.Message__c = 'Hi this is test message';
        return contactUsForm;
    }
    
    public static Auth.UserData createTestUserData(String email, String lastName, String firstName, String gender) {
        String fullName = 'Jones-Drew-Jon-Snow Thomas';
        Map<String, String> attributeMap = new Map<String,String>();
        attributeMap.put('full_name', fullName);
        attributeMap.put('name', fullName);
        attributeMap.put('gender', gender);
        attributeMap.put('email', email);
        attributeMap.put('picture', 'url=www.testpicture.com/picture.jpg}');

        return new Auth.UserData(lastName+System.currentTimeMillis(), firstName, lastName, fullName, email, '', 
            'Test.12436799@SSO.com', 'es_AR', '', '', attributeMap);
    }
    
    public static Billing_Statements__c createBillingStatement(Account testAccount, Decimal totalAmount, String statementId){
        Billing_Statements__c testBillingStatement = new Billing_Statements__c();
        testBillingStatement.Client_Name__c = testAccount.Id;
        testBillingStatement.From_Date__c =  System.today() - 3;
        testBillingStatement.To_Date__c = System.today() + 3;
        testBillingStatement.Due_Date__c = System.today().addDays(30);
        testBillingStatement.Generated_for_Month__c = System.today().month();
        testBillingStatement.Total_Amount__c = totalAmount; 
        testBillingStatement.Outstanding_Amount__c = totalAmount; 
        testBillingStatement.Payment_Status__c = 'Unpaid';
        testBillingStatement.Statement_Id__c = statementId;
        return testBillingStatement;
    }

    public static Validation_Rule_Group__c createValidationRuleGroup(Id recordTypeId, String name, String fieldsToValidate,
        Integer numberOfValidFields) {

        Validation_Rule_Group__c validationRuleGroup = new Validation_Rule_Group__c();
        validationRuleGroup.RecordTypeId = recordTypeId;
        validationRuleGroup.Name = name;
        validationRuleGroup.Fields_To_Validate__c = fieldsToValidate;
        validationRuleGroup.Number_of_Valid_fields__c = numberOfValidFields;
        return validationRuleGroup;
    }

    public static Dealer_Product__c createDealerProduct(Id recordTypeId, String name, Account account,
        TWG_Product__c twgProduct) {

        Dealer_Product__c dealerProduct = new Dealer_Product__c();
        dealerProduct.RecordTypeId = recordTypeId;
        dealerProduct.Name = name;
        dealerProduct.TWG_Product__c = twgProduct.Id;
        dealerProduct.Account__c = account.Id;

        return dealerProduct;
    }

    public static Model_Claim_Category__c createModelClaimCategory(Id recordTypeId, String name) {
        Model_Claim_Category__c modelClaimCategory = new Model_Claim_Category__c();
        modelClaimCategory.Name = name;
        modelClaimCategory.RecordTypeId = recordTypeId;
        modelClaimCategory.Model_Claim_Category_Group_Code__c = 'ab';
        modelClaimCategory.Model_Claim_Category_Code__c = 'ab';
        return modelClaimCategory;
    }

    public static Business_Type__c createBusinessType(Id recordTypeId, String name) {
        Business_Type__c businessType = new Business_Type__c();
        businessType.Name = name;
        businessType.RecordTypeId = recordTypeId;
        return businessType;
    }

    public static Manufacturer_INT__c createManufacturerINT(Id recordTypeId, String name) {
        Manufacturer_INT__c manufacturerINT = new Manufacturer_INT__c();
        manufacturerINT.Name = name;
        manufacturerINT.RecordTypeId = recordTypeId;
        manufacturerINT.Network_Service_Code__c = 'abc';
        return manufacturerINT;
    }

    public static VIN_Decoding_Service_Setting__c createVinDecodeServiceSettings(){
        VIN_Decoding_Service_Setting__c vinDecodeServiceSetting = new VIN_Decoding_Service_Setting__c();
        vinDecodeServiceSetting.name = 'VinDecodeService';
        vinDecodeServiceSetting.Client_ID__c = 'clientID';
        vinDecodeServiceSetting.Client_Secret__c = 'ClientSecret';
        vinDecodeServiceSetting.URL__c = 'https://www.testconnection.thewg.com';
        return vinDecodeServiceSetting;
    }

    public static Coverage__c createCoverage(Id recordTypeId, String coverageName) {
        Coverage__c testCoverage = new Coverage__c();
        testCoverage.Coverage_Name__c = coverageName;
        testCoverage.RecordTypeId = recordTypeId;
        return testCoverage;
    }

    public static Dealer_Coverage_Type__c createDealerCoverageType(Id recordTypeId, String dealerCoverageGroupDescription,
        String coverageTypeCode) {

        Dealer_Coverage_Type__c testDealerCoverageType = new Dealer_Coverage_Type__c();
        testDealerCoverageType.Dealer_Coverage_Group_Description__c = dealerCoverageGroupDescription;
        testDealerCoverageType.Coverage_Type_Code__c = coverageTypeCode;
        testDealerCoverageType.RecordTypeId = recordTypeId;
        testDealerCoverageType.From_Date__c = Date.newInstance(2015,12,31);
        testDealerCoverageType.To_Date__c = Date.newInstance(2017,12,1);
        return testDealerCoverageType;
    }

    public static Dealer_Coverage_Group__c createDealerCoverageGroup(Id recordTypeId, Id testCoverageId,
        Id testDealerCoverageTypeId) {

        Dealer_Coverage_Group__c testDealerCoverageGroup = new Dealer_Coverage_Group__c();
        testDealerCoverageGroup.Coverage__c = testCoverageId;
        testDealerCoverageGroup.Dealer_Coverage_Type__c = testDealerCoverageTypeId;
        testDealerCoverageGroup.RecordTypeId = recordTypeId;
        return testDealerCoverageGroup;
    }
    
    public static Cede_Rule_Detail__c createCedeRuleDetail( Id cedeRuleHeaderId, Id reinCompanyId){
        Cede_Rule_Detail__c cedeRuleDetail = new Cede_Rule_Detail__c();
        cedeRuleDetail.Name = '1';
        cedeRuleDetail.Cede_Rule_Header__c = cedeRuleHeaderId;
        cedeRuleDetail.To_Reinsurance_Company__c = reinCompanyId;
        cedeRuleDetail.Cede_Basis_New__c = 'written';
        cedeRuleDetail.Business_Split_Pct__c = 20;
        cedeRuleDetail.recordTypeId = RecordTypeDAO.getRecordTypeId('Cede_Rule_Detail', 'Cede_Rule_Detail__c');
        return cedeRuleDetail;
    }
    
    public static Service_Part__c createServicePartByServiceReport(Id reportId) {
        Service_Part__c testPart = new Service_Part__c();
        testPart.Service_Report__c = reportId;
        return testPart;
    }

    public static Contract__c createContract(Quote_Dealer_Product__c qdp, Date inserviceDate)
    {
        Contract__c contract = new Contract__c();
        contract.Name = 'UNITTESTX';
        contract.Status__c = 'New';
        contract.Premium_Location_Code_INT__c = 'C';
        contract.Quote_Dealer_Product__c = qdp.Id;
        contract.In_Service_Date_INT__C = inserviceDate;
        return contract;
    }

    public static Quote_Dealer_Product__c  createQuoteDealerProductWithNoInsert(Dealer_Product__c dp,Quote__c quote)
    {
        Quote_Dealer_Product__c qdp = new Quote_Dealer_Product__c (Dealer_Product__c = dp.Id, Quote__c = quote.Id,Quote__r = quote);
        return qdp;
    }

    public static Quote__c createQuoteWithNoInsert(Account a)
    {
        Quote__c quote = new Quote__c(Account__r = a,Account__c = a.Id,VIN__c = '12345678901234567');
        return quote;
    }

    public static Dealer_Product__c createDealerProduct(Account a, TWG_Product__c prod, Boolean insertFlag) {
        Id recordTypeId = RecordTypeDAO.getRecordTypeId('RDG_Dealer_Product', 'Dealer_Product__c');

        Dealer_Product__c dealerProduct = new Dealer_Product__c();
        dealerProduct.RecordTypeId = recordTypeId;
        dealerProduct.Name = 'TEST1';
        dealerProduct.Account__c = a.Id;
        dealerProduct.ProductTypeName_INT__c = 'Test Dealer Product';
        dealerProduct.TWG_Product__c = prod.Id;
        dealerProduct.Product_Class__c = '06 New Only';
        dealerProduct.Requested_Start_Date__c = System.today();
        dealerProduct.Start_Date__c = System.today();
        dealerProduct.Participation_Model__c = 'Direct';

        if(insertFlag)
        {
            insert dealerProduct;
        }
        
        return dealerProduct;
    }

    public static List<Dealer_Report__c> createDealerReports(Integer numOfRecords, Id clientId, Id recordTypeId) {
        List<Dealer_Report__c> dealerReports = new List<Dealer_Report__c>();

        for(Integer i=0; i<numOfRecords; i++) {
            Dealer_Report__c dealerReport = new Dealer_Report__c();
            dealerReport.Client_Name__c = clientId;
            dealerReport.From_Date__c = System.today().addDays(i);
            dealerReport.To_Date__c = System.today().addDays(20);
            dealerReport.RecordTypeId = recordTypeId; 
            dealerReports.add(dealerReport);
        }

        return dealerReports;
    }

    public static Additional_Account_Contact__c createAdditionalAccountContact(){
        Account testAccount = TWGTestFactory.createAccount();
        testAccount.Name = 'Test Account name';
        testAccount.AccountNumber = 'ABCD12';
        insert testAccount;
        Contact testContact = new Contact();
        testContact.FirstName = 'Test';
        testContact.LastName = 'Last';
        testContact.AccountId = testAccount.Id;
        insert testContact;
        TWGTestFactory.createCommunityUser(testContact);
        Additional_Account_Contact__c testRecord = new Additional_Account_Contact__c();
        testRecord.Account__c = testAccount.Id; 
        testRecord.Contact__c = testContact.Id;
        return testRecord;
    }
    
    public static Expiration_Type_Question__c createExpirationTypeQuestion(Id formMasterID){
        Expiration_Type_Question__c expTypeQuestion = new Expiration_Type_Question__c();
        expTypeQuestion.Coverage_Name__c = 'Platinum';
        expTypeQuestion.Expected_Answer__c = 'Motor Home;RV';
        expTypeQuestion.Expiration_Type__c = 'AOTOM';
        expTypeQuestion.Form_Number__c = formMasterID;
        expTypeQuestion.Question__c = 'Vehicle Type';
        expTypeQuestion.Vehicle_New_Used__c = 'New';
        return expTypeQuestion;
    }   
    
    public static Client_Fee_Allocation_Header__c createClientFeeAllocationHeader(String dealerProductId, String dealerId) {
        Client_Fee_Allocation_Header__c header = new Client_Fee_Allocation_Header__c();
        header.Dealer_Product__c = dealerProductId;
        header.Start_Date__c = Date.today();
        header.Stop_Date__c = Date.today().addDays(99);
        header.Allocation_Type__c = 'Fixed';
        header.Client_Fee__c = 100;
        header.Dealer_Name__c = dealerId;
        return header;
    }
    
    public static Client_Fee_Allocation_Detail__c createClientFeeAllocationDetail(String headerId, String accountId) {
        Client_Fee_Allocation_Detail__c detail = new Client_Fee_Allocation_Detail__c();
        detail.Allocation_Header__c = headerId;
        detail.Account__c = accountId;
        detail.Allocation_Amount_Percentage__c = 50;
        return detail;
    }
    
    public static List<Skip_User_Config__c> setConversionSetting (String userId) {
        List<Skip_User_Config__c> conversionSettings = new List<Skip_User_Config__c>();
        conversionSettings.add(new Skip_User_Config__c(Name = 'US Auto Conversion', User_Id__c = userId));
        conversionSettings.add(new Skip_User_Config__c(Name = UserConstants.MX_AUTO_CONVERSION, User_Id__c = userId));
        return conversionSettings;
    }
    
    public static Claim_Workflow_Step__c createClaimWorkflowStep(Id testCaseId, RecordType testRecordType) {
        Claim_Workflow_Step__c testClaimWorkFlowStep = new Claim_Workflow_Step__c();
        testClaimWorkFlowStep.Case__c = testCaseId;
        testClaimWorkFlowStep.RecordType = testRecordType;
        return testClaimWorkFlowStep;
    }
    

    public static Claim_Flow_Service__c createClaimFlowService(RecordType testRecordType) {
        Claim_Flow_Service__c testClaimFlowService = new Claim_Flow_Service__c();
        testClaimFlowService.Name = 'test Claim Flow Service';
        testClaimFlowService.RecordType = testRecordType;
        return testClaimFlowService;
    }

    public static Claim_Display_Field_Service__c createClaimDisplayFieldService(Id claimFlowServiceId, RecordType testRecordType){
        Claim_Display_Field_Service__c testClaimDisplayFieldService = new Claim_Display_Field_Service__c();
        testClaimDisplayFieldService.Claim_Flow_Service__c = claimFlowServiceId;
        testClaimDisplayFieldService.RecordType = testRecordType;
        testClaimDisplayFieldService.Order__c = 12;
        return testClaimDisplayFieldService;
    }
    
    public static Claim_Failure_Product_Code_Service__c createClaimFailureProductCodeService(RecordType testRecordType){
        Claim_Failure_Product_Code_Service__c testClaimFailureProductCodeService = new Claim_Failure_Product_Code_Service__c();
        testClaimFailureProductCodeService.Product_Codes__c = 'abc';
        testClaimFailureProductCodeService.RecordType = testRecordType;
        return testClaimFailureProductCodeService;
    }

    public static Monthly_Inflation__c createMonthlyInflation(String yearMonth, RecordType testRecordType) {
        Monthly_Inflation__c testMonthlyInflation = new Monthly_Inflation__c();
        testMonthlyInflation.Year_Month__c = yearMonth;
        testMonthlyInflation.RecordType = testRecordType;
        return testMonthlyInflation;
    }
    
    public static Claim_Failure_Type_Product_Code_Service__c createClaimFailureTypeProductCodeService(
        RecordType testRecordType, Id claimFailureServiceId) {
        Claim_Failure_Type_Product_Code_Service__c testClaimFailureTypeProductCodeService = 
            new Claim_Failure_Type_Product_Code_Service__c();
        testClaimFailureTypeProductCodeService.RecordType = testRecordType;
        testClaimFailureTypeProductCodeService.Name = 'testClaimfailuretype'; 
        testClaimFailureTypeProductCodeService.Claim_Failure_Service__c = claimFailureServiceId;
        testClaimFailureTypeProductCodeService.RecordType = testRecordType;
        return testClaimFailureTypeProductCodeService;
    }
    
    public static Claim_Failure_Service__c createClaimFailureService(RecordType testRecordType) {
        Claim_Failure_Service__c claimFailureService = new Claim_Failure_Service__c();
        claimFailureService.Failure_Type__c = 'Failures associated with Claim opening';
        claimFailureService.Failure_Description__c = 'abcd';
        claimFailureService.RecordType = testRecordType;
        return claimFailureService;
    }
    
    public static Claim_Validation_Service__c createClaimValidationService(RecordType testRecordType) {
         Claim_Validation_Service__c testClaimValidationService = new  Claim_Validation_Service__c();
         testClaimValidationService.RecordType = testRecordType;
         testClaimValidationService.Coverage_Type__c = 'CONTRACT STATUS';
         testClaimValidationService.Is_Claim__c = true;
         return testClaimValidationService;        
    }
    
    public static Claim_Flow_Validation_Service__c createClaimFlowValidationService(
        RecordType testRecordType, Id claimFlowServiceId, Id claimValidationServiceId) {
        Claim_Flow_Validation_Service__c testClaimFlowValidationService = new Claim_Flow_Validation_Service__c();
        testClaimFlowValidationService.RecordType = testRecordType;
        testClaimFlowValidationService.Claim_Flow_Service__c = claimFlowServiceId;
        testClaimFlowValidationService.Claim_Validation_Service__c = claimValidationServiceId;
        return testClaimFlowValidationService;
    }
    
    public static Location__c createLocation(RecordType testRecordType) {
        Location__c testLocation = new Location__c();
        testLocation.Area_code__c = 'abc';
        testLocation.Country__c = 'Argentina';
        testLocation.RecordType = testRecordType;
        return testLocation;
    }
    
    public static Service_Center_Assignment__c createServiceCenterAssignment(RecordType testRecordType) {
        Service_Center_Assignment__c  testServiceCenterAssignment = new Service_Center_Assignment__c();
        testServiceCenterAssignment.RecordType = testRecordType;
        testServiceCenterAssignment.Model_Claim_Category_Group_Code__c = 'abc';
        testServiceCenterAssignment.Dealer_Code__c = 'abc';
        testServiceCenterAssignment.Group_Location_Code__c = 123;
        testServiceCenterAssignment.Network_Service_Code__c = 'abc';
        testServiceCenterAssignment.Active__c = true;
        return testServiceCenterAssignment;
    }

    public static Reinsurance_Report_Request__c createReinsuranceReportRequest(){
        Reinsurance_Report_Request__c reinsuranceReportRequest = new Reinsurance_Report_Request__c();
        reinsuranceReportRequest.Process_Request__c = System.Label.Run_Final;
        return reinsuranceReportRequest;
    }
    
    public static Account createEUCustomerAccount() {
        Account testAccountEUCustomer = new Account();
        testAccountEUCustomer.RecordTypeId = RecordTypeDAO.getRecordType('EU_Customer', 'Account').Id;
        testAccountEUCustomer.LastName = 'EUCustomer';
        testAccountEUCustomer.ISFSW__c = true;
        testAccountEUCustomer.BillingCountry = 'GBR';
        return testAccountEUCustomer;
    }

    public static Note__c createNote(RecordType testRecordType){
        Note__c testNote = new Note__c();
        testNote.Subject_Code__c = 'WEBR';
        testNote.RecordType = testRecordType;
        return testNote;
    }
    
    public static User_Activity_Type__c createUserActivityType(RecordType testRecordType) {
        User_Activity_Type__c testUserActivityType = new User_Activity_Type__c();
        testUserActivityType.RecordType = testRecordType;
        testUserActivityType.Activity_Code__c = 'testCode';
        testUserActivityType.Description__c = 'testDescription';
        return testUserActivityType;
    }

    public static User_Activity_Log__c createUserActivityLog(RecordType testRecordType,
        User_Activity_Type__c testUserActivityType) {
        User_Activity_Log__c testUserActivityLog = new User_Activity_Log__c();
        testUserActivityLog.User__c = UserInfo.getUserId();
        testUserActivityLog.RecordType = testRecordType;
        testUserActivityLog.User_Activity_Type__c = testUserActivityType.Id;
        return testUserActivityLog;
    }

    public static List<Vehicle_INT__C> createVehicleIntForMexico(){
        Make_INT__c makeInt = new Make_INT__c(Name = 'Volvo', Name__c = 'XC90', Special_ID__c = 'XC', Make_Name_Alias__c = 'XC90');
        insert makeInt;
        
        List<Vehicle_INT__C> vehicleIntListMexico = new List<Vehicle_INT__C>();
        Vehicle_INT__C vehicleInt
            = new Vehicle_INT__c(Name = 'ILX', Make_Code__c = makeInt.Id, Trim_Description__c = 'DX', 
                                 Vehicle_Type_Code__c = 'P', Vehicle_Type_Description__c = 'Passenger Car',
                                 RecordTypeId = RecordTypeDAO.getRecordTypeId(QuoteConstants.MEXICO_VEHICLE_MODEL, 
                                                                              'Vehicle_INT__c'),
                                 Engine_Fuel_Description__c = 'Gas', Fuel_Type_Code__c = 'G', 
                                 Drive_Axle_Type_Code__c = 'FWD', Vehicle_Code__c = 'HONDA@ACCORD@DX@FWD@G@P@N',
                                 Source_System__c = 'FSW', Turbo_Super_Charged__c = 'N');
        vehicleIntListMexico.add(vehicleInt);
        Vehicle_INT__C vehicleInt2
            = new Vehicle_INT__c(Name = 'ILX', Make_Code__c = makeInt.Id, Trim_Description__c = 'EX',
                                 Vehicle_Type_Code__c = 'P', Vehicle_Type_Description__c = 'Passenger Car',
                                 RecordTypeId = RecordTypeDAO.getRecordTypeId(QuoteConstants.MEXICO_VEHICLE_MODEL, 
                                                                              'Vehicle_INT__c'),
                                 Engine_Fuel_Description__c = 'Gas', Fuel_Type_Code__c = 'G',
                                 Drive_Axle_Type_Code__c = 'FWD', Vehicle_Code__c = 'HONDA@ACCORD@EX@FWD@G@P@N',
                                 Source_System__c = 'FSW', Turbo_Super_Charged__c = 'N');
        vehicleIntListMexico.add(vehicleInt2);
        
        return vehicleIntListMexico;
    }
    
    public static List<DealerVehicleMakeModel__c> createDealerVehicleForMexico(Id accountId, Id makeId){
        List<DealerVehicleMakeModel__c> lstdmm = new List<DealerVehicleMakeModel__c>();
        DealerVehicleMakeModel__c dealerVehicleMakeModel
            = new DealerVehicleMakeModel__c(MAKE_CODE_INT__C=makeId, DEALER__C=accountId,
                                            RecordTypeId = RecordTypeDAO.getRecordTypeId(
                                            QuoteConstants.MEXICO_DEALER_VEHICLE_MAKE_MODEL,'DealerVehicleMakeModel__c'));
        lstdmm.add(dealerVehicleMakeModel);
        return lstdmm;
    }
    
    public static Classification_Code__c createClassificationCode(String codeValue)
    {
        Classification_Code__c newCode = new Classification_Code__c();
        newCode.Classification_Code__c = codeValue;
        return newCode;
    }
    
    public static Account createFSWAccountData(){
        c2g__codaCompany__c fFcompany = BillingPaymentsTestFactory.createFfCompany('Test Company');
        insert fFcompany;
        Account fswAccount = new Account();
        fswAccount.Name = 'fswDealer';
        fswAccount.AccountNumber = 'Number1';
        fswAccount.RecordTypeId =  RecordTypeDAO.getRecordType('Dealer','Account').Id;
        fswAccount.Release_2_Quoting_Pilot__c = true;
        fswAccount.Type = System.Label.In_Network;
        fswAccount.ISFSW__c = true;
        fswAccount.BigMachines__Partner_Organization__c = 'dealers';
        fswAccount.BillingCity = 'Chicago';
        fswAccount.BillingStreet = 'Unit Test Street 1';
        fswAccount.BillingCountry = 'USA';
        fswAccount.BillingPostalCode = '60606';
        fswAccount.BillingState = 'AL';
        fswAccount.State__c = 'ALABAMA';
        fswAccount.DRAD__c = '12345678';
        fswAccount.FF_Company__c = fFcompany.Id;
        return fswAccount;
    }
    
    public static void createAmazonS3Settings() {
        Amazon_S3_Settings__c objAmazonS3Settings = new Amazon_S3_Settings__c(Access_Key__c = 'AccessKey', 
            Bucket_Name__c = 'BucketName', Region__c = 'Region', Secret_Key__c = 'Secret Key');
        insert objAmazonS3Settings;     
    }
    
    public static Service_Request__c createServiceRequest() {
        return (Service_Request__c)buildSObject( Service_Request__c.SObjectType, null );
    }
    
    public static Bid__c createBid() {
        return (Bid__c)buildSObject( Bid__c.SObjectType, null );
    }
    
    public static Review__c createReview() {
        return (Review__c)buildSObject( Review__c.SObjectType, null );
    }

    public static Communication_Job__c createCommunicationJob() {
        return (Communication_Job__c)buildSObject( Communication_Job__c.SObjectType, null );
    }

    public static China_States__c getCustomSettingOfChinaStates() {
        China_States__c chinaState = new China_States__c();
        chinaState.State__c = 'beijing';
        chinaState.Name = 'beijing';
        return chinaState;
    }
    
    public static Mulesoft_web_service_setting__c getCustomSettingOfMulesoftWebService() {
        Mulesoft_web_service_setting__c customSetting = new Mulesoft_web_service_setting__c();
        customSetting.Name =  'Mulesoft';
        customSetting.URL__c = 'testUrl';
        customSetting.Client_ID__c = 'testId';
        customSetting.Client_Secret__c = 'testSecret';
        customSetting.Time_Out__c = 2000;
        return customSetting;
    }

    public static Manufacturer_Group__c createManufacturerGroup(Id recordTypeId, String description) {
        Manufacturer_Group__c manufacturerGroup = new Manufacturer_Group__c();
        manufacturerGroup.Name = description;
        manufacturerGroup.RecordTypeId = recordTypeId;
        return manufacturerGroup;
    }
    
    public static Polygon__c createPolygon(Id recordTypeId) {
        Polygon__c polygon = new Polygon__c();
        polygon.RecordTypeId = recordTypeId;
        polygon.Northernmost__Latitude__s =3;
        polygon.Northernmost__Longitude__s =3;
        polygon.Southernmost__Latitude__s =1;
        polygon.Southernmost__Longitude__s =1;
        polygon.Easternmost__Latitude__s =3;
        polygon.Easternmost__Longitude__s =1;
        polygon.Westernmost__Latitude__s =1;
        polygon.Westernmost__Longitude__s =1;
        return polygon;
    }

    public static Point__c createPoint(Id recordTypeId, String name, Id polygonId, Double latitude, Double longitude) {
        Point__c point = new Point__c();
        point.Polygon__c = polygonId;
        point.Name = name;
        point.RecordTypeId = recordTypeId;
        point.Vertex_Location__Latitude__s = latitude;
        point.Vertex_Location__Longitude__s = longitude;
        return point;
    }
    
    public static China_Auto_Setting__c createChinaAutoSetting() {
        China_Auto_Setting__c newChinaAutoSetting = new China_Auto_Setting__c();
        newChinaAutoSetting.Currency_Code__c = 'CNY';
        newChinaAutoSetting.Complete_Refund_Days__c = 7;
        newChinaAutoSetting.Max_Customer_Cost__c = 999999.99;
        newChinaAutoSetting.Contract_Cancellation_Fee__c = 280; 
        newChinaAutoSetting.DCH_Affinity_Id__c = 'DCH';
        newChinaAutoSetting.TCAcceptance__c = true;
        newChinaAutoSetting.Split_String_Value__c = 'DCH';
        newChinaAutoSetting.DCH_Tax_Rate__c = 17;
        newChinaAutoSetting.FF_Company_Id__c = TWGTestFactory.getFakeId(c2g__codaCompany__c.sObjectType);
        return newChinaAutoSetting;
    }   
    
    public static RestRequest setRequestParameters(String methodType, String requestType){
        RestRequest request = new RestRequest();
        request.requestUri ='/services/apexrest/api/'+ requestType;
        request.httpMethod = methodType;
        request.addHeader('Content-Type', 'application/json'); 
        return request ;        
    }
    
    public static ContentVersion createContentVersion(){
        ContentVersion cv = new ContentVersion();
        return cv;
    }
    
    public static Id getProfileByName(List<String> names){
        List<Profile> profileList = [SELECT Id, Name FROM Profile WHERE Name IN: names];
        Id profileId;
        if(profileList != null && profileList.size() > 0) {            
            profileId = profileList[0].Id;
        }
        return profileId;
    }
    
    public static Dealer_Identification_Settings__c createPGMDealerIdentificationSettings(Account templateAcount){
        Dealer_Identification_Settings__c settings =  new Dealer_Identification_Settings__c();
        settings.name = 'PGM';
        settings.Account_Number_Type__c = 'PGM1';
        settings.Template_Account_ID__c = String.valueOf(templateAcount.Id);
        return settings;
    }

    public static Vehicle_INT__C createVehicleINT(String name, Id makeId) {
        Vehicle_INT__C vehicleINT = new Vehicle_INT__C();
        vehicleINT.Name = name;
        vehicleINT.Make_Code__c = makeId;
        vehicleINT.Source_System__c = 'GLGB';
        return vehicleINT;
    }
    
    public static Factory_Warranty__c createFactoryWarranty(Id makeId, Id vehicleId, Id manufacturerId) {
        Factory_Warranty__c factoryWarranty = new Factory_Warranty__c();
        factoryWarranty.Make_Code__c = makeId;
        factoryWarranty.Vehicle_Code__c = vehicleId;
        factoryWarranty.Manufacturer_Code__c = manufacturerId;
        return factoryWarranty;
    }    
    
    public static Tax_Liability_Code_Exceptions__c createTaxLiabilityException() {
        Tax_Liability_Code_Exceptions__c taxLiabilityCodeException = new Tax_Liability_Code_Exceptions__c();
        taxLiabilityCodeException.Name = TaxConstants.TAX_USE_CASE_CREATED_DATE;
        taxLiabilityCodeException.States_Comma_Separated__c = 'NC';
        return taxLiabilityCodeException;
    }

    public static Vehicle_INT__c createVehicleINTWIthMakeAndMfg(String VehicleCode,Make_INT__c makeCode, Manufacturer_INT__c mfgCode)
    {
        Vehicle_INT__c vCode = new Vehicle_INT__c();
        vCode.Name = 'Unit Test Vehicle Code';
        if(mfgCode != null){
            vCode.Manufacturer_Code__c = mfgCode.Id;
        }
        if(makeCode != null){
            vCode.Make_Code__c = makeCode.Id;
        }
        vCode.Manufacturer_Code_INT__c = 'SN';
        vCode.Make_Code_INT__c = 'CT';
        vCode.Make_Name__c = 'ARCTIC CAT';
        vCode.Vehicle_Code__c = VehicleCode;
        return vCode;
    }
    
    public static Reason_Code__c createReasonCodeForEU() {
        Reason_Code__c reasonCode = new Reason_Code__c();
        reasonCode.Code__c = 'EU_Part_not_listed';
        reasonCode.Denial_Reason__c ='EU_Part_not_listed';
        return reasonCode;
    }
    
    public static ReasonMessageValues__c customSettingReasonCodeForEU() {
        ReasonMessageValues__c configSetting = new ReasonMessageValues__c();
        configSetting.Name = 'EU_Part_not_listed';
        configSetting.Denial_Code__c = 'EU_Part_not_listed';
        configSetting.Reason_Message__c = 'Part not listed';
        return configSetting;
    }
    
    public static Account getAccountForForms(){
        account accountDetails =  new account();
        accountDetails.Id = TWGTestFactory.getFakeId(account.sObjectType);
        accountDetails.IsFSW__c = true;
        accountDetails.RDG_Nbr__c = 'Test334';
        accountDetails.accountNumber = 'Test334';
        accountDetails.Name = 'Test Account';
        accountDetails.BillingStreet = '2020 W North St';
        accountDetails.BillingPostalCode = '60016';
        accountDetails.BillingCity = 'Dallas';
        accountDetails.BillingState = 'Texas';
        accountDetails.BillingCountry = 'USA';
        accountDetails.Phone = '4335345464';
        accountDetails.Dealer_type__c = 'Purchase';
        return accountDetails;
    }

    public static Vehicle__c getVehicleForForms(){
        Vehicle__c vehicleDetails = new Vehicle__c();
        vehicleDetails.Make__c = 'TestMake';
        vehicleDetails.model_code__c = '23020';
        vehicleDetails.Year__c = '2017';
        vehicleDetails.in_service_date__c = Date.today();
        vehicleDetails.Vehicle_Is_For_Commerical_Use__c = false;
        vehicleDetails.VIN__c = '12345678901234567';
        return vehicleDetails;
    }

    public static Quote__c getQuoteForForms(){
        Quote__c quoteDetails =  new Quote__c();
        quoteDetails.Id = TWGTestFactory.getFakeId(Quote__c.sObjectType);
        quoteDetails.First_Name__c = 'TestCustomerFirst';
        quoteDetails.Last_Name__c = 'TestCustomerLast';
        quoteDetails.Address_Line_1__c = '2000 W North St';
        quoteDetails.Co_First_Name__c = 'TestCoFirst';
        quoteDetails.Co_Last_Name__c = 'TestCoLast';
        quoteDetails.Address_Line_1_CoBuyer__c = '2000 W North St';
        quoteDetails.City_CoBuyer__c = 'Dallas';
        quoteDetails.State_CoBuyer__c = 'Texas';
        quoteDetails.State__c = 'Texas';
        quoteDetails.Zipcode__c = '60016'; 
        quoteDetails.Zip_CoBuyer__c = '60016';
        quoteDetails.Country__c = 'USA';
        quoteDetails.Mobile_Phone__c = '2424243253';
        quoteDetails.Co_Phone_Number__c = '2424245253';
        quoteDetails.Dealer_Lienholder_Name__c = 'TestLienholderName';
        quoteDetails.Dealer_Leinholder_Address__c = '2002 W North St';
        quoteDetails.City_Lienholder__c = 'Dallas';
        quoteDetails.State_Lienholder__c = 'Texas';
        quoteDetails.LienHolder_Phone__c = '4335345464';
        quoteDetails.financeAmount_INT_WSDL__c = 30000;
        quoteDetails.firstPaymentDate_INT_WSDL__c = system.today();
        return quoteDetails;
    }
    
    public static TWG_Product__c getTwgProductForForms(){
        TWG_Product__c twgProduct = new TWG_Product__c(Id= TWGTestFactory.getFakeId(TWG_Product__c.sObjectType),
            Name = 'Test Base Product',Product_Code__c = 'PCODE'+getRandomString(),
            Product_Type__c = 'W - Service Contract',Product_Start_Date__c = System.now(),
            Channel__c = 'Resource',Country_Code__c = 'US / USA',Client_Type_Distribution_Channel__c = 'Dealer',
            Product_Description__c = 'For testing',Vehicle_Group_ID__c = 'VGI0001',
            UW_Insurance_Rate_Code__c = 'TESTING1234',UW_TWG_Fees_Rate_Code__c = 'TESTING1234');
            
        return twgProduct;
    }
    
    public static Dealer_Product__c getDealerProductForForms(){
        TWG_Product__c twgProduct = getTwgProductForForms();
        account accountDetails = getAccountForForms();
        Dealer_Product__c dealerProduct = new Dealer_Product__c(Id= TWGTestFactory.getFakeId(Dealer_Product__c.sObjectType),Account__c = accountDetails.Id,ProductTypeName_INT__c = 'Test Dealer Product', TWG_Product__c = twgProduct.Id,Product_Class__c = '06 New Only',Requested_Start_Date__c = System.today(),Start_Date__c = System.today(),Parent_Sort_Order__c=0);
        dealerProduct.TWG_Product__r = twgProduct;
        return dealerProduct;   
    }
    
    public static Quote_Dealer_Product__c getQuoteDealerProductForForms(){
        Quote__c quote = getQuoteForForms();
        Dealer_Product__c dealerProduct = getDealerProductForForms();
        Quote_Dealer_Product__c quoteDealerProduct = new Quote_Dealer_Product__c ();
        quoteDealerProduct.dealer_Product__c = dealerProduct.Id;
        quoteDealerProduct.Deductible_Amount__c = 100;
        quoteDealerProduct.Customer_Cost__c = 150;
        quoteDealerProduct.Quote__c = quote.Id;
        quoteDealerProduct.dealer_Product__r = dealerProduct;
        quoteDealerProduct.quote__r = quote;
        return quoteDealerProduct;
    }
    
    public static Mulesoft_web_service_setting__c createMuleSoftSpringCMFormsSettings(){
        Mulesoft_web_service_setting__c muleSoftSetting =  new Mulesoft_web_service_setting__c();
        muleSoftSetting.name='Mulesoft Forms';
        muleSoftSetting.Client_ID__c='clientID';
        muleSoftSetting.Client_Secret__c='ClientSecret';
        muleSoftSetting.URL__c = 'https://www.testconnection.thewg.com';
        muleSoftSetting.Time_Out__c = 10000;
        return muleSoftSetting;
    }

    public static APAC_Auto_Documents__c createAPACAutoDocumentSettings(String name) {
        APAC_Auto_Documents__c apacAutoDocumentSetting = new APAC_Auto_Documents__c();
        apacAutoDocumentSetting.Name = name;
        apacAutoDocumentSetting.TermDocumentId__c = 'test';
        apacAutoDocumentSetting.NoticeDocumentId__c = 'test';
        apacAutoDocumentSetting.MSADocumentId__c = 'test';
        return apacAutoDocumentSetting;
    }    
    
    public static PermissionSet createAndInsertPermissionSet() {
        PermissionSet permissionSet = new PermissionSet();
        permissionSet.Label='Test Permisson Set';
        permissionSet.Name='Test_Permisson_Set';
        permissionSet.PermissionsViewEncryptedData = true;
        insert permissionSet;
        return permissionSet;
    }
    
    public static PermissionSetAssignment createPermissionSetAssignment(Id assigneeId, Id permissionSetId) {
        PermissionSetAssignment permissionSetAssignmentInstance = new PermissionSetAssignment();
        permissionSetAssignmentInstance.AssigneeId = assigneeId;
        permissionSetAssignmentInstance.PermissionSetId = permissionSetId;
        return permissionSetAssignmentInstance;
    }
    
    public static Pricebook2 createPriceBook(){
        Pricebook2 book  = new Pricebook2();
        book.Name = 'Single Rate - TWG';
        book.IsActive = true;
        return book;
    }
    
    public static PricebookEntry createPricebookEntry(Id product2Id, Id pricebook2Id){
        PricebookEntry pricebookEntryRecord = new PricebookEntry();
        pricebookEntryRecord.IsActive = true;
        pricebookEntryRecord.UnitPrice = 12000.0;
        pricebookEntryRecord.product2id = product2Id;
        pricebookEntryRecord.pricebook2Id = pricebook2Id;
        return pricebookEntryRecord;
    }

    public static Contract_Mass_Rerate_Setting__c getContractMassRerateDefaultCustomSetting() {
        Contract_Mass_Rerate_Setting__c massRerateSetting = Contract_Mass_Rerate_Setting__c.getOrgDefaults();
        massRerateSetting.Batch_Scope__c = 50;
        massRerateSetting.Maximum_Contracts_Limit__c = 2000;
        return massRerateSetting;
    }
    
    public static WorkOrder createWorkOrder(){
        WorkOrder workOrderRecord = new WorkOrder();
        workOrderRecord.Description = 'WorkOrder';
        return workOrderRecord;
    }
    
    public static WorkOrderLineItem createWorkOrderLineItem(){
        WorkOrderLineItem workOrderLineRecord = new WorkOrderLineItem();
        workOrderLineRecord.Description = 'Work Order Line Item';
        return workOrderLineRecord;
    }

    public static Account createNMIVendorAccount()
    {
        Account objVendorAccount = TWGTestFactory.createAccount();
        objVendorAccount.Name = 'testAcc';
        objVendorAccount.recordTypeId = RecordTypeDAO.getRecordTypeId('NM_Vendor', 'Account');  
        objVendorAccount.ServiceGeoFencing__c = 1000;
        objVendorAccount.BillingCity = 'Chicago';
        objVendorAccount.BillingState = 'IL';
        objVendorAccount.BillingCountry = 'USA';
        objVendorAccount.BillingPostalCode = '60601';
        objVendorAccount.Type = 'Vendor';
        objVendorAccount.ServiceCapabilities__c = 'Chandlery';
        return objVendorAccount;
    }
    
    public static GLOW_r1_Constants__c createGLOWConst(){
        GLOW_r1_Constants__c qConstants = new GLOW_r1_Constants__c();
        qConstants.Contract_Prefix__c = 'SQ';
        qConstants.Calling_App_ID__c = 'Test';
        return qConstants;
    }
    
    public static Make_INT__c  createMakeInt(){
        Make_INT__c mkint = new Make_INT__c();
        mkint.Code__c = 'QA';
        mkint.DataSyncTransaction_ID__c = '123456';
        mkint.Delete_Flag__c = 'F';
        mkint.Manufacturer_Code__c = '123';
        mkint.Name__c = 'Test';  
        mkint.Name = 'test';
        mkint.Make_Name_Alias__c = 'Test';
        mkint.Special_ID__c = '123450';
        return mkint;
    }
    
    public static Manufacturer_INT__c createManInt(){
        Manufacturer_INT__c mfint = new Manufacturer_INT__c();
        mfint.Code__c = 'QS';
        mfint.DataSyncTransaction_ID__c = '1234';
        mfint.Delete_Flag__c = 'F';
        mfint.Manufacturer_Name__c = 'Test';
        mfint.Special_ID__c = '09876';
        mfint.Name = 'test';
        return mfint;
    }
    
    public static Vehicle_INT__c createvehInt(List<Manufacturer_INT__c> manufacturerINTList, List<Make_INT__c> makeINTList){ 
        Vehicle_INT__c vint = new Vehicle_INT__c();
        vint.Make_Code__c = makeINTList[0].id;
        vint.Manufacturer_Code__c = manufacturerINTList[0].id;
        vint.Vehicle_Code__c = '';
        vint.Name = 'Test';
        return vint;  
    }
    
    public static TWG_Product__c createTWGProd(RecordType rtTWG,String prodType){
        TWG_Product__c twgProd = new TWG_Product__c();
        twgProd.Channel__c = 'Resource';
        twgProd.Client_Type_Distribution_Channel__c = 'Dealer';
        twgProd.Country_Code__c = 'US / USA';
        twgProd.Name = 'TEST';
        twgprod.Product_Code__c = 'TEST';
        twgProd.Product_Description__c = '14 MAO';
        twgProd.Product_Start_Date__c = System.now();
        twgProd.Product_Type__c = prodType;
        twgProd.RecordTypeId = rtTWG.Id;
        twgProd.UW_Insurance_Rate_Code__c = '20140521_CRF_MAO_W_SHELF_RA_AUTO';
        twgProd.Vehicle_Group_ID__c = 'VGI0010';
        return twgProd;
    }
    
    public static Elimination_Period__c InsertElim(TWG_Product__c  twgProd){
        Elimination_Period__c elimPeriod = new  Elimination_Period__c(Elimination_Hours__c='12',
                                               Elimination_Months__c=12, 
                                               Expiration_Type__c='AOM - Miles only Add-on', 
                                               Spec_Coverage__c='Gold', TWG_Product__c= twgProd.Id);
        return elimPeriod;
    }
    
    public static State_Specific_Settings__c InsertspeSet(TWG_Product__c  twgProd){
        State_Specific_Settings__c stateSpecific = new State_Specific_Settings__c(TWG_Product__c = twgProd.Id, 
                                                       Accounting_Group__c = 'D300 - Service Contract', State__c = 'Alaska', 
                                                       Reporting_Class_Segment_Code__c = '12SD - Sound Group');
        return stateSpecific;
    }
    
    public static Account getObligorAccount(){
        Account obligorAccount = new Account();
        obligorAccount.RecordTypeId = RecordTypeDAO.getRecordTypeId(AccountConstants.RECORD_TYPE_NON_DEALER,
            AccountConstants.ACCOUNT_SOBJECT_API_NAME);
        obligorAccount.Name = 'CC';
        obligorAccount.Type = 'Obligor';
        obligorAccount.Obligor_code__c = 'C';
        return obligorAccount;
    }

    public static List<Case> getMockCasesForSurveyDate(){
        Id specialtyRTId = RecordTypeDAO.getCaseRecordTypeID(System.Label.SpecialtyClaimRT);

        Card_Account__c cprCardAccount = new Card_Account__c();
        cprCardAccount.Id = TWGTestFactory.getFakeId(Card_Account__c.sObjectType);
        cprCardAccount.Last_CPR_Denial_Survey_Sent_Date__c = Date.today().addDays(-31);

        Card_Account__c rpCardAccount = new Card_Account__c();
        rpCardAccount.Id = TWGTestFactory.getFakeId(Card_Account__c.sObjectType);
        rpCardAccount.Last_Non_CPR_Denial_Survey_Sent_Date__c = Date.today().addDays(-31);

        Card_Account__c wtaiCardAccount = new Card_Account__c();
        wtaiCardAccount.Id = TWGTestFactory.getFakeId(Card_Account__c.sObjectType);
        wtaiCardAccount.Last_Non_CPR_Denial_Survey_Sent_Date__c = Date.today().addDays(-31);

        Case caseSpecialtyRP = new Case();
        caseSpecialtyRP.Card_Account__r = rpCardAccount;
        caseSpecialtyRP.Card_Account__c = rpCardAccount.Id;
        caseSpecialtyRP.Preferred_Method_of_Payment__c = System.Label.Check;
        caseSpecialtyRP.Preferred_Method_of_Communication__c = System.Label.Email;
        caseSpecialtyRP.Preferred_Language_of_Communication__c = System.Label.English;
        caseSpecialtyRP.Id = TWGTestFactory.getFakeId(Case.sObjectType);
        caseSpecialtyRP.Claim_Payment_Amount__c = 200;
        caseSpecialtyRP.status = System.Label.Closed_Denied;
        caseSpecialtyRP.Last_Status_Changed_Date__c = Date.today().addDays(-9);
        caseSpecialtyRP.Benefit_Name__c = System.Label.RPSpace;

        Case caseSpecialtyCPR = new Case();
        caseSpecialtyRP.Card_Account__r = cprCardAccount;
        caseSpecialtyRP.Card_Account__c = cprCardAccount.Id;
        caseSpecialtyCPR.Preferred_Method_of_Payment__c = System.Label.Check;
        caseSpecialtyCPR.Preferred_Method_of_Communication__c = System.Label.Email;
        caseSpecialtyCPR.Preferred_Language_of_Communication__c = System.Label.English;
        caseSpecialtyCPR.Id = TWGTestFactory.getFakeId(Case.sObjectType);
        caseSpecialtyCPR.Claim_Payment_Amount__c = 200;
        caseSpecialtyCPR.status = System.Label.Closed_Denied;
        caseSpecialtyCPR.Last_Status_Changed_Date__c = Date.today().addDays(-31);
        caseSpecialtyCPR.Benefit_Name__c = System.Label.Citi_Price_Rewind;

        Case caseSpecialtyWTAI = new Case();
        caseSpecialtyWTAI.Card_Account__r = wtaiCardAccount;
        caseSpecialtyWTAI.Card_Account__c = wtaiCardAccount.Id;
        caseSpecialtyWTAI.Preferred_Method_of_Payment__c = System.Label.Check;
        caseSpecialtyWTAI.Preferred_Method_of_Communication__c = System.Label.Email;
        caseSpecialtyWTAI.Preferred_Language_of_Communication__c = System.Label.English;
        caseSpecialtyWTAI.Id = TWGTestFactory.getFakeId(Case.sObjectType);
        caseSpecialtyWTAI.Claim_Payment_Amount__c = 200;
        caseSpecialtyWTAI.status = System.Label.Closed_Denied;
        caseSpecialtyWTAI.Last_Status_Changed_Date__c = Date.today().addDays(-9);
        caseSpecialtyWTAI.Benefit_Name__c = System.Label.WTAISpace;

        return new List<Case>{caseSpecialtyRP, caseSpecialtyCPR, caseSpecialtyWTAI};
    }

    public static Contract__c getUSCPMContract() {
        RecordType rt = RecordTypeDAO.getRecordType(ContractConstants.MECHANICAL_RECORD_TYPE_NAME, 'Contract__c');
        Contract__c theContract = new Contract__c(
            Name = 'TEST0000',
            RecordTypeId = rt.Id,
            Contract_Start_Date__c = Date.today(),
            Contract_End_Date__c = Date.today().addYears(5),
            Status__c = ContractConstants.ACTIVE_STATUS,
            Premium_Location_Code_INT__c = 'C',
            Spec_Coverage_Plan_Code__c = 'Premium',
            AgmtDTL_Type_INT__c = 'WAR',
            Holder_First_Name_INT__c = 'Joe',
            Holder_Middle_Init_INT__c = 'A',
            Holder_Last_Name_INT__c = 'Smith',
            Holder_Address_1_INT__c = '123 Main St',
            Holder_City_INT__c = 'Chicago',
            Holder_State_Province_INT__c = 'IL',
            Holder_Postal_Code_INT__c = '60614',
            Holder_Country_Code_INT__c = 'USA',
            Customer_Phone__c = '(312) 222-3333',
            Customer_Phone_2__c = '(312) 222-3334',
            Mobile_Phone__c = '(312) 222-3335',
            EFT_Customer_Email_1_INT__c = 'joe.smith@test.com',
            Co_First_Name__c = 'Jane',
            Co_Middle_Initial__c = 'A',
            Co_Last_Name__c = 'Smith',
            Address_Line_1_CoBuyer__c = '123 Main St',
            City_CoBuyer__c = 'Chicago',
            State_CoBuyer__c = 'IL',
            Zip_CoBuyer__c = '60614',
            Country_CoBuyer__c = 'USA',
            Co_Phone_Number__c = '(312) 222-3333',
            Co_Work_Number__c = '(312) 222-3334',
            Mobile_Phone_cobuyer__c = '(312) 222-3335',
            EFT_Customer_Email_2_INT__c = 'jne.smith@test.com',
            Vehicle_Previously__c = true,
            System_Pin__c = 'TEST01234', 
            Dealer_Lienholder_Name__c = 'Big Bank',
            EFT_Lender_Nbr_INT__c = 'TEST01234',
            EFT_Lender_Account_INT__c = 'TEST01234',
            Dealer_Lienholder_Address__c = '124 Main St',
            City_Lienholder__c = 'Chicago',
            State_Lienholder__c = 'IL',
            Zip_Lienholder__c = '60614',
            Country_Lienholder__c = 'USA',
            LienHolder_Phone__c= '(312) 222-2222',
            Lienholder_PhoneType__c = 'Work',
            EFT_finance_Type__c = 'Cash',
            First_Payment_Date__c = Date.today(),
            EFT_Annual_Prct_Rate_INT__c = '',
            FinanceAmount_INT_WSDL__c = 0,
            Terms__c = 0,
            EFT_GAP_Loan_Amt_INT__c = 0,
            Monthly_Payment__c = 0,
            Purchase_Price__c = 0,
            MSRP__c = 0,
            NADA_Value__c = 0,
            Money_Factor__c = 0,
            AgmDetailType__c = 'WAR',
            Deal_Number__c = 'TEST4321',
            Billing_State__c = 'IL',
            Year__c = '2016',
            In_Service_Date_INT__c = Date.today().addYears(-1),
            Odometer_Mileage_at_Purchase__c = 2000,
            Vehicle_Code__c = '23223',
            VIN__c = '19UDE2F82GA000762',
            Commercial_Usage__c = 'Y',
            Make__c = 'Acura',
            Model__c = 'ILX',
            CoveragePlanCode__c = 'PLT200',
            CoverageName_INT_WSDL__c = 'PLATINUM',
            Terms_Months_INT__c = 60,
            Terms_Miles_INT__c = 60000,
            Form_Deductible_Amt__c = 100,
            Disappearingdeduct_INT_WSDL__c = 'N',
            Agmt_Form_Number_INT__c = 'AWS281CT0505',
            Total_Of_Payments__c = 0,
            Apr__c = 0,
            EFT_Resid_Ballon_Amt_INT__c = '',
            LeaseCapAmount_INT_WSDL__c= 0,
            Total_Administrative_Fee__c = 71.0,
            Total_Agent_Fee__c = 0,
            Total_Billed_Cost__c = 317.0,
            Total_Client_Fee__c = 0,
            Total_Corporate_Fee__c = 0,
            Customer_Cost__c = 317.0,
            Total_Dealer_Commission__c = 0,
            Total_Dealer_Cost__c = 317.0,
            Total_F_I_Commission__c = 0,
            Total_Incentives__c = 0,
            Total_Insurance_Premium__c = 159.0,
            Total_Internal_Pack__c = 0,
            Total_Reserve__c = 159.0,
            Total_Marketing_Fee__c = 84.0,
            Total_Loss_Fund__c = 0,
            Total_Retail_cost__c = 317.0,
            Total_Risk_Fee__c = 0,
            Total_Tax_Allocation__c = 0,
            Total_Vendor_Fee__c = 3.0,
            Total_TWG_Fees__c = 158.0,
            Admin_Company_Code__c = 'AD1',
            Writing_Company__c = 'WR'
        );
        return theContract; 
    }

    public static Contract__c createUSCPMContract() {
        c2g__codaCompany__c ffCompany = getCompanyByName('Test Company');
        
        Account a = createAccount_CPM();
        a.Release_2_Quoting_Pilot__c = true;
        a.BigMachines__Partner_Organization__c = 'dealers';
        a.ISFSW__c = true;
        a.FF_Company__c = fFcompany.Id;
        insert a;

        TWG_Product__c baseProd = createTWGProduct();
        Dealer_Product__c dp = createDealerProduct(a, baseProd);

        Quote__c quote = createQuote(a);
        Quote_Dealer_Product__c qdp = createQuoteDealerProduct(dp, quote);

        Vehicle__c veh = createVehicle();
        insert veh;

        Contract__c c = getUSCPMContract();
        c.Vehicle__c = veh.Id;
        c.Quote_Dealer_Product__c = qdp.Id;
        c.EFT_Dealer_Product__c = dp.Id;
        c.Auto_Dealer_Product__c = dp.Id;
        c.Account_Name__c = a.Id;
        insert c;

        return c;
    }

    public static c2g__codaCompany__c getCompanyByName(String companyName) {
        return [SELECT Id FROM c2g__codaCompany__c WHERE Name =: companyName LIMIT 1];
    }

    public static c2g__codaAccountingCurrency__c getAccountingCurrencyByName(String currencyName){
        return [SELECT Id
                FROM c2g__codaAccountingCurrency__c
                WHERE Name = :currencyName
                LIMIT 1];
    }
    
    public static CaseExt__c createCaseExt(){
        CaseExt__c caseExt = new CaseExt__c();
        caseExt.Replacement_Make__c = 'Test Make';
        caseExt.Replacement_Model__c = 'Test Model';
        return caseExt;
    }

    public static Contract__c createFEFSWContract() {        
        Account account = TWGTestFactory.createFSWAccount();

        TWG_Product__c baseProd = CPM_util_TestUtils.createTWGProductFE();
        Dealer_Product__c dealerProduct = TWGTestFactory.createDealerProductFEAdminOnly(account, baseProd);
        dealerProduct.Print_Id_Card__c =true;
        update dealerProduct;

        Quote__c quote = CPM_util_TestUtils.createQuote(account);
        Quote_Dealer_Product__c quoteDealerProduct = CPM_util_TestUtils.createQuoteDealerProduct(dealerProduct, quote);

        Vehicle__c vehicle = CPM_util_TestUtils.createVehicle();
        insert vehicle;

        Contract__c contract = getUSCPMContract();
        contract.Name = 'TESTFEFSW1';
        contract.Vehicle__c = vehicle.Id;
        contract.Quote_Dealer_Product__c = quoteDealerProduct.Id;
        contract.Account_Name__c = account.Id;
        contract.Auto_Dealer_Product__c = dealerProduct.Id;

        return contract;
    }
    
    public static Contract__c populateTheTotalTaxFieldsOfContractEU() {
        RecordType recordType = RecordTypeDAO.getRecordType(ContractConstants.MECHANICAL_EU_RECORD_TYPE_NAME, 'Contract__c');
        Contract__c theContract = new Contract__c(Name = 'TEST0000EU', RecordTypeId = recordType.Id, Contract_Start_Date__c = Date.today(),
            Contract_End_Date__c = Date.today().addYears(5), Total_Administrative_Fee__c = 200.00, Total_Agent_Fee__c = 10.00, 
            Total_Billed_Cost__c =  235.00, Total_Client_Fee__c  = 235.00, Total_Corporate_Fee__c = 45.00, 
            Total_Dealer_Commission__c = 34.00, Total_Dealer_Cost__c = 56.00, Total_F_I_Commission__c = 34.00,
            Total_Incentives__c = 45.00, Total_Insurance_Premium__c = 20.00, Total_Internal_Pack__c = 23.00, 
            Total_Reserve__c = 12.00, Total_Marketing_Fee__c = 89.00, Total_Loss_Fund__c = 34.00, Total_Retail_cost__c = 45.00 , 
            Total_Risk_Fee__c  = 45.00, Total_Tax_Allocation__c = 67.00, Total_Vendor_Fee__c = 128.00,
            Total_TWG_Fees__c = 28.00, Total_Escrow_Fee__c = 56.00,Reported_Customer_Cost_INT__c=317.0, 
            Tax_Admin_Fee__c=120.00, Tax_Agent_Fee__c=100.00, Tax_Client_Fee__c=12.00, Tax_Corporate_Fee__c=12.00, 
            Tax_Dealer_Comm__c=10.00, Tax_Escrow_Fee__c=12.00, Tax_F_I_Comm__c=11.00,
            Tax_Internal_Pack_Fee__c=10.00, Tax_Marketing_Fee__c=11.00, Tax_Rate_Above_Net__c=12.00, Tax_Rate_Admin_Fee__c=14.00,
            Tax_Rate_Agent_Fee__c=12.00, Tax_Rate_Below_Net__c=11.00, Tax_Rate_Client_Fee__c=11.00, Tax_Rate_Corporate_Fee__c=12.00,
            Tax_Rate_Dealer_Comm__c=12.00, Tax_Rate_Escrow_Fee__c=12.00, Tax_Rate_F_I_Comm__c=12.00, Tax_Rate_Internal_Pack_Fee__c=12.00,
            Tax_Rate_IP__c=11.00, Tax_Rate_Marketing_Fee__c=10.00, Tax_Rate_Reserve__c=11.00, Tax_Rate_Risk_Fee__c=11.0, 
            Tax_Rate_Stop_Loss_Fee__c =11.00, Tax_Rate_TWG_Fee__c=12.00, Tax_Rate_Vendor_Fee__c=12.00, Tax_Reserve__c=12.00, 
            Tax_Risk_Fee__c=12.00, Tax_Stop_Loss__c=11.00, Tax_TWG_Fee__c=12.00,  Tax_Type_Admin_Fee__c='10', 
            Tax_Type_Agent_Fee__c='10', Tax_Type_Client_Fee__c='10', Tax_Type_Marketing_Fee__c='10', Tax_Type_Stop_Loss__c='10', 
            Tax_Type_Vendor_Fee__c='10', Tax_Vendor_Fee__c=10, Total_Retail_Amount__c=10.00, 
            Total_Stop_Loss__c=10.00, Total_Tax_Below_Net__c=10.00, Total_Tax_IP__c=10.00);
        return theContract;
    }

    public static Contract_Reporting_State_Rule__c createReportingStateRule(){
        Contract_Reporting_State_Rule__c testRule = new Contract_Reporting_State_Rule__c();
        testRule.State__c = ContractConstants.DEALER_STATE;
        testRule.Start_Date__c = Date.today().addDays(-5);
        testRule.Id = TWGTestFactory.getFakeId(Contract_Reporting_State_Rule__c.sObjectType);
        testRule.Writing_Company__c = TWGTestFactory.getFakeId(Account.sObjectType);
        return testRule;
    }
    
    public static Contract_Reporting_State_Assignment__c createReportingStateAssignment(Id ruleId, String state){
        Contract_Reporting_State_Assignment__c assignment = new Contract_Reporting_State_Assignment__c();
        assignment.Reporting_State_Rule__c = ruleId;
        assignment.State__c = state;
        assignment.Override_State__c = 'AK';
        return assignment;
    }
    
    public static void setupAllAccess() {
        PermissionSet ps = new PermissionSet();
        ps.Name = 'ContractAdminPermissionsTest';
        ps.Label = 'ContractAdminPermissionsTest';
        insert ps;

        List<SetupEntityAccess> access = new List<SetupEntityAccess>();
        List<CustomPermission> permissions = [SELECT Id, DeveloperName FROM CustomPermission WHERE DeveloperName in :ContractAdminAccessManager.permissionList];
        for (CustomPermission cp : permissions) {
            SetupEntityAccess sea = new SetupEntityAccess();
            sea.ParentId = ps.Id;
            sea.SetupEntityId = cp.Id;
            access.add(sea);
        }
        insert access;

        PermissionSetAssignment psa = new PermissionSetAssignment();
        psa.AssigneeId = UserInfo.getUserId();
        psa.PermissionSetId = ps.Id;
        insert psa;
    }

    public static Auto_Repair_Facility__c createAutoRepairFacilities()
    {
        Auto_Repair_Facility__c testFacility = new Auto_Repair_Facility__c();
        testFacility.Brand__c = 'AutoCar';
        testFacility.Address__c = '222 main st';
        testFacility.State__c = 'AL';
        testFacility.Client_Id__c = Label.AutoRepairClientCarvana;
        return testFacility;
    }

    public static ReinsuranceSeries__c createReinsuranceSeries(){
        ReinsuranceSeries__c reinsuranceSeries = new ReinsuranceSeries__c();
        reinsuranceSeries.Name = 'S';
        reinsuranceSeries.Series_Description__c = 'test';
        return reinsuranceSeries;
    }
    
    public static ReinsuranceSeriesShareholders__c createReinsuranceSeriesShareholders(){
        ReinsuranceSeriesShareholders__c reinsuranceSeriesShareholders = new ReinsuranceSeriesShareholders__c();
        reinsuranceSeriesShareholders.Name = 'ABC';
        reinsuranceSeriesShareholders.Shareholder__c = 'test';
        return reinsuranceSeriesShareholders;
    }
    
    public static Configuration_Steps__c createEuropeConfigSettingsForFullRefundReasons() {
        Configuration_Steps__c configSettings = new Configuration_Steps__c();
        configSettings.Name = ContractConstants.CONTRACT_FULL_REFUND_REASON;
        configSettings.Contract_Payment_Method__c = Label.Mis_Sold + ';' + Label.Contract_Admin_Duplicate_Contract;
        return configSettings;
    }  
    
    public static Inspection_Feedback__C createInspectionFeedback()
    {
        Inspection_Feedback__C inspectionFeedback = new Inspection_Feedback__C();
        return inspectionFeedback;
    }
    
    public static ServiceAppointment  createServiceAppointment(){
        ServiceAppointment serviceAppointmentRecord = new ServiceAppointment ();
        serviceAppointmentRecord.Description = 'ServiceAppointment ';
        return serviceAppointmentRecord;
    }

    public static NADA_Settings__c createNADASetting()
    {
        NADA_Settings__c nadaSettings = new NADA_Settings__c();
        nadaSettings.Username__c = 'Username';
        nadaSettings.Password__c = 'Password';
        nadaSettings.Name = 'GAP';
        return nadaSettings;
    }

    public static VSP_SSP_Service__c createVSPSSPService(String name, String serviceType, Integer serviceIntervalInMonths,
        String description, String recordType, String currencyIsoCode, Id vehicleIntId) {
        VSP_SSP_Service__c vspSspService = new VSP_SSP_Service__c();
        vspSspService.Name = name;
        vspSspService.Service_Type__c = serviceType;
        vspSspService.Service_Interval_In_Months__c = serviceIntervalInMonths;
        vspSspService.RecordTypeId = RecordTypeDAO.getRecordTypeId(recordType , 'VSP_SSP_Service__c');
        vspSspService.Description__c = description;
        vspSspService.CurrencyIsoCode = currencyIsoCode;
        vspSspService.Vehicle__c = vehicleIntId;
        vspSspService.Service_Interval__c = 20000;
        return vspSspService;
    }

    public static Special_Offers__c createSpecialOfferRecord() {
        Special_Offers__c testSpecialRecord = new Special_Offers__c();
        return testSpecialRecord;
    }
    
    public static Dealers_Special_Offer__c createDealerSpecialOfferRecord(Special_Offers__c testSpecialRecord) {
        Dealers_Special_Offer__c testDealerSpecialOfferRecord = new Dealers_Special_Offer__c();
        testDealerSpecialOfferRecord.Special_Offer_Code__c = testSpecialRecord.Id;
        return testDealerSpecialOfferRecord;
    }

    public static Dealers_Special_Offer_Rate__c createDealerSpecialOfferRateRecord(Dealers_Special_Offer__c testDealerSpecialOfferRecord) {
        Dealers_Special_Offer_Rate__c testDealerSpecialOfferRateRecord = new Dealers_Special_Offer_Rate__c();
        testDealerSpecialOfferRateRecord.RecordTypeId =  RecordTypeDAO.getRecordType('FRP','Dealers_Special_Offer_Rate__c').Id;
        testDealerSpecialOfferRateRecord.Fluid_Price__c = 15;
        testDealerSpecialOfferRateRecord.Dealers_Special_Offer_Code__c = testDealerSpecialOfferRecord.Id;
        testDealerSpecialOfferRateRecord.Fluid_Code_Description__c = 'Engine oil cost per Ltr (Petrol)';
        return testDealerSpecialOfferRateRecord;
    }
    
    public static Fluid_Capacity__c createFluidCapacityRecord( Vehicle_INT__c vCode) {
        Fluid_Capacity__c testFluidCapacityRecord = new Fluid_Capacity__c();
        testFluidCapacityRecord.Name = 'FC-00001';
        testFluidCapacityRecord.Antifreeze_Capacity__c = 2;
        testFluidCapacityRecord.Auto_Gear_Box_Fluid__c = 2;
        testFluidCapacityRecord.Brake_Fluid_Capacity__c = 4;
        testFluidCapacityRecord.Differential_Oil_Capacity__c = 5;
        testFluidCapacityRecord.Engine_Oil_Capacity__c = 5;
        testFluidCapacityRecord.Fluid_Code__c = 'FC-00001';
        testFluidCapacityRecord.Gear_Box_Oil_Capacity__c = 5;
        testFluidCapacityRecord.Vehicle_INT__c = vCode.Id;
        return testFluidCapacityRecord;
    }
    
    public static ServicePlanWrapper createServicePlanWrapperInstance(){
        ServicePlanWrapper servicePlanWrapper = new ServicePlanWrapper();
        return servicePlanWrapper;
    }
    
    public static ServicePlanWrapper.ServiceEventsWrapper createServiceEventsWrapperInstance(VSP_SSP_Service__c vspSspService,
        Decimal serviceCost){
            
        ServicePlanWrapper.ServiceEventsWrapper serviceEventsWrapper = new ServicePlanWrapper.ServiceEventsWrapper();
        serviceEventsWrapper.vspSspService = vspSspService;
        serviceEventsWrapper.serviceCost = serviceCost;
        serviceEventsWrapper.fluidCost = 0;
        serviceEventsWrapper.monthInterval = 12;
        return serviceEventsWrapper;
    }
    
    public static VSP_SSP_Service__c setRatesField(VSP_SSP_Service__c vspSspService, Boolean isEngineOil, Boolean isGearOil, 
        Boolean isDifferentialOil, Boolean isBrakeFluidOil, Decimal serviceDuration){
            
        vspSspService.Is_Engine_Oil__c = isEngineOil;
        vspSspService.Is_Gear_Oil__c = isGearOil;
        vspSspService.Is_Differential_Oil__c = isDifferentialOil;
        vspSspService.Is_Brake_Oil_Fluid__c = isBrakeFluidOil;
        vspSspService.Service_Duration__c = serviceDuration;
        return vspSspService;
    }

    public static Dealers_Special_Offer_Rate__c createDealerSpecialOfferRateRecord(Id recordTypeId, String inflationCode, 
        Decimal inflationRate)
    {
        Dealers_Special_Offer_Rate__c dealerSpecialOfferRate = new Dealers_Special_Offer_Rate__c();
        dealerSpecialOfferRate.Id = TWGTestFactory.getFakeId(Dealers_Special_Offer_Rate__c.sObjectType);
        dealerSpecialOfferRate.RecordTypeId = recordTypeId;
        dealerSpecialOfferRate.Inflation_Number_Code__c = inflationCode;
        dealerSpecialOfferRate.Inflation_Rate__c = inflationRate;
        return dealerSpecialOfferRate;
    }

    public static Dealers_Special_Offer_Rate__c createDealerSpecialOfferRateRecordForFRP(Id recordTypeId, Decimal fluidPrice)
    {
        Dealers_Special_Offer_Rate__c dealerSpecialOfferRate = new Dealers_Special_Offer_Rate__c();
        dealerSpecialOfferRate.Id = TWGTestFactory.getFakeId(Dealers_Special_Offer_Rate__c.sObjectType);
        dealerSpecialOfferRate.RecordTypeId = recordTypeId;
        dealerSpecialOfferRate.Fluid_Price__c = fluidPrice;
        return dealerSpecialOfferRate;
    }
    
    public static Manual_Adjustment__c createManualAdjustment(Id caseExtId)
    {
        Manual_Adjustment__c testAdjustment = new Manual_Adjustment__c();
        testAdjustment.CaseExt__c = caseExtId;
        return testAdjustment;
    }
    
    public static Vehicle_INT__c createVehicleINT() {
        Vehicle_INT__c vehicle = new Vehicle_INT__c();
        vehicle.Id = TWGTestFactory.getFakeId(Vehicle_INT__c.sObjectType);
        vehicle.Name = 'Test Q5';
        vehicle.Model_Code_INT__c = '111';
        vehicle.Engine_Size__c = 1;
        vehicle.Engine_Type_Code__c = 'A';
        vehicle.Transmission_Type__c = 'Manual';
        vehicle.Trim_Description__c = 'Premium';
        vehicle.Fuel_Type_Code__c = 'G';
        return vehicle;
    }
    
    public static Service_Event__c createServiceEvent(String name){
        Service_Event__c serviceEvent = new Service_Event__c();
        serviceEvent.Name = name;
        return serviceEvent;
    }
    
    public static Vehicle_And_Part__c createVehiclePart(String vehicleId){
        Vehicle_And_Part__c vehiclePartRecord = new Vehicle_And_Part__c();
        vehiclePartRecord.Vehicle__c = vehicleId;
        return vehiclePartRecord;
    }
    
    public static TWG_Fee__c createTwgFee(Id dealerProductId){
        TWG_Fee__c twgFee = new TWG_Fee__c();
        twgFee.Start_Date__c = Date.today();
        twgFee.Dealer_Product__c = dealerProductId;
        return twgFee;
    }

    private static Publisher getPublisher(){
        return [
            SELECT id,MajorVersion, MinorVersion,Name, NamespacePrefix,DurableId,IsSalesforce 
            FROM Publisher 
            WHERE NamespacePrefix = 'c2g' 
            LIMIT 1
        ];
     }
    
    public static void updatePaymentPerFFVersion(c2g__codaPayment__c paymentRec, c2g__codaGeneralLedgerAccount__c glaAccount, 
        Id currencyId) {
        Publisher publisherObj = getPublisher();
        if(publisherObj != null && publisherObj.MajorVersion >= 18) {
            paymentRec.put('c2g__discountdate__c', System.Today());
            paymentRec.put('c2g__PaymentMediaTypes__c', 'Check');
        } else {
            paymentRec.c2g__DueDate__c = System.today() + 5;
            paymentRec.c2g__GeneralLedgerAccount__c = glaAccount.Id;
            if(currencyId != null) {
                paymentRec.c2g__AccountCurrency__c = currencyId;
            }
        }
    }
    
    public static String updateAssertPerFFPackageVersion(String assertMessageToCheck) {
        Publisher publisherObj = getPublisher();
        if(publisherObj != null && publisherObj.MajorVersion >= 2019 && assertMessageToCheck != null) {
            return (assertMessageToCheck.replaceFirst('\\[1\\]', '')).replaceFirst(';', '');
        } 
        return assertMessageToCheck;
    }
    
    public static List<CPM_Form_Matrix__c> getCPMFormMatrix() {
        List<CPM_Form_Matrix__c> formMatrixList = new List<CPM_Form_Matrix__c>();
        CPM_Form_Matrix__c formMatrix = new CPM_Form_Matrix__c(Auto_Club_Sel_Id__c = '12RMN', Auto_Club__c = 'RAAC', 
            Client_Type_Distribution_Channel__c = 'Dealer', Collateral_Type__c = 'Auto', Country__c = 'USA', 
            Form_Key__c = 'AWS281CT0505', Form_Selection__c = 'AWS281', Insurance_Type__c = 'FRP - Full Reimbursement CL Policy',
            Insurer_Code__c = 'VS', Insurer__c = 'Virginia Surety Company Inc.', Obligor_Code__c = '1', Channel__c = 'Resource',
            Obligor__c = 'Third Party Obligor', Payor_Code__c = '2', Payor__c = 'Automotive Warranty Services Inc.',
            Product_Class__c = '06 New Only', Product_Type__c = 'W - Service Contract', State_Province__c = 'IL',
            Writing_Company_Code__c = 'C5', Writing_Company__c = 'Automotive Warranty Services Inc.',
            Admin_Company_code__c = 'Ad1');
        formMatrixList.add(formMatrix);
        return formMatrixList;
    }
    
    public static Contract__c createMockContract() {
        Account fswAccount = new Account();
        fswAccount.Name = 'Account Name Unit Test XYZ';
        fswAccount.Phone = '3125554444';
        fswAccount.AccountNumber = 'RIL12345';
        fswAccount.Type = System.Label.In_Network;
        fswAccount.BillingCity = 'Chicago';
        fswAccount.BillingStreet = 'Unit Test Street 1';
        fswAccount.BillingCountry = 'USA';
        fswAccount.BillingPostalCode = '60606';
        fswAccount.BillingState = 'AL';
        fswAccount.State__c = 'ALABAMA';
        fswAccount.DRAD__c = '12345678';
        fswAccount.RecordTypeId =  RecordTypeDAO.getRecordType('Dealer','Account').Id;
        fswAccount.Release_2_Quoting_Pilot__c = true;
        fswAccount.BigMachines__Partner_Organization__c = 'dealers';
        fswAccount.ISFSW__c = true;
        fswAccount.Release_2_Quoting_Pilot__c = true;
        fswAccount.Id = TWGTestFactory.getFakeId(Account.sObjectType);
        
        Account writingCompany = new Account();
        writingCompany.RecordTypeId =  RecordTypeDAO.getRecordType('Non_Dealer','Account').Id;
        writingCompany.Id  = TWGTestFactory.getFakeId(Account.sObjectType);
        Account adminCompany = new Account();
        adminCompany.RecordTypeId =  RecordTypeDAO.getRecordType('Non_Dealer','Account').Id;
        adminCompany.Id  = TWGTestFactory.getFakeId(Account.sObjectType);
        
        Dealer_Product__c dp = new Dealer_Product__c();
        dp.ProductTypeName_INT__c = 'Test Dealer Product';
        dp.Product_Class__c = '06 New Only';
        dp.Requested_Start_Date__c = System.today();
        dp.Start_Date__c = System.today();
        dp.Participation_Model__c = 'Direct';
        dp.Is_Regulated__c = false;
        dp.Accounting_Code__c = '1234x';
        dp.Reporting_Class__c = TWGTestFactory.getFakeId(Reporting_Class__c.sObjectType);
        dp.Collateral_Type__c = 'Auto';
        dp.ProductTypeDesc_INT__c = 'W - Service Contract';
        dp.ProductClassDesc_INT__c = '';
        dp.Id = TWGTestFactory.getFakeId(Dealer_Product__c.sObjectType);
        String selectedRefundableBuckets = TWGTestFactory.getSelectedRefundableAccountingBuckets(dp);
        dp.Flat_Refundable_Accounting_Buckets__c = selectedRefundableBuckets;
        dp.Pro_Rata_Refundable_Accounting_Buckets__c = selectedRefundableBuckets;
        dp = (Dealer_Product__c)Mock.setFormulafield(dp, 
            new Map<String, Object>{'UW_Insurance_Rate_Code__c' => 'TestCode'});
        
        Vehicle__c veh = CPM_util_TestUtils.createVehicle();
        veh.Id = TWGTestFactory.getFakeId(Vehicle__c.sObjectType);

        Contract__c fswContract = TWGTestFactory.createFSWContract();
        fswContract.Name = 'TESTFSW1';
        fswContract.Status__c = ContractConstants.CONTRACT_STATUS_ACTIVE;
        fswContract.Vehicle__c = veh.Id;
        fswContract.Vehicle__r = veh;
        fswContract.Account_Name__c = fswAccount.Id;
        fswContract.Account_Name__r = fswAccount;
        fswContract.Obligor_Code__c = '1';
        fswContract.Writing_Company__c = 'FESC';
        fswContract.Payor_Code__c = '123';
        fswContract.Insurer_Code__c = '321';
        fswContract.Billing_State__c = 'IL';
        fswContract.Agmt_Form_Number_INT__c = 'AWS281CT0505';
        fswContract.Total_Reserve__c = 10;
        fswContract.Total_Loss_Fund__c = 5;
        fswContract.Total_Billed_Cost__c = 125;
        fswContract.Total_Dealer_Cost__c = 155;
        fswContract.Id = TWGTestFactory.getFakeId(Contract__c.sObjectType);
        fswContract.Auto_Dealer_Product__c = dp.Id;
        fswContract.Auto_Dealer_Product__r = dp;
        fswContract.Writing_Company_lookup__c = writingCompany.Id;
        fswContract.Writing_Company_lookup__r = writingCompany;
        fswContract.Contract_Start_Date__c = Date.today().addDays(-70);
        fswContract.EFT_Resid_Ballon_Amt_INT__c = '1';
        fswContract.Service_Interval__c = 1;
        fswContract.Number_of_Maintenance_Services__c = 1;
        fswContract.Cancel_Date_INT__c = Date.today();
        fswContract.Cancel_Odometer_INT__c = 3000;
        fswContract.Mileage_Expiration__c = 6000;
        fswContract.Expiration_Type__c='AOTCM';
        fswContract.Billing_Country__c = 'USA';
        fswContract.Total_Insurance_Premium__c = 200;
        fswContract.Client_Cancellation_Percentage__c = 50;
        fswContract.Retail_Price__c = 200;
        fswContract.Reported_Customer_Cost_INT__c = 200;
        fswContract.Admin_Company__c = adminCompany.Id;
        fswContract.Admin_Company__r = adminCompany;
        
        return fswContract;
    }
    
    public static void setReportingStateMocks(Contract_Reporting_State_Rule__c testRule){
        MockDAOs.ContractReportingStateRuleDAOMock reportingStateRuleMock = new MockDAOs.ContractReportingStateRuleDAOMock();
        reportingStateRuleMock.reportingStateRulesToReturn.add(testRule);
        ContractReportingStateRules.reportingStateRuleDAOInstance = reportingStateRuleMock;
        
        Contract_Reporting_State_Assignment__c assignment = TWGTestFactory.createReportingStateAssignment(testRule.Id, 'IL');
        MockDAOs.ContractReportingStateAssignmentDAOMock assignmentMock = new MockDAOs.ContractReportingStateAssignmentDAOMock();
        assignmentMock.reportingStateAssignments.add(assignment);
        ContractReportingStateAssignments.reportingStateAssignmentDAOInstance = assignmentMock;
    }
    
    public static void performRerateSetup(Contract__c contractForRerate) {
        CPM_util_TestUtils.createBMIConfigRecord();
        CPQReratingServiceCalloutMock ratingMock = new CPQReratingServiceCalloutMock(200, 
            contractForRerate.Auto_Dealer_Product__c);
        Test.setMock(HttpCalloutMock.class, ratingMock);
        MockDAOs.ContractLineItemDAOMock lineItemDAOMock = new MockDAOs.ContractLineItemDAOMock();
        lineItemDaoMock.listOfContractLineItemsToReturn.add(
            new Contract_Line_Item__c(Optional_Coverage_Name__c='Audio_Visual', Contract__c=contractForRerate.Id));
        ContractCPQReratingService.contractLineItemDAOInstance = lineItemDAOMock;
        MockDAOs.CPMFormMatrixDAOMock cpmFormMatrixDAOMock = new MockDAOs.CPMFormMatrixDAOMock();
        cpmFormMatrixDAOMock.cpmFormMatrixsToReturn = getCPMFormMatrix();
        CPMFormMatrixes.cpmFormMatrixDAOInstance = cpmFormMatrixDAOMock;
        MockDAOs.DealerProductDAOWithoutSharingMock dealerProductDAOMock = new MockDAOs.DealerProductDAOWithoutSharingMock();
        dealerProductDAOMock.channelToReturn = 'Resource';
        Contracts.dealerProductDAOWOSInstance = dealerProductDAOMock;
        ContractAdminRerateManager.dealerProductDAOWOSInstance = dealerProductDAOMock;
        dealerProductDAOMock.dealerProductMap.put(contractForRerate.Auto_Dealer_Product__c, 
            contractForRerate.Auto_Dealer_Product__r);
        MockDAOs.SalesCommissionCodeDAOMock commissionCodeDAOMock = new MockDAOs.SalesCommissionCodeDAOMock();
        Sales_Commission_Code__c commissionCode = new Sales_Commission_Code__c();
        commissionCode.Commission_Code__c = 'TestCode';
        commissionCode.Channel__c = 'Resource';
        commissionCode.Product_Type__c = 'W - Service Contract';
        commissionCodeDAOMock.salesCommissionCodes.add(commissionCode);
        SalesCommissionCodes.salesCommissionCodeDAOInstance = commissionCodeDAOMock;
        MockDAOs.ContractDAOMock contractDAOMock = new MockDAOs.ContractDAOMock();
        contractDAOMock.channel = 'Resource';
        ContractAdminRerateManager.contractDAOInstance = contractDAOMock;
        MockDAOs.AccountDAOMock accountDAOMock = new MockDAOs.AccountDAOMock();
        accountDAOMock.accountsToReturn.add(contractForRerate.Writing_Company_lookup__r);
        Contracts.accountDAOInstance = accountDAOMock;
        Contract_Reporting_State_Rule__c testRule = TWGTestFactory.createReportingStateRule();
        testRule.Writing_Company__c = contractForRerate.Writing_Company_lookup__c;
        testRule.Writing_Company__r = contractForRerate.Writing_Company_lookup__r;
        testRule.Start_Date__c = Date.today().addDays(-200);
        setReportingStateMocks(testRule);
        MockDAOs.ContractEventDAOWithoutSharingMock contractEventDAOWihtoutSharingMock = 
            new MockDAOs.ContractEventDAOWithoutSharingMock();
        ContractAdminRerateManager.contractEventDAOWithoutSharingInstance = contractEventDAOWihtoutSharingMock;
        MockDAOs.ContractDAOWithoutSharingMock contractDAOWithoutSharingInstance =
            new MockDAOs.ContractDAOWithoutSharingMock();
        contractDAOWithoutSharingInstance.contractsToReturn.add(contractForRerate);
        Contracts.contractDAOWithoutSharingInstance = contractDAOWithoutSharingInstance;
        ContractAdminContractManager.cDaoWithoutSharing = contractDAOWithoutSharingInstance;
        Contracts.adminCompanyCodeToAccountMap = new Map<String, Account>();
        Account testAdminCompanyAccount = TWGTestFactory.createAccount();
        testAdminCompanyAccount.Id = TWGTestFactory.getFakeId(Account.sObjectType);
        testAdminCompanyAccount.Name = 'Test Admin Company';
        testAdminCompanyAccount.Admin_Company_Code__c = 'Ad1';
        Contracts.adminCompanyCodeToAccountMap.put('Ad1',testAdminCompanyAccount);        
    }
    
    public static Dealer_Product_Forms__c createDealerProductFormWithoutInsert(Dealer_Product__c dp,String agreementFormNumber) {
        Dealer_Product_Forms__c form = new Dealer_Product_Forms__c(Dealer_Product__c = dp.Id,Agreement_Form_Number__c = agreementFormNumber);
        return form;
    }
    
    public static Client_Coupon_Maintenance__c createClientCouponMaintenance(Id dealerProductId){
        Client_Coupon_Maintenance__c clientCoupon = new Client_Coupon_Maintenance__c();
        clientCoupon.Dealer_Product__c = dealerProductId;
        clientCoupon.Engine_Oil_Type__c = 'All';
        clientCoupon.Coupon_Service_Description_Code__c = 'Oil 1';
        clientCoupon.Reimbursement_Amount__c = 20;
        clientCoupon.Start_Date__c = Date.today();
        return clientCoupon;
    }

    public static List<Account> createUltimateParentAccountForSelfLookup(Id dealerAccountId, Id ultimateParentId){
        String jsonString = '[{';
        jsonString+= '"attributes":{"type":"Account","url":"/services/data/v43.0/sobjects/Account/'+dealerAccountId+'"},';
        jsonString+= '"Id":"'+dealerAccountId+'","Ultimate_Parent__c":"'+ultimateParentId+'","CurrencyIsoCode":"USD",';
        jsonString+= '"Ultimate_Parent__r":{"attributes":{"type":"Account","url":"/services/data/v43.0/sobjects/';
        jsonString+= 'Account/'+ultimateParentId+'"},"Id":"'+ultimateParentId+'","Group_Client_Fee__c":true,"CurrencyIsoCode":"USD"}}]';
        List<Account> accountList = (List<Account>)JSON.deserialize(jsonString, List<Account>.class);
        return accountList;
    }
    
    public static Client_Fee_Configuration__c createClientFeeConfigurationSetting(){
        Client_Fee_Configuration__c configFeeData = new Client_Fee_Configuration__c();
        configFeeData.Name = 'ClientFeeBatchConfig';
        configFeeData.ClientFeeCasePayeeCreationBatch_Size__c = 50;
        configFeeData.UpdatePayeeDetailsBatch_Size__c = 2000;
        configFeeData.ClientPayeeStatementGenerationBatch_Size__c=2;
        configFeeData.ReleaseClientFeePaymentBatch_Size__c = 50;
        configFeeData.BillingItemsGenerationBatch_Size__c = 1;
        configFeeData.CreatePayableInvoicesUSAutoBatch_Size__c = 1;
        configFeeData.SendCFAttachmentsToMailRoomBatch_Size__c = 20;
        configFeeData.Client_Fee_Statement_DDP_Id__c = 'aAR0q0000007da3';
        configFeeData.Client_Fee_Statement_Delivery_Id__c = 'aAP0q0000002v1F';
        configFeeData.SpringCM_Credit_Debit_Folder_URL__c = '/v201411/folders?path=%2FOther%20Sources%2FClientFee%2F';
        configFeeData.SpringCM_Client_Fee_STMT_Folder_URL__c = '/v201411/folders?path=%2FOther%20Sources%2FClientFee%2F';
        insert configFeeData;
        return configFeeData;
    }

    public static Card_User__c createSpecialtyMemberCardUser(Id cardAccountId, String client, Boolean generateFakeId) {
        Card_User__c cardUser = new Card_User__c();
        if(generateFakeId) {
            cardUser.Id = TWGTestFactory.getFakeId(Card_User__c.sObjectType);
        }
        cardUser.Name = String.valueOf(Integer.valueOf(Math.random()*1000000));
        cardUser.Date_Become_Member__c = System.today().addYears(-1);
        cardUser.Std_First_Name__c = 'Test';
        cardUser.Std_Middle_Name__c = 'Pass';
        cardUser.Std_Last_Name__c = 'McTester';
        cardUser.Std_Street__c = '175 West Jackson';
        cardUser.Std_Street_2__c = 'Floor 8';
        cardUser.Std_City__c = 'Chicago';
        cardUser.Std_State__c = 'IL';
        cardUser.Std_Zip__c = '60604';
        cardUser.Std_Country__c = 'United States';
        cardUser.Primary_Email__c = 'test@example.com';
        cardUser.Mobile_Number__c = '1234567890';
        cardUser.Phone_Number__c = '1234567890';
        cardUser.Coverage_Start_Date__c = System.today().addDays(10);
        cardUser.Coverage_End_Date__c = System.today().addDays(35);
        cardUser.Cancellation_Date__c = null;
        cardUser.Premium_Amount__c = 10000;
        cardUser.Covered_Members__c = 'Test One;Test Two;Test Three;Test Four';
        cardUser.Card_Account__c = cardAccountId;
        cardUser.Client__c = client;
        cardUser.RecordTypeId = CardUserConstants.SPECIALTY_MEMBER_RECORDTYPE_ID;

        return cardUser;
    }
    
    public static US_Auto_Writing_Company_Change__c createbillingStatementSetting(){
        US_Auto_Writing_Company_Change__c writingCompanyChange = new US_Auto_Writing_Company_Change__c();
        writingCompanyChange.Name = 'writingCompanyChange';
        writingCompanyChange.Apex_Job_Batch_Size__c = 50;
        writingCompanyChange.Activity_To_Include_in_WCompany_Batch__c = '14,2C';
        insert writingCompanyChange;
        return writingCompanyChange;
    }

    public static APAC_Auto_Configurations__c createAPACAutoConfigurationSettings(String name) {
        APAC_Auto_Configurations__c apacAutoConfigurationSetting = new APAC_Auto_Configurations__c();
        apacAutoConfigurationSetting.Name = name;
        apacAutoConfigurationSetting.Tax_Rate__c = 7;
        return apacAutoConfigurationSetting;
    } 
    
    public static Guest_User_Id__c createGuestUserId(String name, String guestId) {
        Guest_User_Id__c guestUser = new Guest_User_Id__c();
        if(!String.isBlank(name) && !String.isBlank(guestId) && guestId.length() > 14) {
            guestUser.Name = name;
            guestUser.User_Id__c = guestId.subString(0,15);
        }
        return guestUser;
    }   

    public static Contract_Ineligible_Reason__c createContractIneligibleReason() {
        Contract_Ineligible_Reason__c contractIneligibleReason = new Contract_Ineligible_Reason__c();
        contractIneligibleReason.Ineligible__c = 'Dealer no longer offers product';
        return contractIneligibleReason;
    }
    
    public static FSM_Dealer_Incentive__c createFSMDealerIncentive(Account testAccount, Account payeeAccount) {
        FSM_Dealer_Incentive__c testFSM = new FSM_Dealer_Incentive__c();
        testFSM.FIRR_Rep_Id_Number_Key_INT__c = '1234';
        testFSM.FIRR_First_Name_INT__c = 'DummyFirst';
        testFSM.FIRR_Last_Name_INT__c = 'DummyLast';
        testFSM.Account__c = testAccount.Id;
        testFSM.Payee__c = payeeAccount.Id;
        return testFSM;
    }
    
    public static Dealer_Product__c getTestDealerProductForFSW(){
        Account accountInstance = new Account();
        accountInstance.accountNumber = 'Acc1234';
        accountInstance.ISFSW__c = true;
        Dealer_Product__c dealerProduct = new Dealer_Product__c();
        dealerProduct.Product_Class__c = 'TestProductClass';
        dealerProduct.ProductTypeDetailType_INT__c = 'PPM';
        dealerProduct.Account__r = accountInstance;
        dealerProduct.Account__r.ISFSW__c = true;
        dealerProduct.Account__r.accountNumber = 'Acc1234';
        dealerProduct.Form_Number_s__c = 'TestForm1234567';
        dealerProduct.Active__c = true;
        dealerProduct.Start_Date__c = date.newInstance(2019, 1, 23);
        dealerProduct = (Dealer_Product__c)Mock.setFormulafield(dealerProduct, 
            new Map<String, Object>{'UW_Insurance_Rate_Code__c' => 'Test Insurance Rate Code'});
        return dealerProduct;
    }
    
    public static Expiration_Type_Question__c getExpirationTypeQuestion(){
        Form_Master_Table__c formMaster = new Form_Master_Table__c(name='TestForm1234567', Form_Number__c = 'TestForm1234567', 
            Country_Code__c = 'USA');
        Expiration_Type_Question__c expirationTypeQuestion = new Expiration_Type_Question__c();
        expirationTypeQuestion.Expiration_Type__c = 'AOTCM';
        expirationTypeQuestion.Form_Number__r = formMaster;
        expirationTypeQuestion.Product_Class__c = 'TestProductClass';
        expirationTypeQuestion.Vehicle_New_Used__c = '';
        return expirationTypeQuestion;
    }
    
    public static Dealer_Product_Forms__c getTestDealerProductFormForFSW(String formNumber, String expirationType){
        Dealer_Product__c dealerProduct = getTestDealerProductForFSW();
        Dealer_Product_Forms__c dealerProductForm = new  Dealer_Product_Forms__c();
        dealerProductForm.Agreement_Form_Number__c = formNumber;
        dealerProductForm.Dealer_Product__r = dealerProduct;   
        dealerProductForm.Expiration_Type__c = expirationType;
        return dealerProductForm;
    }

    public static Mulesoft_web_service_setting__c createMuleSoftSettingsByName(String nameOfMulesoftSetting){
        Mulesoft_web_service_setting__c muleSoftSetting = new Mulesoft_web_service_setting__c();
        muleSoftSetting.name = nameOfMulesoftSetting;
        muleSoftSetting.Client_ID__c = 'clientID';
        muleSoftSetting.Client_Secret__c = 'ClientSecret';
        muleSoftSetting.URL__c = 'https://www.testConnection.theTwg.com';
        muleSoftSetting.Time_Out__c = 10000;
        return muleSoftSetting;
    }
    
    public static Spectrum_Service_Details__c createSpectrumServiceSettings() {
        Spectrum_Service_Details__c spectrumServiceSettings = new Spectrum_Service_Details__c();
        spectrumServiceSettings.End_point_URL__c = 'https://pod5.spectrumtestsandbox.eu/rest/GlobalLookupAddress/results.json';
        return spectrumServiceSettings;
    }

    public static Account createAdminCompanyAccount() {
        Id accountRecordType  = Schema.SObjectType.Account.getRecordTypeInfosByName().get('Non-Dealer').getRecordTypeId();
        Account adminCompanyAccount = new Account(RecordTypeId=accountRecordType, Admin_Company_Code__c = 'Ad1',
            Name='Test Admin Company', Type = 'Admin Company');
        return adminCompanyAccount;
    }

    public static Related_Contract_Map__c createRelatedContractMap(Id primaryContractId, Id secondaryContractId, 
        String relationshipType, Id recordTypeId){
        Related_Contract_Map__c relatedContractMapInstance = new Related_Contract_Map__c();
        relatedContractMapInstance.Primary_Contract__c = primaryContractId;
        relatedContractMapInstance.Secondary_Contract__c = secondaryContractId;
        relatedContractMapInstance.Relationship_Type__c = relationshipType;
        relatedContractMapInstance.RecordTypeId = recordTypeId;
        return relatedContractMapInstance;
    }
    
    public static List<Integration_Job__c> createIntegrationJobListForYearAndType(Integer year, String accountType) {
        List<Integration_Job__c> jobList = new List<Integration_Job__c>();
        List<String> monthList = new List<String> {
            IntegrationJobConstants.INTEGRATION_JOB_CLOSE_MONTH_JANUARY,
            IntegrationJobConstants.INTEGRATION_JOB_CLOSE_MONTH_FEBRUARY,
            IntegrationJobConstants.INTEGRATION_JOB_CLOSE_MONTH_MARCH,
            IntegrationJobConstants.INTEGRATION_JOB_CLOSE_MONTH_APRIL,
            IntegrationJobConstants.INTEGRATION_JOB_CLOSE_MONTH_MAY,
            IntegrationJobConstants.INTEGRATION_JOB_CLOSE_MONTH_JUNE,
            IntegrationJobConstants.INTEGRATION_JOB_CLOSE_MONTH_JULY,
            IntegrationJobConstants.INTEGRATION_JOB_CLOSE_MONTH_AUGUST,
            IntegrationJobConstants.INTEGRATION_JOB_CLOSE_MONTH_SEPTEMBER,
            IntegrationJobConstants.INTEGRATION_JOB_CLOSE_MONTH_OCTOBER,
            IntegrationJobConstants.INTEGRATION_JOB_CLOSE_MONTH_NOVEMBER,
            IntegrationJobConstants.INTEGRATION_JOB_CLOSE_MONTH_DECEMBER
        };

        for(Integer i = 1; i <= 24; i++) {
            Datetime newDatetime = Datetime.newInstance(year, i, 15);
            Integration_Job__c newIntegrationJob = new Integration_Job__c();
            newIntegrationJob.Type__c = accountType;
            newIntegrationJob.Channel__c = 'First Extended;PGM';
            newIntegrationJob.Close_Date__c = newDatetime;
            newIntegrationJob.Close_Month__c = monthList[newDatetime.month() - 1];
            newIntegrationJob.Close_Year__c = newDatetime.year();
            jobList.add(newIntegrationJob);
            Integration_Job__c newIntegrationJobForResource = new Integration_Job__c();
            newIntegrationJobForResource.Type__c = 'Resource';
            newIntegrationJobForResource.Channel__c = 'National Account;Resource';
            newIntegrationJobForResource.Close_Date__c = newDatetime;
            newIntegrationJobForResource.Close_Month__c = monthList[newDatetime.month() - 1];
            newIntegrationJobForResource.Close_Year__c = newDatetime.year();
            jobList.add(newIntegrationJobForResource);
        }
        return jobList;
    }
    
    public static CPQReratingServiceResponse createFSWContractRerateResponse() {
        CPQReratingServiceResponse testResponse = new CPQReratingServiceResponse();
        testResponse.adminFee = 120.0;
        testResponse.marketingFee = 10.0;
        testResponse.vendorFee = 10.0;
        testResponse.riskFee = 10.0;
        testResponse.riskFee2 = 0.0;
        testResponse.reserve = 10.0;
        testResponse.corporateFee = 10.0;
        testResponse.escrowFee = 10;
        testResponse.agentFee = 10;
        testResponse.coveragePlanCode = 'PLT200';
        testResponse.clientFee2 = 20.0;
        testResponse.termMonths = '12';
        testResponse.termDistance = '99000';
        return testResponse;
    }
    
    public static void createIntegrationJobMockData(List<Contract__c> contracts){
        Datetime aDate = System.now();
        List<Integration_Job__c> testIntegrationJobList = createIntegrationJobListForYearAndType(
            aDate.year(), IntegrationJobConstants.INTEGRATION_JOB_TYPE_FIRST_EXTENDED);
        MockDAOs.ContractDAOWithoutSharingMock contractDAOWithoutSharingMock = new MockDAOs.ContractDAOWithoutSharingMock();
        MockDAOs.IntegrationJobWOSharingDAOMock integrationJobWOSharingDAOMock = new MockDAOs.IntegrationJobWOSharingDAOMock();
        contractDAOWithoutSharingMock.contractsToReturn = contracts;
        integrationJobWOSharingDAOMock.integrationJobListToReturn = testIntegrationJobList;
        ContractEvents.contractDAOWithoutSharingInstance = contractDAOWithoutSharingMock;
        ContractEvents.integrationJobWOSharingDAOInstance = integrationJobWOSharingDAOMock;
    }
    
    public static Integration_Job_Management__c createIntegrationJobManagement(){
        Integration_Job_Management__c integrationJobSetting = new Integration_Job_Management__c();
        integrationJobSetting.Contract_Days_To_Process_For_PPM_Coupons__c = 5;
        return integrationJobSetting;
    }
    
    public static Remittance__c createRemittance(Id accountId, String contractNumber){
        Remittance__c remittance = new Remittance__c();
        remittance.Account__c = accountId;
        remittance.Contract_number__c = contractNumber;
        return remittance;
    }
    
    public static void createSpringCMRESTEnvironmentalMockCustomSettingData(){
        CurrentEnvironment__c ce = new CurrentEnvironment__c();
        ce.Name = 'currentEnvironment';
        ce.environment__c = 'TEST';
        insert ce;

        SpringCM_REST_Environmental__c scm = new SpringCM_REST_Environmental__c();
        scm.Name = 'TEST';
        scm.Client_Secret__c = 'Client Secret';
        scm.Base_URL__c = 'Base URL';
        scm.API_Key__c = 'API Key';
        scm.Auth_URL__c = 'Auth URL';
        scm.Base_URL_For_Download_Document__c = 'Base Url For Download';
        insert scm;
    }
    
    public static Discount_Rate__c createDiscountRate(Id dealerProductId){
        Discount_Rate__c discountRate = new Discount_Rate__c();
        discountRate.RecordTypeId = RecordTypeDAO.getRecordTypeId('EU_PPM','Discount_Rate__c');
        discountRate.Dealer_Product__c = dealerProductId;
        discountRate.Rate_Type__c = 'HTN';
        discountRate.Client_Code__c = '1234567878';
        discountRate.Country__c = 'GBR';
        discountRate.Max_Parts_Disc__c = 4;
        discountRate.Max_Service_Disc__c = 50;
        discountRate.Vehicle_Type__c = 'Bike';
        discountRate.Start_Date__c = Date.today();
        return discountRate;
    }
    
    public static Client_Coupon_Maintenance_Value_Add__c createClientCouponMaintenanceValueAdd(Id dealerProductId, Value_Add_Coupon_Master__c couponMaster){
        Client_Coupon_Maintenance_Value_Add__c clientCouponMaintenanceValueAdd = new Client_Coupon_Maintenance_Value_Add__c();
        clientCouponMaintenanceValueAdd.RecordTypeId = RecordTypeDAO.getRecordTypeId('EU_PPM','Client_Coupon_Maintenance_Value_Add__c');
        clientCouponMaintenanceValueAdd.Dealer_Product__c = dealerProductId;
        clientCouponMaintenanceValueAdd.Value_Add_Coupon_Master__c = couponMaster.Id;
        clientCouponMaintenanceValueAdd.Country_Code__c = 'GBR';
        clientCouponMaintenanceValueAdd.Rate_Type__c = 'HTN';
        clientCouponMaintenanceValueAdd.Fuel_Type__c = 'Petrol';
        return clientCouponMaintenanceValueAdd;
    }
    
    public static Client_Coupon_Maintenance_Value_Add__c createClientCouponMaintenanceValueAdd(Value_Add_Coupon_Master__c couponMaster){
        Client_Coupon_Maintenance_Value_Add__c clientCouponMaintenanceValueAdd = new Client_Coupon_Maintenance_Value_Add__c();
        clientCouponMaintenanceValueAdd.RecordTypeId = RecordTypeDAO.getRecordTypeId('EU_PPM','Client_Coupon_Maintenance_Value_Add__c');
        clientCouponMaintenanceValueAdd.Value_Add_Coupon_Master__c = couponMaster.Id;
        clientCouponMaintenanceValueAdd.Coupon_Type__c = 'Service';
        clientCouponMaintenanceValueAdd.Country_Code__c = 'GBR';
        clientCouponMaintenanceValueAdd.Rate_Type__c = 'HTN';
        clientCouponMaintenanceValueAdd.Cost__c = 75;
        clientCouponMaintenanceValueAdd.Fuel_Type__c = 'Petrol';
        return clientCouponMaintenanceValueAdd;
    }
    
    public static Value_Add_Coupon_Master__c createValueAddCouponMaster(){
        Value_Add_Coupon_Master__c valueAddCouponMaster = new Value_Add_Coupon_Master__c();
        valueAddCouponMaster.RecordTypeId = RecordTypeDAO.getRecordTypeId('EU_PPM','Value_Add_Coupon_Master__c');
        valueAddCouponMaster.Fuel_Type__c = 'Petrol';
        valueAddCouponMaster.Coupon_Service_Description_Code__c = 'Test';
        valueAddCouponMaster.End_Date__c = date.today() + 20;
        return valueAddCouponMaster;
    }
    
    public static ContractExt__c createContractExt(Id contractId){
        ContractExt__c testContractExt = new ContractExt__c(Contract__c = contractId);
        return testContractExt;
    }
    
    public static List<Bundle_Child_Product__c> createBundleProductChildRecords(TWG_Product__c baseProduct) {
        List<Bundle_Child_Product__c> recordsToReturn = new List<Bundle_Child_Product__c>();
        Bundle_Child_Product__c childRecord  = new Bundle_Child_Product__c();
        childRecord.Coverage_Description__c = 'Paintless Coverage';
        childRecord.Input_Product_Type__c = 'BUN';
        childRecord.Output_Product_Type__c = 'PDR';
        childRecord.Product_Description__c = 'Paintless Dent';
        childRecord.TWG_Product__c = baseProduct.Id;
        recordsToReturn.add(childRecord);
        return recordsToReturn;
    }

    public static User createUserByProfileAndRole(String profileId, String roleId) {
        return new User(ProfileId = profileId, UserName = 'newYahooUser@yahoo.com',
            Email = 'externalUser@yahoo.com', EmailenCodingKey = 'UTF-8', LocalesIdKey = 'en_US',
            LanguageLocaleKey = 'en_US', TimeZonesIdKey = 'America/Los_Angeles', Alias = 'extUser',
            LastName = 'lastname', UserRoleId = roleId);
    }

    public static Quote__c getEnterpriseQuote(){
        Quote__c quoteRecord = new Quote__c();
        quoteRecord.Id = TWGTestFactory.getFakeId(Quote__c.sObjectType);
        quoteRecord.Cancel_Type__c = 'Claim Dispute';
        quoteRecord.Refund_Type__c = 'Dealer Refund';
        quoteRecord.Waive_Cancel_Fee__c = true;
        quoteRecord.Cancel_Payment_Type__c = 'Check';
        quoteRecord.Cancel_Requester__c = 'Dealer';
        quoteRecord.Override_Cancel_Fee_Amount_in__c = false;
        quoteRecord.Override_Cancel_Percent_in__c = false;
        quoteRecord.Override_Cancel_Fee_Amount__c = 0;
        quoteRecord.Override_Cancel_Percent__c = 0;
        quoteRecord.Cancellation_Reason__c = 'test';
        quoteRecord.Dealer_Lienholder_Name__c = 'BOA';
        quoteRecord.State_Lienholder__c = 'Iowa';
        quoteRecord.Dealer_Leinholder_Address__c = 'Address';
        quoteRecord.Dealer_Lienholder_Address_2__c = 'Address2';
        quoteRecord.Zip_Lienholder__c = '60606';
        quoteRecord.Country_Lienholder__c  = 'USA';
        quoteRecord.City_Lienholder__c = 'Chicago';
        return quoteRecord;
    }
    
    public static ContractAdminContractWrapper getEnterpriseContractWrapper(Quote__c quoteRecord){
        Contract__c contractRecord = new Contract__c();
        contractRecord.Cancel_Date_INT__c = System.today();
        contractRecord.Client_Cancellation_Percentage__c = 10;
        contractRecord.Client_Cancel_Fee__c = 100;
        contractRecord.Client_Less_Retained__c = 100;
        contractRecord.Client_Net_Refund__c = 100;
        contractRecord.refundBase_INT_WSDL__c = 100;
        contractRecord.Id = TWGTestFactory.getFakeId(Contract__c.sObjectType);

        ContractAdminContractWrapper contractWrapper = new ContractAdminContractWrapper();
        contractWrapper.theContract = contractRecord;
        contractWrapper.theContract.Account_Name__c = TWGTestFactory.getFakeId(Account.sObjectType);
        contractWrapper.theContract.Cancel_Date_INT__c = System.today();
        contractWrapper.theContract.Client_Cancellation_Percentage__c = 10;
        contractWrapper.theContract.Cancellation_Based_Upon_Contract_Cancell__c = 'flat';
        contractWrapper.theContract.Client_Cancel_Fee__c = 100;
        contractWrapper.theContract.Client_Less_Retained__c = 100;
        contractWrapper.theContract.Client_Net_Refund__c = 100;
        contractWrapper.theContract.refundBase_INT_WSDL__c = 100;
        contractWrapper.theContract.Customer_Less_Cancel_Fee__c = 100;
        contractWrapper.theContract.Customer_Less_Retained__c = 100;
        contractWrapper.theContract.Customer_Net_Refund__c = 100;
        contractWrapper.theContract.Reported_Customer_Cost_INT__c = 100;
        contractWrapper.theContract.Enter_Current_Odometer__c = 20;
        contractWrapper.theContract.VIN__c = '5FNYF6H09HB045878';
        contractWrapper.theContract.Id = TWGTestFactory.getFakeId(Contract__c.sObjectType);
        ContractAdminContractWrapper.ContractCancellationQuote quoteDetails =
            new ContractAdminContractWrapper.ContractCancellationQuote(quoteRecord);
        contractWrapper.quote = quoteDetails;
        return contractWrapper;
    }
    
    public static Case_Setting__c getCaseSetting(){
        Case_Setting__c testCaseSetting = new Case_Setting__c();
        testCaseSetting.Uses_CaseAgentConsole__c = true;
        testCaseSetting.Can_edit_CSR_Internal_Statuses__c = true;
        testCaseSetting.Can_edit_Mechanical_cases__c = true;
        testCaseSetting.Redirect_to_GAP__c = true;
        testCaseSetting.Creates_Compliance_Cases__c = true;
        testCaseSetting.SetupOwnerId = UserInfo.getUserId();
        return testCaseSetting;
    }

    public static Compliance_Rules__c getComplianceRuleSetting(){
        Compliance_Rules__c complianceRules =  Compliance_Rules__c.getOrgDefaults();
        complianceRules.Contract_Type__c = 'WAR';
        complianceRules.State__c = 'FL';
        return complianceRules;
    }

    public static Note createNote(Id parentId, Id userId){
        Note testNote = new Note();
        testNote.ParentId = parentId;
        testNote.Title = 'Test Note';
        testNote.Body = 'Test Note Description';
        testNote.CreatedById = userId; 
        return testNote;
    }
    
    public static Group_Payment__c createPaymentGroup() {
        return (Group_Payment__c)buildSObject( Group_Payment__c.SObjectType, null );
    }    

    public static Integration_Process__c getIntegrationObject(String contractName){
        Integration_Process__c integrationProcess = new Integration_Process__c(Request_Id__c='test03');
        integrationProcess.Contract_Name__c = contractName;
        integrationProcess.Account_Number__c = 'MOONFSW1';
        integrationProcess.Form_Number__c = 'ANVCP0416';
        integrationProcess.Process_Type__c = TWG_Constants.MAINTENANCE;
        integrationProcess.Source_System__c = ContractConstants.ENTERPRISE_EFT;
        integrationProcess.Retail_Amount__c = 100;
        integrationProcess.Term_Miles__c = 1100;
        integrationProcess.Term_Month__c = 12;
        integrationProcess.Stock_Number__c ='Test';
        integrationProcess.Odometer__c = 100;
        integrationProcess.Purchase_Price__c  = 33.0;
        integrationProcess.Plan_Name__c ='Test';
        integrationProcess.Customer_Last_Name__c = 'CustomerLastName';
        integrationProcess.Customer_Middle_Initial__c = 'C';
        integrationProcess.Customer_First_Name__c = 'CustomerFirstName';
        integrationProcess.Customer_Street__c ='Street Address';
        integrationProcess.Customer_City__c ='City';
        integrationProcess.Customer_State__c ='IL';
        integrationProcess.Customer_Zip__c ='112221';
        integrationProcess.Customer_Phone__c = '21212122';
        integrationProcess.Customer_Other_Street__c  = 'CStreet Address';
        integrationProcess.Customer_Other_City__c = 'City';
        integrationProcess.Customer_Other_State__c ='IL';
        integrationProcess.Customer_Other_Zip__c = '765421';
        integrationProcess.Customer_Other_Phone__c='987625211';
        integrationProcess.Customer_Email__c ='test@mail.com';
        integrationProcess.Secondary_Customer_Last_Name__c ='Secondary CustomerLastName';
        integrationProcess.Secondary_Customer_Middle_Initial__c ='S';
        integrationProcess.Secondary_Customer_First_Name__c = 'Secondary CustomerFirstName';
        integrationProcess.Secondary_Customer_Street__c = 'Secondary Street Address';
        integrationProcess.Secondary_Customer_City__c = 'Secondary City';
        integrationProcess.Secondary_Customer_State__c = 'IL';
        integrationProcess.Secondary_Customer_Zip__c = '323141';
        integrationProcess.Secondary_Customer_Phone__c ='21212122';
        integrationProcess.Secondary_Customer_Email__c ='secondary@mail.com';
        integrationProcess.Lienholder_Name__c = 'LienholderName';
        integrationProcess.Lienholder_Street__c = 'LienholderStreet';
        integrationProcess.Lienholder_City__c = 'Lienholder City';
        integrationProcess.Lienholder_State__c ='ST';
        integrationProcess.Lienholder_Zip__c ='87652';
        integrationProcess.Lienholder_Country__c = 'Country';
        integrationProcess.Lienholder_Phone__c = '54321123';
        return integrationProcess;
    }
    
    public static sObject getMetadata(SObjectType metadataSObjectType, Map<String, Object> fields) {
        Map<String, Object> jsonFields = new Map<String, Object> {
            'attributes' => new Map<String, Object> {
                'type' => metadataSObjectType.getDescribe().getName()
            }
        };
        if(fields != null) {
            jsonFields.putAll(fields);
        }
        return (SObject) JSON.deserialize(JSON.serialize(jsonFields), SObject.class);
    }

    public static Coupon__c getCouponByCouponCode(String couponCode) {
        return new Coupon__c (
            Id = TWGTestFactory.getFakeId(Coupon__c.sObjectType),
            Coupon_Code__c = couponCode,
            Start_Date__c = System.today(),
            End_Date__c = System.today()
        );
    }

    public static ContractExt__c getContractExtByCouponCodeAndRecordTypeId(String couponCode, Id recordTypeId) {
        return new ContractExt__c (
            Id = TWGTestFactory.getFakeId(ContractExt__c.sObjectType),
            Coupon_Code__c = couponCode,
            RecordTypeId = recordTypeId);
    }
    
    public static Contract_Event__c getContractEvent(Id tWGFeeId, Contract__c contract,
        Id recordTypeId){
        Contract_Event__c contractEvent = new  Contract_Event__c();
        contractEvent.TWG_Fee__c = tWGFeeId;
        contractEvent.Contract__c = contract.Id;
        contractEvent.Contract__r = contract;
        contractEvent.Total_Client_Fee__c = 12;
        contractEvent.Total_Incentives__c = 12;
        contractEvent.CLF_CPQ__c= 12;
        contractEvent.RecordTypeId = recordTypeId;
        contractEvent.Original_Total_Client_Fee__c = 20;
        contractEvent.Is_Financial_Transaction__c = true;
        contractEvent.Id = TWGTestFactory.getFakeId(Contract_Event__c.sObjectType);
        return contractEvent;
    }

    public static Billing_Item__c getBillingItem(Contract_Event__c contractEvent){
        Billing_Item__c billingItem = new Billing_Item__c();        
        billingItem.Contract_Event__c = contractEvent.Id;
        billingItem.Contract_Event__r = contractEvent;
        billingItem.Id = TWGTestFactory.getFakeId(Billing_Item__c.sObjectType);
        billingItem.CF1_Payee_Detail_Created__c = false;
        billingItem.CF2_Payee_Detail_Created__c= false;
        billingItem.CF3_Payee_Detail_Created__c= false;
        billingItem.CF4_Payee_Detail_Created__c= false;
        billingItem.Incentive_Payee_Detail_Created__c = false;
        billingItem.Goodwill_Payee_Detail_Created__c = false;
        billingItem.AN_Incentive_Payee_Detail_Created__c = false;
        billingItem.Training_Payee_Detail_Created__c = false;
        billingItem.CLFCPQ_Payee_Detail_Created__c = false;
        return billingItem;
    }
        
    public static Client_Fee_Allocation_Header__c getAllocationHeader(Id tWGFeeId,
        String allocationType, String FeeType,Id recordTypeId){
        Client_Fee_Allocation_Header__c allocationHeader = new Client_Fee_Allocation_Header__c();        
        allocationHeader.Dealer_Product__c = TWGTestFactory.getFakeId(Dealer_Product__c.sObjectType);
        allocationHeader.Dealer_Name__c = TWGTestFactory.getFakeId(Account.sObjectType);
        allocationHeader.TWG_Fee__c = tWGFeeId;
        allocationHeader.Allocation_Type__c = allocationType;
        allocationHeader.Client_Fee__c = 12.00;
        allocationHeader.Start_Date__c = Date.today();
        allocationHeader.Fee_Type__c = FeeType;
        allocationHeader.RecordTypeId = recordTypeId;
        allocationHeader.Id = TWGTestFactory.getFakeId(Client_Fee_Allocation_Header__c.sObjectType);
        return allocationHeader;
    }
    
    public static Client_Fee_Allocation_Detail__c getAllocationDetail(Client_Fee_Allocation_Header__c allocationHeader,
        Decimal allocationValue,Id recordTypeId, Id accountId){
        return new Client_Fee_Allocation_Detail__c(
            Id = TWGTestFactory.getFakeId(Client_Fee_Allocation_Detail__c.sObjectType),
            Allocation_Header__c = allocationHeader.Id,
            Allocation_Header__r = allocationHeader,
            Allocation_Amount_Percentage__c = allocationValue,
            RecordTypeId = recordTypeId,
            Account__c = accountId
        );
    }

    public static TaxAvalaraWrapper getTaxAvalaraWrapper(){
        TaxAvalaraWrapper taxAvalara = new TaxAvalaraWrapper();
        taxAvalara.resultCode = TaxConstants.TAX_RESULT_CODE_SUCCESS;
        TaxAvalaraWrapper.TaxLine taxLine = new TaxAvalaraWrapper.TaxLine();
        TaxAvalaraWrapper.TaxLine[] taxLines = new TaxAvalaraWrapper.TaxLine[]{taxLine};
        taxAvalara.taxLines = taxLines;
        taxLine.Rate = .10;
        taxavalara.taxRate = 10.00;
        taxavalara.totalTax = '123';
        return taxAvalara;
    }
    
    public static AIZ_Setting__c createAIZSetting() {
        AIZ_Setting__c aizSetting = new AIZ_Setting__c();
        aizSetting.Account_Pool_Id__c = 'TestPool';
        aizSetting.Client_Id__c = 'TestClient';
        aizSetting.Client_Secret__c = 'TestSecret';
        aizSetting.Under_Tolerance__c = 0;
        aizSetting.URL__c = ' ';
        aizSetting.Card_End_Period__c = 14;
        return aizSetting;
    }

    public static List<Oracle_CPQ_Cloud_Data_Table_Integration__c> createDataTableIntegrationList(String objectName,
        String upsertKeyName, List<String> sfdcFieldNames, List<String> dataTableFieldNames) {
        List<Oracle_CPQ_Cloud_Data_Table_Integration__c> cpqCloudDataIntegrationList = 
            new List<Oracle_CPQ_Cloud_Data_Table_Integration__c>();
        if(sfdcFieldNames.size() != dataTableFieldNames.size()) {
            return null;
        }
        List<Oracle_CPQ_Cloud_Data_Table_Field_Map__c> fieldMappings = new List<Oracle_CPQ_Cloud_Data_Table_Field_Map__c>();
        for(Integer i=0; i<sfdcFieldNames.size(); i++) {
            Oracle_CPQ_Cloud_Data_Table_Field_Map__c fieldMapping = new Oracle_CPQ_Cloud_Data_Table_Field_Map__c();
            fieldMapping.SFDC_Field_Name__c = sfdcFieldNames[i];
            fieldMapping.Data_Table_Field_Name__c = dataTableFieldNames[i];
            fieldMappings.add(fieldMapping);
        }
        Oracle_CPQ_Cloud_Data_Table_Integration__c dataTable = new Oracle_CPQ_Cloud_Data_Table_Integration__c();
        dataTable.Object_Name__c = objectName;
        if(!String.isBlank(upsertKeyName)) {
            dataTable.Upsert_Key__c = upsertKeyName;
        }
        cpqCloudDataIntegrationList = (List<Oracle_CPQ_Cloud_Data_Table_Integration__c>)Mock.makeRelationship(
            List<Oracle_CPQ_Cloud_Data_Table_Integration__c>.class, 
            new List<Oracle_CPQ_Cloud_Data_Table_Integration__c>{dataTable}, 
            Oracle_CPQ_Cloud_Data_Table_Field_Map__c.Data_Table_Integration__c, 
            new List<List<Oracle_CPQ_Cloud_Data_Table_Field_Map__c>>{fieldMappings});
        return cpqCloudDataIntegrationList;
    }
    
    public static Product_Notification_Configuration__c getProductNotificationConfig(){
        Product_Notification_Configuration__c productNotificationConfig = new Product_Notification_Configuration__c();
        productNotificationConfig.Frequency_Type__c = ProductNotificationConfigConstants.NOTIFICATION_FREQUENCY_TYPE_INITIAL;
        productNotificationConfig.Template_Name__c = 'New Template';
        productNotificationConfig.Agreement_Status__c = ContractConstants.ACTIVE_STATUS;
        productNotificationConfig.Start_Date__c = Date.today();
        productNotificationConfig.Communication_Option__c = CommunicationJobsConstants.METHOD_OF_COMMUNICATION;
        return productNotificationConfig;
    }

    public static Case getComplianceCase(){        
        Case testCase = new Case();
        testCase.Id = TWGTestFactory.getFakeId(Case.sObjectType);
        testCase.RecordTypeId = RecordTypeDAO.getCaseRecordTypeID(CaseConstants.CASE_RECORD_TYPE_COMPLIANCE_DEVELOPER_NAME);
        testCase.Status = CaseConstants.CASE_NEW;
        testCase.Sub_Status__c = CaseConstants.CASE_SUB_STATUS_PRE_CASE_REVIEW_NEEDED;

        return testCase;
    }
    
    public static String getRandomString(){
        return String.valueOf(Crypto.getRandomLong() + randomCounter++);
    }

    public static Contract__c getContractForPR() {
        Account testAccount = createAccount();
        testAccount.Id = TWGTestFactory.getFakeId(Account.sObjectType);
        testAccount.accountNumber = '337';
        testAccount.Name = 'Auto Sales';
        testAccount.ISFSW__c = true;
        testAccount.BillingState = TWG_Constants.PR;
        testAccount.Release_2_Quoting_Pilot__c = true;

        Contract__c testContract = createContract();
        testContract.Id = TWGTestFactory.getFakeId(Contract__c.sObjectType);
        testContract.RecordTypeId = ContractConstants.CONTRACT_PUERTO_RICO_RECORD_TYPE_ID;
        testContract.Name = 'PRContract';
        testContract.Account_Name__c = testAccount.Id;
        testContract.Account_Name__r = testAccount;
        testContract.Agmt_Form_Number_INT__c = 'CB9621DKKE0318'; 
        testContract.Status__c = ContractConstants.SUSPENSE_STATUS;
        testContract.Agreement_Source__c = 'EFT';
        return testContract;
    }

    public static Integration_Process__c getIntegrationObjectForPR() {
        Integration_Process__c testIntegrationProcess = new Integration_Process__c(Request_Id__c='test03');
        testIntegrationProcess.RecordTypeId = ContractConstants.INTEGRATION_PROCESS_PUERTO_RICO_RECORD_TYPE_ID;
        testIntegrationProcess.Retail_Amount__c = 75;
        testIntegrationProcess.Source_System__c = TWG_Constants.PR;
        testIntegrationProcess.Contract_Name__c = 'PRContract';
        testIntegrationProcess.Account_Number__c = '337';
        testIntegrationProcess.Form_Number__c = 'CB9621DKKE0318';
        testIntegrationProcess.Process_Type__c = TWG_Constants.MAINTENANCE;
        testIntegrationProcess.Agreement_Source__c = 'EFT';
        testIntegrationProcess.Deposit_Date__c = Date.today();
        return testIntegrationProcess;
    }

    public static Communication_Job__c getCommunicationJob() {
        Communication_Job__c communicationJob = new Communication_Job__c();
        communicationJob.Id = TWGTestFactory.getFakeId(Communication_Job__c.sObjectType);
        return communicationJob;
    }
    
    public static Letter_Template__c getLetterTemplate() {
        Letter_Template__c testLetterTemplate = new Letter_Template__c();
        testLetterTemplate.Id = TWGTestFactory.getFakeId(Letter_Template__c.sObjectType);
        return testLetterTemplate;
    }
    
    public static Benefit__c getBenefit() {
        Benefit__c testBenefit = new Benefit__c();
        testBenefit.Id = TWGTestFactory.getFakeId(Benefit__c.sObjectType);
        testBenefit.RecordTypeId = BenefitConstants.SPECIALTY_AMEX_BENEFIT_RECORD_TYPE_ID;
        testBenefit.Decision_Status__c = BenefitConstants.DECISION_STATUS_AWAITING_RELEASE_CONFIRMATION;
        return testBenefit;
    }
    
    public static Case getCaseForAmex(String status){
        Case caseRecord = new Case();
        caseRecord.Id = TWGTestFactory.getFakeId(Case.sObjectType);
        caseRecord.Preferred_Method_of_Communication__c = 'Mail';
        caseRecord.Address__c = 'test';
        caseRecord.Address_2__c = 'test';
        caseRecord.City__c = 'test';
        caseRecord.State__c = 'test';
        caseRecord.Zip__c = 'test';
        caseRecord.RecordTypeId = CaseConstants.SPECIALTY_AMEX_CASE_RECORD_TYPE_ID;
        caseRecord.Status = status;
        return caseRecord;
    }
    
    public static CaseExt__c getCaseExtForAmex(String caseID){
        CaseExt__c caseExtRecord = new CaseExt__c();
        caseExtRecord.Id = TWGTestFactory.getFakeId(CaseExt__c.sObjectType);
        caseExtRecord.Rental_Agency_Email__c = 'test@gmail.com';
        caseExtRecord.Rental_Agency_Street__c = 'test';
        caseExtRecord.Rental_Agency_Street_2__c = 'test';
        caseExtRecord.Rental_Agency_City__c = 'test';
        caseExtRecord.Rental_Agency_State__c = 'test';
        caseExtRecord.Rental_Agency_Zip_Code__c = 'test';
        caseExtRecord.Case__c = caseID;
        return caseExtRecord;
    }
    
    public static Claimant__c getClaimantForAmex(String caseID){
        Claimant__c claimantRecord = new Claimant__c();
        claimantRecord.Id = TWGTestFactory.getFakeId(Claimant__c.sObjectType);
        claimantRecord.RecordTypeId = ClaimantConstants.SPECIALTY_INJURED_PERSON_RECORD_TYPE_ID;
        claimantRecord.Injured_Person_Street_1__c = 'test';
        claimantRecord.Injured_Person_Street_2__c = 'test';
        claimantRecord.Injured_Person_City__c = 'test';
        claimantRecord.Injured_Person_State__c = 'test';
        claimantRecord.Injured_Person_Postal_Code__c = 'test';
        claimantRecord.Injured_Person_Email__c = 'test@gmail.com';
        claimantRecord.Case__c = caseID; 
        return claimantRecord;
    }
}